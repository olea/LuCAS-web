<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><head><title>
Manual de Allegro: 00 Usando Allegro
</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css">
<!--
A.xref:link    {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:visited {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:hover   {color: blue; text-decoration: underline; background: rgb(255, 224, 150);}
A.xref:active  {color: red; text-decoration: none; background: rgb(255, 204, 50);}
blockquote.xref {border: medium solid rgb(255, 204, 51); color: black; background: rgb(255, 204, 50);}
blockquote.code {border: medium solid rgb(255, 204, 50); color: black; background: rgb(255, 255, 155);}
blockquote.text {border: medium solid rgb(175, 235, 255); color: black; background: rgb(210, 244, 255);}
-->
</style>
</head><body bgcolor=white text=black link="#0000ee" alink="#ff0000" vlink="#551a8b">
<h1><a name="00 Usando Allegro">00 Usando Allegro</a></h1>

<ul>
<li><a href="#allegro_error">allegro_error</a>
<li><a href="#allegro_exit">allegro_exit</a>
<li><a href="#allegro_id">allegro_id</a>
<li><a href="#allegro_init">allegro_init</a>
<li><a href="#allegro_message">allegro_message</a>
<li><a href="#check_cpu">check_cpu</a>
<li><a href="#cpu_capabilities">cpu_capabilities</a>
<li><a href="#cpu_family">cpu_family</a>
<li><a href="#cpu_model">cpu_model</a>
<li><a href="#cpu_vendor">cpu_vendor</a>
<li><a href="#desktop_color_depth">desktop_color_depth</a>
<li><a href="#get_desktop_resolution">get_desktop_resolution</a>
<li><a href="#install_allegro">install_allegro</a>
<li><a href="#os_multitasking">os_multitasking</a>
<li><a href="#os_revision">os_revision</a>
<li><a href="#os_type">os_type</a>
<li><a href="#os_version">os_version</a>
<li><a href="#set_window_close_button">set_window_close_button</a>
<li><a href="#set_window_close_hook">set_window_close_hook</a>
<li><a href="#set_window_title">set_window_title</a>
<li><a href="#yield_timeslice">yield_timeslice</a>
</ul>

<p>
Puede leer en readme.txt una introducción general, detalles de copyright e
información sobre cómo instalar Allegro y enlazar su programa con la
biblioteca.

<p><br>
<b>int <a name="install_allegro">install_allegro</a>(int system_id, int *errno_ptr, int (*atexit_ptr)());</b><br>
   Inicializa Allegro. Debe llamar a esta función o a allegro_init() antes de
   hacer otra cosa que no sea usar las rutinas Unicode. Si quiere usar un
   formato de texto diferente al UTF-8, puede ajustarlo con set_uformat()
   antes de llamar a esta función. Los identificadores de sistema disponibles
   (system_id) variarán dependiendo de la plataforma utilizada, pero casi
   siempre querrá usar SYSTEM_AUTODETECT. Alternativamente, SYSTEM_NONE
   instalará una versión reducida de Allegro que no intentará realizar
   accesos directos al hardware ni operaciones que sean particulares a una
   plataforma específica: esto puede resultar útil para situaciones en las
   que solamente quiera manipular bitmaps de memoria, como en una utilidad
   que maneje ficheros de datos o las funciones de interfaz con el GDI de
   Windows. Los parámetros errno_ptr y atexit_ptr deben apuntar a la variable
   errno y la función atexit() de su librería C respectivamente. Estos
   parámetros son requeridos ya que cuando Allegro es enlazado como una DLL
   no tiene acceso directo a los datos locales de su librería C. atexti_ptr
   puede ser NULL, en cuyo caso será su responsabilidad llamar allegro_exit
   manualmente. Por ahora esta función siempre devuelve cero. Si no se puede
   usar ningún driver de sistema, el programa será abortado.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#allegro_init">allegro_init</a>,
<a class="xref" href="#allegro_exit">allegro_exit</a>.</font></blockquote>
<b>int <a name="allegro_init">allegro_init</a>();</b><br>
   Macro que inicia la librería Allegro. Esta función es equivalente a la
   llamada install_allegro(SYSTEM_AUTODETECT, &amp;errno, atexit).


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#install_allegro">install_allegro</a>,
<a class="xref" href="#allegro_exit">allegro_exit</a>.</font></blockquote>
<b>void <a name="allegro_exit">allegro_exit</a>();</b><br>
   Cierra el sistema Allegro. Esto incluye devolver el sistema al modo texto
   y desinstalar todas las rutinas de ratón, teclado o temporización que
   estuviesen instaladas. Normalmente no tiene que molestarse en hacer una
   llamada explícita a esta función, ya que allegro_init() la instala como
   una función atexit(), por lo que será llamada automáticamente cuando su
   programa finalice.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#allegro_init">allegro_init</a>.</font></blockquote>
<b>extern char <a name="allegro_id">allegro_id</a>[];</b><br>
   Cadena de texto que contiene la fecha y número de versión de Allegro, en
   caso de que quiera enseñar estos datos en alguna parte.

<p><br>
<b>extern char <a name="allegro_error">allegro_error</a>[ALLEGRO_ERROR_SIZE];</b><br>
   Cadena de texto usada por set_gfx_mode() e install_sound() para indicar
   mensajes de error. Si éstas funciones fallan y quiere decirle al usuario
   porqué, éste es el lugar en el que se encuentra una descripción del
   problema.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg007.html#set_gfx_mode">set_gfx_mode</a>,
<a class="xref" href="alleg022.html#install_sound">install_sound</a>.</font></blockquote>
<b>extern int <a name="os_type">os_type</a>;</b><br>
   Variable ajustada por allegro_init() a uno de los siguientes valores:
<blockquote class="text"><pre>
      OSTYPE_UNKNOWN    - desconocido, o MSDOS normal
      OSTYPE_WIN3       - Windows 3.1 o versiones anteriores
      OSTYPE_WIN95      - Windows 95
      OSTYPE_WIN98      - Windows 98
      OSTYPE_WINME      - Windows ME
      OSTYPE_WINNT      - Windows NT
      OSTYPE_WIN2000    - Windows 2000
      OSTYPE_WINXP      - Windows XP
      OSTYPE_OS2        - OS/2
      OSTYPE_WARP       - OS/2 Warp 3
      OSTYPE_DOSEMU     - Linux DOSEMU
      OSTYPE_OPENDOS    - Caldera OpenDOS
      OSTYPE_LINUX      - Linux
      OSTYPE_FREEBSD    - FreeBSD
      OSTYPE_UNIX       - variante Unix desconocida
      OSTYPE_BEOS       - BeOS
      OSTYPE_QNX        - QNX
      OSTYPE_MACOS      - MacOS
</pre></blockquote>

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#allegro_init">allegro_init</a>.</font></blockquote>
<b>extern int <a name="os_version">os_version</a>;</b><br>
<b>extern int <a name="os_revision">os_revision</a>;</b><br>
   La versión mayor y menor del Sistema Operativo usado. Ajustado por
   allegro_init(). Si Allegro por alguna razón no es capaz de obtener la
   versión de su Sistema Operativo, os_version y os_revision valdrán -1. Por
   ejemplo: bajo Win98 SE (v4.10.2222) os_version valdrá 4 y os_revision
   valdrá 10.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#os_type">os_type</a>,
<a class="xref" href="#os_multitasking">os_multitasking</a>.</font></blockquote>
<b>extern int <a name="os_multitasking">os_multitasking</a>;</b><br>
   Ajustado por allegro_init() a TRUE o FALSE dependiendo de si su Sistema
   Operativo es multitarea o nó.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#os_type">os_type</a>,
<a class="xref" href="#os_version">os_version</a>.</font></blockquote>
<b>void <a name="allegro_message">allegro_message</a>(char *msg, ...);</b><br>
   Muestra un mensaje usando una cadena con formato printf(). Esta función
   sólo debe ser utilizada cuando no esté en un modo gráfico, es decir, antes
   de llamar a set_gfx_mode() o después de llamar a set_gfx_mode(GFX_TEXT).
   En plataformas que tengan una consola en modo texto (DOS, Unix y BeOS),
   mostrará la cadena en la consola reduciendo los carácteres acentuados a
   aproximaciones en 7 bits de códigos ASCII, evitando en lo posible los
   problemas con las diferentes páginas de códigos. Bajo Windows, el mensaje
   aparecerá en un ventana de mensajes.

<p><br>
<b>void <a name="set_window_title">set_window_title</a>(const char *name);</b><br>
   En las plataformas que sean capaces de ello, esta rutina cambia el título
   de la ventana utilizada para su programa. Tenga en cuenta que Allegro no
   es capaz de modificar el título de la ventana cuando ejecute una ventana
   DOS en Windows.

<p><br>
<b>int <a name="set_window_close_button">set_window_close_button</a>(int enable);</b><br>
   En las plataformas que sean capaces de ello, esta rutina activa o
   desactiva el botón de cerrar ventana de su programa Allegro. Si lo
   desea, puede llamar esta rutina antes de que la ventana sea creada. Si el
   botón de cerrar ventana es desactivado con éxito, esta función devolverá
   cero.

<p>
   En plataformas en las que el botón de cerrado no existe o no puede ser
   desactivado, la función devolverá -1. Si esto ocurre, quizás le interese
   usar set_window_close_hook() para manejar manualmente el evento de cierre
   de la ventana.

<p>
   Cuando active el botón de cierre, la función devolverá el mismo valor
   que devolvió su plataforma al desactivarlo. Esto significa que devolverá
   distinto de cero si el botón no se puede desacivar, a pesar de que no
   esté intentando desactivarlo.

<p>
   Tenga en cuenta que Allegro no puede manipular el botón de cerrado de una
   ventana DOS bajo Windows.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#set_window_close_hook">set_window_close_hook</a>,
<a class="xref" href="#set_window_title">set_window_title</a>.</font></blockquote>
<b>void <a name="set_window_close_hook">set_window_close_hook</a>(void (*proc)());</b><br>
   En las plataformas que tengan botón de cierre, esta rutina instala una
   función de enganche en el evento de cierre. En otras palabras, cuando el
   usuario pinche en el botón que cerraría la ventana de su programa, se
   llamará a la función que especifique aquí. Puede usar esta función para
   mostrar un diálogo ofreciendo salvar los datos o verificar que el usuario
   realmente desea salir, o puede usarla para salvar los datos, liberar
   memoria y salir.

<p>
   Esta función generalmente no debería intentar salir del programa o salvar
   datos por sí misma. Esta función podría ser llamada en cualquier momento,
   y hay peligro de que los datos que intente salvar sean inválidos en ese
   momento. Por eso, debería activar una variable durante esta función, y
   verificar esta variable regularmente en su programa principal.

<p>
   Pase NULL a esta función para recuperar la funcionalidad por defecto del
   botón de cierre. En Windows y BeOS, el siguiente mensaje aparecerá:

<p>
      Aviso: forzar la finalización del programa puede ocasionar pérdidas
      de datos y resultados inesperados. Es preferible que use el comando
      de salir dentro de la ventana.

<p>
      ¿Desea continuar de todas maneras?

<p>
      [Si] [No]

<p>
   Este mensaje será traducido al lenguaje seleccionado si hay una
   traducción dispobible en language.dat (vea get_config_text()).

<p>
   Si el usuario selecciona [Si], el programa finalizará inmediatamente
   en el mismo estilo que cuando el usuario pulsa Ctrl+Alt+End (vea
   three_finger_flag).

<p>
   En otros sistemas operativos, el programa saldrá inmediatamente sin
   preguntar nada al usuario.

<p>
   Tenga en cuenta que Allegro no puede interceptar el botón de cierre de
   una ventana DOS bajo Windows.
 

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#set_window_close_button">set_window_close_button</a>,
<a class="xref" href="#set_window_title">set_window_title</a>,
<a class="xref" href="alleg002.html#get_config_text">get_config_text</a>,
<a class="xref" href="alleg005.html#three_finger_flag">three_finger_flag</a>.</font></blockquote>
<b>int <a name="desktop_color_depth">desktop_color_depth</a>();</b><br>
   En plataformas que pueden ejecutar programas de Allegro en una ventana
   de un escritorio existente, devuelve la profundidad de color usada por
   el escritorio en ese momento (su programa posiblemente correrá más si
   usa la misma profundidad de color. En plataformas donde esta
   información no es disponible o no tiene sentido, devuelve cero.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#get_desktop_resolution">get_desktop_resolution</a>.</font></blockquote>
<b>int <a name="get_desktop_resolution">get_desktop_resolution</a>(int *width, int *height);</b><br>
   En plataformas que pueden ejecutar programas de Allegro en una ventana
   de un escritorio existente, permite obtener la resolución actual usada
   por el escritorio (ej: le itneresará llamar a esta función antes de crear
   una gran ventana, porque en algunos drivers de modo ventana, ésta no
   puede ser creada si es mayor que el escritorio). Devuelve cero si hubo
   éxito, o un número negativo si la información no está disponible o no es
   aplicable a su situación, en cuyo caso los valores almacenados en width
   y heigth serán indefinidos.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#desktop_color_depth">desktop_color_depth</a>.</font></blockquote>
<b>void <a name="yield_timeslice">yield_timeslice</a>();</b><br>
   En los sistemas que lo soportan, libera el resto de la "rebanada
   temporal" (timeslice) que la CPU le había asignado. Esta opción también
   es conocida como "pórtate bien con la multitarea".

<p><br>
<b>void <a name="check_cpu">check_cpu</a>();</b><br>
   Detecta el tipo de CPU, asignando valores a las siguientes variables
   globales. Normalmente no necesita llamar a esta función, ya que
   allegro_init() lo hará por usted.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#cpu_vendor">cpu_vendor</a>,
<a class="xref" href="#cpu_family">cpu_family</a>,
<a class="xref" href="#cpu_model">cpu_model</a>,
<a class="xref" href="#cpu_capabilities">cpu_capabilities</a>.</font></blockquote>
<b>extern char <a name="cpu_vendor">cpu_vendor</a>[];</b><br>
   Contiene el nombre del proveedor de la CPU si éste es conocido. En
   plataformas no-Intel, contiene una cadena vacía.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#check_cpu">check_cpu</a>,
<a class="xref" href="#cpu_family">cpu_family</a>,
<a class="xref" href="#cpu_model">cpu_model</a>,
<a class="xref" href="#cpu_capabilities">cpu_capabilities</a>.</font></blockquote>
<b>extern int <a name="cpu_family">cpu_family</a>;</b><br>
   Contiene el tipo de CPU Intel, en las CPUs donde sea aplicable: 3=386,
   4=486, 5=Pentium, 6=PPro, etc.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#check_cpu">check_cpu</a>,
<a class="xref" href="#cpu_vendor">cpu_vendor</a>,
<a class="xref" href="#cpu_model">cpu_model</a>,
<a class="xref" href="#cpu_capabilities">cpu_capabilities</a>.</font></blockquote>
<b>extern int <a name="cpu_model">cpu_model</a>;</b><br>
   Contiene el submodelo de una CPU Intel, en las CPUs donde sea aplicable.
   En un 486 (cpu_family=4), cero o uno indica un chip DX, 2 un SX, 3 indica
   la presencia de un coprocesador matemático (486 SX + 487 ó 486 DX), 4 un
   SL, 5 un SX2, 7 un DX2 write-back enhanced, 8 un DX4 o un overdrive DX4,
   14 un Cyrix y 15 desconocido. En un chip Pentium (cpu_family=5), 1 indica
   un Pentium (510\66, 567\66), 2 un Pentium P54C, 3 un procesador Pentium
   overdrive, 5 un Pentium overdrive para IntelDX4, 14 un Cyrix y 15
   desconocido.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#check_cpu">check_cpu</a>,
<a class="xref" href="#cpu_vendor">cpu_vendor</a>,
<a class="xref" href="#cpu_family">cpu_family</a>,
<a class="xref" href="#cpu_capabilities">cpu_capabilities</a>.</font></blockquote>
<b>extern int <a name="cpu_capabilities">cpu_capabilities</a>;</b><br>
   Contiene bits de la CPU que indican qué características están disponibles.
   Los bits pueden ser una combinación de:
<blockquote class="text"><pre>
      CPU_ID       - Indica que la instrucción "cpuid" está disponible.
                     Si este bit está activo, entonces todas las variables
                     CPU de Allegro son fiables al 100%, en caso contrario
                     podría haber fallos.
      CPU_FPU      - Hay disponible una FPU x87.
      CPU_MMX      - Conjunto de instrucciones Intel MMX  disponible.
      CPU_MMXPLUS  - Conjunto de instrucciones Intel MMX+ disponible.
      CPU_SSE      - Conjunto de instrucciones Intel SSE  disponible.
      CPU_SSE2     - Conjunto de instrucciones Intel SSE2 disponible.
      CPU_3DNOW    - Conjunto de instrucciones AMD 3DNow! disponible.
      CPU_ENH3DNOW - Conjunto de instrucciones AMD Enhanced 3DNow!
                     disponible.
      CPU_CMOV     - Instrucción "cmov" del Pentium Pro disponible.
</pre></blockquote>

<p>
   Puede verificar múltiples características haciendo una OR de los bits. Por
   ejemplo, para ver si la CPU tiene una FPU y un conjunto de instrucciones
   MMX podría hacer:
<blockquote class="code"><pre>
      if ((cpu_capabilities &amp; (CPU_FPU | CPU_MMX)) == (CPU_FPU | CPU_MMX))
         printf("¡La CPU tiene tanto una FPU como instrucciones MMX!\n");
</pre></blockquote>




<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#check_cpu">check_cpu</a>,
<a class="xref" href="#cpu_vendor">cpu_vendor</a>,
<a class="xref" href="#cpu_family">cpu_family</a>,
<a class="xref" href="#cpu_model">cpu_model</a>,
<a class="xref" href="#cpu_capabilities">cpu_capabilities</a>.</font></blockquote>
<hr><a href="allegro.html">Volver al Indice</a>

</body>
</html>
