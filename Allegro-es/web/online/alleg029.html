<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><head><title>
Manual de Allegro: 29 Rutinas matemáticas de punto fijo
</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css">
<!--
A.xref:link    {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:visited {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:hover   {color: blue; text-decoration: underline; background: rgb(255, 224, 150);}
A.xref:active  {color: red; text-decoration: none; background: rgb(255, 204, 50);}
blockquote.xref {border: medium solid rgb(255, 204, 51); color: black; background: rgb(255, 204, 50);}
blockquote.code {border: medium solid rgb(255, 204, 50); color: black; background: rgb(255, 255, 155);}
blockquote.text {border: medium solid rgb(175, 235, 255); color: black; background: rgb(210, 244, 255);}
-->
</style>
</head><body bgcolor=white text=black link="#0000ee" alink="#ff0000" vlink="#551a8b">
<h1><a name="29 Rutinas matemáticas de punto fijo">29 Rutinas matemáticas de punto fijo</a></h1>

<ul>
<li><a href="#fixacos">fixacos</a>
<li><a href="#fixadd">fixadd</a>
<li><a href="#fixasin">fixasin</a>
<li><a href="#fixatan">fixatan</a>
<li><a href="#fixatan2">fixatan2</a>
<li><a href="#fixceil">fixceil</a>
<li><a href="#fixcos">fixcos</a>
<li><a href="#fixdiv">fixdiv</a>
<li><a href="#fixfloor">fixfloor</a>
<li><a href="#fixhypot">fixhypot</a>
<li><a href="#fixmul">fixmul</a>
<li><a href="#fixsin">fixsin</a>
<li><a href="#fixsqrt">fixsqrt</a>
<li><a href="#fixsub">fixsub</a>
<li><a href="#fixtan">fixtan</a>
<li><a href="#fixtof">fixtof</a>
<li><a href="#fixtoi">fixtoi</a>
<li><a href="#ftofix">ftofix</a>
<li><a href="#itofix">itofix</a>
</ul>

<p>
Allegro trae algunas rutinas para trabajar con números de punto fijo, y
define el tipo 'fixed' como un entero de 32 bits con signo. La parte alta es
usada por el valor del entero y la parte baja es usada por el valor de la
fracción, dando un rango de valores de -32768 a 32767 y un detalle de unos 4
o 5 decimales. Los números de punto fijo pueden ser asignados, comparados,
añadidos, substraídos, negados y desplazados (para multiplicar o dividir por
potencias de 2) usando los operadores de enteros normales, pero tendría que
tener cuidado de usar las rutinas de conversión apropiadas cuando combine
números de punto fijo con enteros o números de coma flotante. Escribir
'punto_fijo_1 + punto_fijo_2' esta bien, pero 'punto_fijo + entero' no esta
bien.

<p><br>
<b>fixed <a name="itofix">itofix</a>(int x);</b><br>
   Convierte un valor de entero a punto fijo. Esto es lo mismo que x&lt;&lt;16.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixtoi">fixtoi</a>,
<a class="xref" href="#ftofix">ftofix</a>,
<a class="xref" href="#fixtof">fixtof</a>.</font></blockquote>
<b>int <a name="fixtoi">fixtoi</a>(fixed x);</b><br>
   Convierte un valor de punto fijo a entero, redondeando.
   

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#itofix">itofix</a>,
<a class="xref" href="#ftofix">ftofix</a>,
<a class="xref" href="#fixtof">fixtof</a>,
<a class="xref" href="#fixfloor">fixfloor</a>,
<a class="xref" href="#fixceil">fixceil</a>.</font></blockquote>
<b>int <a name="fixfloor">fixfloor</a>(fixed x);</b><br>
   Devuelve el mayor entero menor que x. Esto es, redondea hacia el infinito
   negativo.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixtoi">fixtoi</a>,
<a class="xref" href="#fixceil">fixceil</a>.</font></blockquote>
<b>int <a name="fixceil">fixceil</a>(fixed x);</b><br>
   Devuelve el menor intero mayor que x. Esto es, redondea hacia el infinito
   positivo.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixtoi">fixtoi</a>,
<a class="xref" href="#fixfloor">fixfloor</a>.</font></blockquote>
<b>fixed <a name="ftofix">ftofix</a>(float x);</b><br>
   Convierte un valor de coma flotante a punto fijo.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixtof">fixtof</a>,
<a class="xref" href="#itofix">itofix</a>,
<a class="xref" href="#fixtoi">fixtoi</a>.</font></blockquote>
<b>float <a name="fixtof">fixtof</a>(fixed x);</b><br>
   Convierte un valor de punto fijo a coma flotante.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#ftofix">ftofix</a>,
<a class="xref" href="#itofix">itofix</a>,
<a class="xref" href="#fixtoi">fixtoi</a>.</font></blockquote>
<b>fixed <a name="fixmul">fixmul</a>(fixed x, fixed y);</b><br>
   Un valor de punto fijo puede ser multiplicado o dividido por un entero
   con los operadores normales '*' y '/'. Sin embargo, para multiplicar dos
   valores de punto fijo necesita usar esta función.

<p>
   Si hay desbordamiento o división por cero, errno será activado y el valor
   máximo posible será devuelto, pero errno no es limpiado si la operación
   es realizada con éxito. Esto significa que si va a comprobar un
   desbordamiento de división, debería poner errno=0 antes de llamar a
   fixmul().


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixadd">fixadd</a>,
<a class="xref" href="#fixsub">fixsub</a>,
<a class="xref" href="#fixdiv">fixdiv</a>.</font></blockquote>
<b>fixed <a name="fixdiv">fixdiv</a>(fixed x, fixed y);</b><br>
   División de valores de punto fijo: mire fixmul().


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixadd">fixadd</a>,
<a class="xref" href="#fixsub">fixsub</a>,
<a class="xref" href="#fixmul">fixmul</a>.</font></blockquote>
<b>fixed <a name="fixadd">fixadd</a>(fixed x, fixed y);</b><br>
   A pesar de que los números de punto fijo pueden ser añadidos con el
   operador normal de enteros '+', eso no le da protección contra
   desbordamientos. Si el desbordamiento es un problema, debería usar esta
   función. Es mas lenta que los operadores de enteros, pero si hay un
   desbordamiento de división, ajustará el tamaño del resultado en vez de
   dejarlo al azar, y activara errno.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixsub">fixsub</a>,
<a class="xref" href="#fixmul">fixmul</a>,
<a class="xref" href="#fixdiv">fixdiv</a>.</font></blockquote>
<b>fixed <a name="fixsub">fixsub</a>(fixed x, fixed y);</b><br>
   Resta de números en punto fijo: mire fixadd().


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#fixadd">fixadd</a>,
<a class="xref" href="#fixmul">fixmul</a>,
<a class="xref" href="#fixdiv">fixdiv</a>.</font></blockquote>
<br><center><h2><a name="Trigonometría de punto fijo">Trigonometría de punto fijo</a></h2></center><p>
Las funciones de raíz cuadrada, seno, coseno, tangente, cosecante y secante
están implementadas usando tablas precalculadas, que son muy rápidas pero no
muy exactas. Por ahora, la cotangente realiza una búsqueda iterativa en la
tabla de la tangente, por lo que es mas lenta que las otras.

<p>
Los ángulos están representados en formato binario con 256 siendo igual al
círculo completo, 64 es un ángulo recto y así sucesivamente. Esto tiene
la ventaja de que un 'and' a nivel de bits puede ser usado para que el
ángulo quede entre cero y el círculo completo, eliminando esos tests
cansinos 'if (angle &gt;= 360)'.

<p><br>
<b>fixed <a name="fixsin">fixsin</a>(fixed x);</b><br>
   Mira la tabla precalculada del seno.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixcos">fixcos</a>(fixed x);</b><br>
   Mira la tabla precalculada del coseno.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixtan">fixtan</a>(fixed x);</b><br>
   Mira la tabla precalculada de la tangente.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixasin">fixasin</a>(fixed x);</b><br>
   Mira la tabla de la cosecante.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixacos">fixacos</a>(fixed x);</b><br>
   Mira la tabla de la secante.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixatan">fixatan</a>(fixed x);</b><br>
   Cotangente de punto fijo.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixatan2">fixatan2</a>(fixed y, fixed x);</b><br>
   Versión de punto fijo de la rutina atan2() de libc.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixsqrt">fixsqrt</a>(fixed x);</b><br>
   Raíz cuadrada de punto fijo.


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<b>fixed <a name="fixhypot">fixhypot</a>(fixed x, fixed y);</b><br>
   Hypotenusa en punto fijo (devuelve la raíz cuadrada de x*x + y*y).



<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="#Trigonometría de punto fijo">Trigonometría de punto fijo</a>.</font></blockquote>
<br><center><h2><a name="Clase de punto fijo">Clase de punto fijo</a></h2></center><p>
Si está programando en C++ puede ignorar todo lo de arriba y usar la clase
"fija", que sobrecarga muchos operadores para proveer conversión automática
desde y hacia valores enteros y de coma flotante, y llama las rutinas de
arriba cuando se necesitan. Sin embargo no debería mezclar la clase "fija"
con los typedefs de punto fijo, ya que el compilador tratará los valores de
punto fijo como enteros regulares e insertará conversiones innecesarias. Por
ejemplo, si x es un objeto de clase fija, llamar fixsqrt(x) devolverá un
resultado erróneo. Debería usar sqrt(x) o x.swrt() en vez de eso.


<p><br>
<br><center><h2><a name="Alias de punto fijo">Alias de punto fijo</a></h2></center><p>
Las rutinas de punto fijo antes eran nombradas con el prefijo "f" en lugar
de "fix", ej: fixsqrt() antes era fsqrt(), pero tuvieron que ser renombradas
por conflictos con algunas implementaciones de la libc. Esto no debería
afectar a la mayoría del código existente dado que existen alias de
compatibilidad hacia atrás. Estos alias son funciones estáticas inline que
enlazan los nombres antiguos con los nuevos, ej: fsqrt() llama a fixsqrt().
Puede desactivar estos alias definiendo la macro de preprocesador
ALLEGRO_NO_FIX_ALIASES antes de incluír allegro.h.



<p><br>
<hr><a href="allegro.html">Volver al Indice</a>

</body>
</html>
