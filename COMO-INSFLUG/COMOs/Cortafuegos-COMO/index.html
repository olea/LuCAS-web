<HTML
><HEAD
><TITLE
>Cómo de cortafuegos y servidor proxy</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.74b"></HEAD
><BODY
CLASS="ARTICLE"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Cómo de cortafuegos y servidor proxy</A
></H1
><DIV
CLASS="AUTHORGROUP"
><A
NAME="AEN4"
></A
><H3
CLASS="AUTHOR"
><A
NAME="AEN5"
>Mark
	 Grennan 
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>autor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;mark@grennan.com
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN12"
>Esteban
	 Lozano Florido
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;elozanof@terra.es
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN19"
>María
	 González Naranjo
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductora<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;mgnaranjo@terra.es
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN26"
>Héctor
	 González Soto
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;hgsoto@terra.es  
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN33"
>Alexis
	 Martell Robaina
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;alexis_martel@hotmail.com
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN43"
>Tomás David
	 García Tejera
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;davidfti@hotmail.com 
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
><H3
CLASS="AUTHOR"
><A
NAME="AEN53"
>Luis Carlos
	 Antúnez
	</A
></H3
><DIV
CLASS="AFFILIATION"
><SPAN
CLASS="JOBTITLE"
>traductor<BR></SPAN
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
>	&nbsp;&nbsp;&nbsp;&nbsp;lantnezs@idecnet.com
	    <br>
	&nbsp;&nbsp;</P
></DIV
></DIV
></DIV
><P
CLASS="PUBDATE"
>v0.80, 26 de febrero de 2000<BR></P
><DIV
CLASS="REVHISTORY"
><TABLE
WIDTH="100%"
BORDER="0"
><TR
><TH
ALIGN="LEFT"
VALIGN="TOP"
COLSPAN="3"
><B
>Revision History</B
></TH
></TR
><TR
><TD
ALIGN="LEFT"
>Revision 1.0</TD
><TD
ALIGN="LEFT"
>octubre de 2001</TD
><TD
ALIGN="LEFT"
>Revised by: kerberos</TD
></TR
><TR
><TD
ALIGN="LEFT"
COLSPAN="3"
>Revisión de la primera traducción castellana</TD
></TR
></TABLE
></DIV
><DIV
><DIV
CLASS="ABSTRACT"
><A
NAME="AEN70"
></A
><P
></P
><P
>Este documento está diseñado para describir los fundamentos de los sistemas de cortafuegos, al mismo tiempo que le explica cómo instalar un filtro y un cortafuegos proxy en un sistema basado en Linux. La versión HTML de este documento se puede obtener en la siguiente dirección <A
HREF="http://www.grennan.com/Firewall-HOWTO.html"
TARGET="_top"
>http://www.grennan.com/Firewall-HOWTO.html</A
></P
><P
></P
></DIV
></DIV
><HR></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN73"
>1. Introducción</A
></H1
><P
>David Rudder escribió la versión original de este Cómo de Cortafuegos hace ya algún tiempo y, desde aquí, quiero agradecerle que me permita actualizar su trabajo.</P
><P
>También me gustaría dar las gracias a Ian Gough por ayudarme en el proceso de redacción.</P
><P
>Los cortafuegos han adquirido gran popularidad de un tiempo a esta parte y se consideran el último grito en la seguridad en Internet, pero como ocurre con la mayoría de los temas candentes, los cortafuegos a menudo han dado lugar a malentendidos. En este Cómo se explican las bases de lo que es un cortafuegos y de cómo se pueden instalar.</P
><P
>Hemos utilizado kernel 2.2.13 y RedHat 6.1 para desarrollar este Cómo, y los ejemplos que aquí se utilizan se basan, por lo tanto, en esta distribución. Si encuentra diferencias en la suya, por favor, póngase en contacto conmigo para actualizar este Cómo.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN79"
>1.1. Retroalimentación</A
></H2
><P
>Cualquier apoyo o crítica a este documento serán bienvenidos. <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>¡POR FAVOR, RUEGO ME COMUNIQUEN CUALQUIER INEXACTITUD QUE VEAN EN ÉL!</I
></SPAN
>  No soy un experto, y puedo cometer errores. Si encuentra algún fallo, por favor, hágamelo saber. Intentaré responder a todos los correos electrónicos, pero soy una persona muy ocupada, así que no se enfade si no lo hago.</P
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Mi dirección de correo electrónico es <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
><A
HREF="mailto:mark@grennan.com"
TARGET="_top"
>mark@grennan.com</A
></I
></SPAN
></I
></SPAN
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN87"
>1.2. Descargo de Responsabilidad</A
></H2
><P
> 
<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>NO ME HAGO RESPONSABLE POR NINGÚN DAÑO PRODUCIDO POR ACCIONES DERIVADAS DE ESTE DOCUMENTO</I
></SPAN
>. Este documento pretende ser una introducción a los cortafuegos y los servidores proxy. No soy, ni lo pretendo ser, un experto en seguridad. Simplemente soy un tipo que ha leído mucho y al que le gustan los computadores más que al resto de la gente. Por favor, escribo esto esto para ayudar a la gente a entender más sobre este tema, y no estoy preparado para hacer depender mi vida de la exactitud de lo que hay aquí.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN91"
>1.3. Propiedad Intelectual</A
></H2
><P
> 
A menos que se especifique lo contrario, los documentos Cómo de Linux son propiedad intelectual de sus respectivos autores. Estos documentos Cómo de Linux se pueden reproducir y distribuir total o parcialmente en cualquier medio, ya sea físico o electrónico, siempre y cuando aparezca la marca de propiedad intelectual en todas las copias. La redistribución comercial está permitida y, de hecho, se recomienda. No obstante, al autor le gustaría que se le notificara cualquier distribución de este tipo.</P
><P
>Todas las traducciones, trabajos derivados o trabajos de recopilación que incorporen cualquier documento Cómo de Linux deben llevar la marca de propiedad intelectual, es decir, no se puede producir ningún trabajo derivado de un Como y añadirle restricciones adicionales a su distribución. Se podrán establecer excepciones a estas normativas bajo ciertas condiciones. Por favor, contacte con el coordinador de Cómos de Linux.</P
><P
>En resumen, deseamos promover la difusión de esta información por todos los canales posibles, pero nos gustaría mantener la propiedad intelectual de los Cómos. Por ello, rogamos se nos comunique cualquier intención de redistribución de los Cómos.</P
><P
>Si tiene alguna duda, por favor no dude en ponerse en contacto conmigo. (Véase arriba)</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN97"
>1.4. Las Razones por las que escribí esto</A
></H2
><P
>Hace varios años, mientras trabajaba para el estado de Oklahoma como «Administrador de Internet», me pidieron que «pusiera al Estado en Internet», sin presupuesto alguno. (Nota: En aquella época no había tal puesto de trabajo; simplemente era una persona que lo hacía todo). La mejor manera de conseguirlo era utilizar todos los "software" gratuitos y los "hardwares" que pudiera. Para ello contaba tan sólo con Linux y con algunos equipos 486 obsoletos.</P
><P
>Los cortafuegos comerciales tienen precios excesivos y la documentación que explica cómo funcionan se considera de alto secreto. Por lo tanto, crear un cortafuegos propio era una tarea casi imposible.</P
><P
>En el siguiente encargo, me pedían instalar un cortafuegos. Linux acababa de introducir un código de cortafuegos. De nuevo, sin presupuesto, empecé a diseñar un cortafuegos con Linux. Seis meses más tarde el cortafuegos ya estaba instalado y comencé a actualizar este documento.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN102"
>1.5. Lecturas de Interés</A
></H2
><P
>&#13;<P
></P
><UL
><LI
><P
><A
HREF="http://sunsite.unc.edu/mdw/HOWTO/Networking-Overview-HOWTO.html"
TARGET="_top"
>The The Linux Networking Overview HOWTO</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://sunsite.unc.edu/mdw/HOWTO/Ethernet-HOWTO.html"
TARGET="_top"
>The Ethernet HOWTO</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://ipchains.nerdherd.org/"
TARGET="_top"
>IPchains Firewalling made Easy!</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://www.linas.org/linux/load.html"
TARGET="_top"
>Linux Network Address Translation</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://sunsite.unc.edu/mdw/HOWTO/NET-3-HOWTO.html"
TARGET="_top"
>The Net-3 HOWTO</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://sunsite.unc.edu/mdw/HOWTO/PPP-HOWTO.html"
TARGET="_top"
>The NET-PPP HOWTO</A
> &#13;</P
></LI
><LI
><P
><A
HREF="http://vtun.netpedia.net/"
TARGET="_top"
>The easiest way to create Virtual Tunnels over TCP/IP networks</A
></P
></LI
></UL
>&#13;</P
><P
>[ otras URLS ]</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN128"
>2. Cortafuegos: Conceptos básicos</A
></H1
><P
>Un cortafuegos es una barrera para evitar que el fuego se expanda. Los edificios disponen de cortafuegos, muros de ladrillos que dividen las diferentes secciones del edificio. En un coche, un cortafuegos es la plancha de metal que separa al motor del compartimento de los pasajeros.</P
><P
>La misión de los cortafuegos de Internet es garantizar la seguridad de nuestro equipo ante los peligros cibernéticos de la red de área local (LAN) o bien, mantener a los miembros de esa LAN al margen de las malignas intenciones de Internet.</P
><P
>El primer cortafuegos en un ordenador fue una máquina Unix que no realizaba tareas de encaminamiento con conexiones a dos redes distintas.Una tarjeta de red conectada a Internet y la otra al LAN privado. Si quería acceder a Internet desde la red privada, tenía que registrarse en un servidor (Unix) de cortafuegos. Por lo tanto, se utilizaban los recursos del sistema para acceder a Internet. Por ejemplo, podría utilizar X-windows para ejecutar el navegador de Netscape con el sistema de cortafuegos y poder usarlo en una estación de trabajo. Con el navegador ejecutado en el cortafuegos se tiene acceso a dos redes.</P
><P
>Este tipo de sistema de origen dual (un sistema con dos conexiones de red)  es muy bueno si tiene PLENA CONFIANZA en todos sus usuarios. Se puede instalar un sistema Linux y darle una cuenta a todo aquel que quiera tener acceso a Internet. Con esta instalación, el único computador de su red privada que conoce todo sobre el mundo exterior es el cortafuegos. Nadie puede descargar en su computador directamente. Primero deberá descargar el fichero al cortafuegos y después descargarlo del cortafuegos a sus estación de trabajo.</P
><P
>IMPORTANTE: El 99% de las instrusiones comienza con el acceso al sistema que se va a atacar. Por esta razón, no se recomienda este tipo de cortafuegos, además de que es muy limitado.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN135"
>2.1. Políticas de Cortafuegos</A
></H2
><P
> 
No crea que lo único que necesita es una máquina de cortafuegos. <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Establezca las políticas primero</I
></SPAN
>.</P
><P
>Los cortafuegos se utilizan con dos objetivos:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>para denegar el acceso a los piratas y gusanos</P
></LI
><LI
><P
>para permitir el acceso a empleados, niños, etc.</P
></LI
></OL
>&#13;</P
><P
>Cuando empecé a trabajar con los cortafuegos, me llamó la atención ver que la empresa estaba más interesada en <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>espiar</I
></SPAN
> a sus empleados que en denegar a su red el acceso a los piratas.</P
><P
>Al menos en el estado de Oklahoma, los empresarios tienen derecho a hacer llamadas telefónicas y acceder a Internet siempre y cuando se informa de ello a los empleados.</P
><P
>El Gran Hermano no es el gobierno. Gran Hermano = Gran Negocio.</P
><P
>No me malinterpreten. La gente debe trabajar, y no dedicarse a jugar durante las horas de trabajo. En mi opinión, se está dejando a un lado cada vez más la ética del trabajo. No obstante, también he observado que son los mismos encargados los primeros que no cumplen las normas. He visto trabajadores por hora que han sido reprendidos por utilizar Internet para buscar el recorrido del autobus del trabajo a casa, mientras que los mismos directores durante horas de trabajo se dedicaban a buscar buenos restaurantes y salas de fiesta para llevar a sus futuros clientes.</P
><P
>Mi error antes este tipo de abusos es publicar un acceso a cortafuegos en una página web para que todo el mundo lo pueda leer.</P
><P
>La cuestión de la seguridad puede ser escalofriante. Si es usted un administrador de cortafuegos, cúbrase las espaldas.</P
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN153"
>2.1.1. Cómo crear una política de seguridad</A
></H3
><P
>Hay muchos artículos en los que se explica cómo crear una política de seguridad. Después de muchos años de experiencia, les puedo recomendar que no se fíen en absoluto. Crear una política de seguridad es algo muy simple:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>describa para qué es el servicio</P
></LI
><LI
><P
>describa el grupo de personas a las que va dirigido el servicio</P
></LI
><LI
><P
>describa a qué servicio necesita acceder cada grupo</P
></LI
><LI
><P
>describa, para cada grupo de servicio, cómo se puede mantener seguro el servicio</P
></LI
><LI
><P
>redacte un informe en el que se considere violación cualquier otro tipo de acceso</P
></LI
></OL
>&#13;</P
><P
>Esta política se irá haciendo cada vez más compleja, no intente abarcar demasiado en este punto. Procure que sea sencilla y clara.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN169"
>2.2. Tipos de Cortafuegos</A
></H2
><P
>Hay dos tipos de cortafuegos.</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Cortafuegos de filtrado - que evitará el acceso no autorizado a determinados paquetes de la red.</P
></LI
><LI
><P
>Sevidores Proxies (a veces llamados cortafuegos) - encargados de establecer las conexiones a la red.</P
></LI
></OL
>&#13;</P
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN178"
>2.2.1. Cortafuegos de Filtrado de Paquetes</A
></H3
><P
>El Filtrado de Paquetes es el tipo de cortafuegos integrado en el núcleo de Linux.</P
><P
>Un cortafuegos de filtrado trabaja a nivel de red. Los datos salen del sistema sólo si las reglas del cortafuegos se lo permiten. Cuando los paquetes llegan son filtrados atendiendo al protocolo utilizado, la dirección fuente y destino, y la información que sobre el puerto viene contenida en cada paquete.</P
><P
>Muchos encaminadores o routers de red tienen la posibilidad de desarrollar servicios cortafuegos. Los cortafuegos de filtrado nos los podemos imaginar como un tipo de encaminador. Por este motivo Usted necesitará tener un profundo conocimiento de la estructura de los paquetes IP para trabajar con uno.</P
><P
>Puesto que son muy pocos los datos que se analizan y registran, los cortafuegos de filtrado de paquetes requieren menos CPU y crean menos latencia en su red.</P
><P
>Los cortafuegos de filtrado no prevén los controles mediante el uso de contraseña. Los usuarios no pueden identificarse. Lo único que identifica a un usuario es el número IP asignado a su estación de trabajo. Esto puede convertirse en un problema is usted tiene la intención de usar DHCP (Dynamic IP assignments). Esto se debe a que las reglas se basan en los números IP que tendrá que ajustar a las reglas cuando se asignen los nuevos números IP. Desconozco la forma de automatizar este proceso.</P
><P
>Los cortafuegos de filtrado resultan más transparentes para el usuario, que no tiene que establecer reglas en sus aplicaciones para acceder a Internet. No sucede los mismo con la mayoría de los servidores proxy.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN186"
>2.2.2. Servidores proxy</A
></H3
><P
> 
Este tipo de servidores se usa principalmente para controlar, o supervisar, el tráfico hacia el exterior. Algunos proxy de aplicación almacenan en una memoria de almacenamiento intermedio una copia local de los datos solicitados. Esto reduce el ancho de banda preciso y acelera el acceso a los mismos datos para el siguiente usuario. Ofrece una inequívoca prueba de lo que fue transferido.</P
><P
>Existen dos tipos de servidores proxy

<P
></P
><OL
TYPE="1"
><LI
><P
>Servidores proxy de aplicación - son los que hacen el trabajo por Usted.</P
></LI
><LI
><P
>Servidores proxy SOCKS - establecen conexiones entre puertos.</P
></LI
></OL
>&#13;</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN195"
>2.2.3. Sevidor proxy de aplicación</A
></H3
><P
>El mejor ejemplo es el de una persona que se comunica con otro computador y, desde allí, establece contacto con el mundo exterior. Con un servidor proxy de aplicación el proceso se automatiza. Cuando usted se comunica con el mundo exterior el cliente le envía a Usted primero al servidor proxy. El servidor proxy establece la comunicación con el servidor que ha solicitado (el mundo exterior) y le devuelve los datos.</P
><P
>Los servidores proxy se encargan de manejar todas las comunicaciones, característica que le permite registrar todo lo que ellos (usted) haga. Los servidores proxy HTTP (web) tienen muy en cuenta las URL que ellos o usted visiten. Los proxy FTP incluyen cada fichero que usted descargue. Incluso pueden filtrar las palabras «inapropiadas» de los sitios que visite o escanear esos lugares en busca de virus.</P
><P
>Los servidores proxy de aplicación pueden autenticar a los usuarios. Antes de establecer una conexión con el exterior, el servidor le puede pedir que se identifique primero. A un usuario de la red le pediría una identificación para cada sitio que visite.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN200"
>2.2.4. Servidor Proxy SOCKS</A
></H3
><P
> 
Un servidor proxy SOCKS se parece bastante a un panel de conmutación. Tan sólo establece la conexión entre su sistema y otro sistema externo.</P
><P
>La mayoría de los servidores SOCKS presentan el inconveniente de que sólo trabajan con conexiones del tipo TCP y como cortafuegos no suministran autenticación para los usuarios. Sin embargo, su ventaja es que registran los sitios a los que cada usuario se ha conectado.</P
></DIV
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN204"
>3. Arquitectura cortafuegos</A
></H1
><P
>Existen muchas maneras de estructurar su red para proteger su sistema mediante el uso de un cortafuegos</P
><P
>Si tiene una conexión exclusiva para Internet a través de un encaminador, podría conectarlo directamente a su sistema cortafuegos o podría pasar por un concentrador de red (hub) para proporcionar a los servidores que se encuentran fuera del cortafuegos un acceso completo.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN208"
>3.1. Arquitectura conmutada</A
></H2
><P
>Si usa un servicio conmutado como una línea ISDN, se podría usar una tercera tarjeta de red que permita disponer de una red perimétrica (DMZ). Esto proporciona un control absoluto sobre los servicios de Internet, manteniéndolos separados de la red regular.</P
><P
><PRE
CLASS="SCREEN"
>&#13;               ______________
  _/\__/\_     |             |          ____________ 
 |        |    | Sistema de  |  (LAN)  | Estacion/  |
/ Internet \---| Cortafuegos |--(HUB)--| estaciones |
\_  _  _  _/   |_____________|         | de trabajo |
  \/ \/ \/           |                 |____________|
                    (DMZ) 
                    (HUB)</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN213"
>3.2. Arquitectura de encaminador único</A
></H2
><P
>En el encaminador existe la posibilidad de establecer algunas reglas estrictas para el filtro, siempre y cuando haya un encaminador o un módem de cable entre usted e Internet y usted sea el propietario del encaminador. Si el propietario del encaminador es su ISP y, en este caso, no tiene los controles que necesita, puede pedir a su ISP que agregue los filtros.</P
><P
><PRE
CLASS="SCREEN"
>               ____________          _____________         
  _/\__/\_    |Encaminador|         |            |         
 |        |   |   o       |  (DMZ)  | Sistema    |  (LAN)
/ Internet \--|Cablemódem |--(HUB)--| Cortafuegos|--(HUB)
\_  _  _  _/  |___________|    |    |____________|    |  
  \/ \/ \/                     |                      |
                            (Servidor)         _______+____
                            (Externo)          |Estacion/  |
                                               |Estaciones |
                                               |de Trabajo |
                                               |___________|</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN218"
>3.3. Cortafuegos con servidor proxy</A
></H2
><P
>Si tiene que controlar por dónde se mueven los usuarios de su red, la cual es pequeña, puede integrar un servidor proxy en su cortafuegos. Algunas veces, los ISP lo hacen para confeccionar una lista de interés de sus usuarios con el fin de revenderlas a agencias de marketing.</P
><P
><PRE
CLASS="SCREEN"
>                 _____________ 
  _/\__/\_      | Sistema     |          _______________
 |        |     | Proxy/      |  (LAN)  | Estación/ones | 
/ Internet \----| Cortafuegos |--(HUB)--|  de trabajo   |
\_  _  _  _/    |_____________|         |_______________| 
 \/ \/ \/</PRE
></P
><P
>Si lo prefiere, puede integrar el servidor proxy en su LAN, en cuyo caso, el cortafuegos debe poseer unas órdenes que hagan posible que el servidor proxy sólo se conecte a Internet para aquellos servicios que ofrece. De esta manera, los usuarios sólo podrán acceder a Internet a través del proxy.</P
><P
><PRE
CLASS="SCREEN"
>                 _____________ 
  _/\__/\_      |             |          ________________ 
 |        |     | Cortafuegos |  (LAN)  | Estacion/ones  | 
/ Internet \----|  Sistema    |--(HUB)--| de trabajo     | 
\_  _  _  _/    |_____________|    |    |________________| 
  \/ \/ \/                         |
                                   |      __________
                                   |     | Servidor |
                                   |+----| Proxy    | 
                                         |__________|</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN226"
>3.4. Configuración redundante de Internet</A
></H2
><P
>Si va a ejecutar un servicio como YAHOO o, tal vez, SlashDot, puede que desee compilar un programa multimódulo en su sistema empleando encaminadores redundantes y cortafuegos. ( Vea el Cómo de Alta Disponibilidad.)</P
><P
>Mediante la utilización de técnicas de circuito cíclico DNS para dar acceso a varios servidores web desde una URL y varios ISP, es posible crear un servicio de funcionamiento óptimo del 100% con encaminadores y cortafuegos que usan técnicas de alta disponibilidad.</P
><P
><PRE
CLASS="SCREEN"
>  _/\__/\_                                      _/\__/\_ 
 |        |                                    |        | 
/  ISP #1  \______                 (WAN)______/  Socios  \
\_  _  _  _/      |                (HUB)      \_  _  _  _/ 
  \/ \/ \/        |                ___|____     \/ \/ \/ 
                __|____           |_______ |          ______
  _/\__/\_     |______ |         |Sistemas||         |Est.  |
 |        |   |Enca-  ||  (DMZ)  |Corta-  ||  (LAN)  |Trab./| 
/  ISP #2  \--|minador||--(HUB)--| fuegos ||--(HUB)--|Serv. | 
\_  _  _  _/  |________|     |   |________|      |  |______| 
  \/ \/ \/                   |         |         |    ______ 
         |              (Servidor) (Servidor)    |   |      | 
 ------  |              (Externo) (Compartido)   +---|Proxy | 
|Est.  | |                                           |______| 
|Trab./|-+
|Serv. |
|VPN   |
|______|</PRE
></P
><P
>Es muy fácil que la red se le vaya de las manos. Verifique cada conexión. Todo lo que necesita es un usuario con su módem para comprometer su LAN.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN233"
>4. Instalación del cortafuegos de filtrado con Linux</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN235"
>4.1. Requerimientos del hardware</A
></H2
><P
> 
Los cortafuegos filtrados no requieren de un hardware muy sofisticado. Son poco más que simples encaminadores.</P
><P
>Todo lo que necesita es:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>un 486-DX66 con 32 megas de memoria RAM</P
></LI
><LI
><P
>un disco 250m (se recomienda uno de 500)</P
></LI
><LI
><P
>conexiones a la red (tarjetas LAN, puertos serie, ¿inalámbricos?)</P
></LI
><LI
><P
>monitor y teclador</P
></LI
></OL
>&#13;</P
><P
>Algunos sistemas que usan una consola con puerto serie pueden, incluso, prescindir del monitor y del teclado.</P
><P
>Si necesita un servidor proxy que soporte mucho tráfico, debería conseguir el sistema más completo que pueda permitirse. Esto se debe a que cada vez que un usuario se conecta al sistema, éste creará otro proceso.Si tuviese 50 o más usuarios fijos, estimo que necesitará:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>un Pentium II con 64 megas de memoria</P
></LI
><LI
><P
>un disco duro con dos gigas para almacenar todas las operaciones de registro</P
></LI
><LI
><P
>dos conexiones a la red</P
></LI
><LI
><P
>un monitor y un teclado</P
></LI
></OL
>

Las conexiones a la red pueden ser de cualquier tipo (tarjetas NIC, ISDN, incluso módems).</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN261"
>5. Requerimientos del Software</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN263"
>5.1. Selección del Núcleo</A
></H2
><P
> 
Para crear un cortafuegos de filtrado no es necesario ningún software especial. Linux lo hará. En el momento de escribir este Cómo, estoy usando RedHat 6.1.</P
><P
>La construcción en Linux del cortafuegos ha cambiado varias veces. Si está utilizando un núcleo antiguo de Linux (1.0.x o anterior) hágase con una nueva copia. Los más antiguos usaban ipfwadm de <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>http://www.xos.nl/linux/ipfwadm/</I
></SPAN
> que ya no está admitido.</P
><P
>Si está usando 2.2.13 o superior, estará usando ipchaining, que aparecía en <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>http://www.rustcorp.com/linux/ipchains/</I
></SPAN
></P
><P
>Si está utilizando el núcleo más reciente 2.4, hay una nueva utilidad de cortafuegos con más características. Pronto escribiré sobre ello.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN271"
>5.2. Selección de un servidor proxy</A
></H2
><P
>Si desea establecer un servidor proxy, necesitará uno de estos dos paquetes:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Squid</P
></LI
><LI
><P
>El TIS Firewall Toolkit (FWTK)</P
></LI
><LI
><P
>SOCKS</P
></LI
></OL
>&#13;</P
><P
>Squid es un gran paquete y trabaja con la característica de Proxy Transparente de Linux. Le indicaré cómo instalar este servidor.</P
><P
>En el momento de redactar este Cómo, se han fusionado <A
HREF="http://www.networkassociates.com/"
TARGET="_top"
>Network Associates</A
> y Trusted Information System's (TIS). Así que manténgase atento a los sitios web para ver más información sobre Tool Kit puede aún ser descargado desde<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
><A
HREF="http://www.tis.com/research/software/"
TARGET="_top"
>http://www.tis.com/research/software/</A
></I
></SPAN
></P
><P
>Trusted Information System saca a la luz una colección de programas diseñados para facilitar la creación de cortafuegos. Con este toolkit, usted instala un demonio para el servicio (WWW, telnet ect.) que esté usando en cada momento.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN288"
>6. Preparación del Sistema Linux</A
></H1
><P
>Instale tan sólo lo imprescindible del sistema Linux. Mi instalación comenzó con la configuración del servidor y luego desactivé todos los servicios en /etc/inetd.conf. Para más seguridad, deberá desinstalar los servicios innecesarios.</P
><P
>Puesto que la mayoría de las distribuciones no disponen de un núcleo que se adapte a sus necesidades, será preciso que compile su propio núcleo. Lo mejor será hacerlo con otro computador que no sea el cortafuegos. Si usted ha instalado un compilador C y otras utilidades en su cortafuegos, desinstálelos después de completar la configuración del núcleo.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN292"
>6.1. Compilación del núcleo</A
></H2
><P
> 
Comience con una instalación mínima de su distribución Linux. Cuantos menos programas cargue, menos agujeros, puertas traseras o fallos introducirán problemas de seguridad en su servidor.</P
><P
>Use un núcleo estable. Yo uso el núcleo 2.2.13 en mi sistema, por lo que esta documentación se basa en la instalación en ese núcleo.</P
><P
>Necesitará recompilar el núcleo Linux con las opciones apropiadas. Si usted no ha recompilado antes su núcleo, lea el Cómo Núcleo, el Cómo Ethernet, y el Cómo NET-2.</P
><P
>Aquí tiene la configuración relativa a la red en la que trabajo. He marcado algunas líneas con ?. Si usted usa esta aplicación, actívela también.</P
><P
>Yo uso "make menuconfig" para editar la configuración de mi núcleo.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>&#60;*&#62; Packet socket
[ ] Kernel/User netlink socket
[*] Network firewalls
[ ] Socket Filtering
&#60;*&#62; Unix domain sockets
[*] TCP/IP networking
[ ] IP: multicasting
[*] IP: advanced router
[ ] IP: kernel level autoconfiguration
[*] IP: firewalling
[?] IP: always defragment (required for masquerading)
[?] IP: transparent proxy support
[?] IP: masquerading
--- Protocol-specific masquerading support 
    will be built as modules.
[?] IP: ICMP masquerading
--- Protocol-specific masquerading support 
    will be built as modules.
[ ] IP: masquerading special modules support
[*] IP: optimize as router not host
&#60; &#62; IP: tunneling
&#60; &#62; IP: GRE tunnels over IP
[?] IP: aliasing support
[*] IP: TCP syncookie support (not enabled per default)
--- (it is safe to leave these untouched)
&#60; &#62; IP: Reverse ARP
[*] IP: Allow large windows (not recommended 
    if &#60;16Mb of memory)
&#60; &#62; The IPv6 protocol (EXPERIMENTAL)
---
&#60; &#62; The IPX protocol
&#60; &#62; Appletalk DDP
&#60; &#62; CCITT X.25 Packet Layer (EXPERIMENTAL)
&#60; &#62; LAPB Data Link Driver (EXPERIMENTAL)
[ ] Bridging (EXPERIMENTAL)
[ ] 802.2 LLC (EXPERIMENTAL)
&#60; &#62; Acorn Econet/AUN protocols (EXPERIMENTAL)
&#60; &#62; WAN router
[ ] Fast switching (read help!)
[ ] Forwarding between high speed interfaces
[ ] PU is too slow to handle full bandwidth
QoS and/or fair queueing  ---&#62;</PRE
> </P
><P
>Después de realizar la configuración que usted necesita, deberá recompilar, reinstalar el núcleo y reiniciar.</P
><P
>Use la orden:</P
><P
><B
CLASS="COMMAND"
>make dep; make clean; make bzlilo; make modules; make modules_install;init 6</B
> para llevarlo a cabo en un solo paso</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN305"
>6.2. Configuración de dos tarjetas de red</A
></H2
><P
> 
	Si su ordenador dispone de dos tarjetas de red, necesitará añadir una línea adicional a su fichero <TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
> para describir el IRQ  y la dirección de ambas tarjetas. La línea adicional será similar a ésta:</P
><P
> 
	<PRE
CLASS="PROGRAMLISTING"
>append="ether=12,0x300,eth0 ether=15,0x340,eth1"</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN311"
>6.3. Configuración de las Direcciones de Red</A
></H2
><P
> 
Ahora comienza la parte divertida de la instalación. No entraré en detalles sobre cómo instalar una LAN, para ello, lea el Cómo de redes en Linux.</P
><P
>Nuestro objetivo es disponer de dos conexiones a red para su sistema de filtro cortafuegos. Uno en el lado de Internet (el lado inseguro) y el otro en el LAN (el lado seguro).</P
><P
>De todas formas, tendrá que tomar decisiones.</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>¿Usará un número de dirección IP real, o se inventará alguno para su LAN?</P
></LI
><LI
><P
>¿Su ISP asignará la dirección IP dinámicamente, o usará direcciones IP fijos?</P
></LI
></OL
>&#13;</P
><P
>Puesto que lo que usted quiere es que desde Internet no se pueda acceder a su red privada, no deberá utilizar "direcciones reales", simplemente invéntese direcciones para su LAN privada. Esto no es muy recomendable, porque si los datos salen de su LAN, podrían terminar en el puerto de otro sistema.</P
><P
>Existe un rango de números de dirección para Internet destinado a redes privadas. Este rango es 192.168.1.xxx, el mismo que usaremos en nuestros ejemplos.</P
><P
>Para ello necesitará usar la máscara IP. Con este proceso, el cortafuegos enviará paquetes y los traducirá a una dirección IP "REAL " " para navegar por Internet.</P
><P
>Usando una dirección IP sin ruta, su red será más segura. Los encaminadores de Internet no pasarán paquetes con estas direcciones.</P
><P
>Llegado este punto puede resultar aconsejable que lea el Cómo de IP Masquerade.</P
><P
><PRE
CLASS="SCREEN"
>          24.94.1.123  ____________   192.168.1.1 
   _/\__/\_        \ |             | /         _______________ 
  |        |        \| Sistema     |/         | Estación/ones | 
 / Internet \--------| Cortafuegos |----------| de Trabajo    | 
 \_  _  _  _/        |_____________|          |_______________| 
   \/ \/ \/</PRE
></P
><P
>Deberá tener una dirección IP "real" para asignarle su tarjeta IP de red. Esta dirección le podrá ser asignada permanentemente. (Una dirección IP fija) o se le podrá asignar un tiempo de conexión a la red por el proceso PPP.</P
><P
>Elija el número IP interno. Por ejemplo, 192.168.1.1 a la tarjeta LAN. Esta será su dirección IP de puerta de enlace. De la misma forma, se podrá asignar a los demás computadores de la red protegida (LAN) un número del rango 192.168.1.xxx. (192.168.1.2 hasta 192.168.1.254)</P
><P
>Yo uso RedHat Linux para configurar la red y añado un fichero <TT
CLASS="FILENAME"
>ifcfg-eth1</TT
> en el directorio <TT
CLASS="FILENAME"
>/etc/sysconfig/network-scripts</TT
>. También podrá encontrar un fichero <TT
CLASS="FILENAME"
>ifcfg-ppp0</TT
> o <TT
CLASS="FILENAME"
>ifcfg-tr0</TT
> en este directorio. Estos ficheros 'ifcfg-' se usan en RedHat para configurar y desactivar los dispositivos de red al reiniciar el equipo, y se ejecutan después de la conexión. Se nombran después del tipo de conexión.</P
><P
>Aquí mostramos el fichero <TT
CLASS="FILENAME"
>ifcfg-eth1</TT
> (segunda tarjeta ehternet) como ejemplo;</P
><P
><PRE
CLASS="PROGRAMLISTING"
>DEVICE=eth1 
IPADDR=192.168.1.1 
NETMASK=255.255.255.0 
NETWORK=192.168.1.0 
BROADCAST=192.168.1.255 
GATEWAY=24.94.1.123 
ONBOOT=yes</PRE
></P
><P
>Si usa una conexión conmutada, necesitará ver los ficheros <TT
CLASS="FILENAME"
>ifcfg-ppp0</TT
> y <TT
CLASS="FILENAME"
>chat-ppp0</TT
>, que controlan su conexión PPP.</P
><P
>El fichero <TT
CLASS="FILENAME"
>ifcfg</TT
> debe tener un aspecto parecido al siguiente:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>    DEVICE="ppp0"           
    ONBOOT="yes"
    USERCTL="no"
    MODEMPORT="/dev/modem"      
    LINESPEED="115200"          
    PERSIST="yes"   
    DEFABORT="yes"  
    DEBUG="yes"     
    INITSTRING="ATZ"
    DEFROUTE="yes"  
    HARDFLOWCTL="yes"           
    ESCAPECHARS="no"
    PPPOPTIONS=""   
    PAPNAME="LoginID"           
    REMIP=""        
    NETMASK=""      
    IPADDR=""       
    MRU=""          
    MTU=""          
    DISCONNECTTIMEOUT=""        
    RETRYTIMEOUT="5"
    BOOTPROTO="none"</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN347"
>6.4. Comprobación de su red</A
></H2
><P
> 
	Empiece usando las órdenes <B
CLASS="COMMAND"
>ifconfig</B
> y <B
CLASS="COMMAND"
>route</B
>. Si usted tiene dos tarjetas de red, <B
CLASS="COMMAND"
>ifconfig</B
> deberá presentar un aspecto similar a éste:</P
><P
><PRE
CLASS="SCREEN"
># ifconfig
lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:3924  Metric:1
          RX packets:1620 errors:0 dropped:0 overruns:0
          TX packets:1620 errors:0 dropped:0 overruns:0
          collisions:0 txqueuelan:0

eth0      Link encap:10Mbps Ethernet  HWaddr 00:00:09:85:AC:55
          inet addr:24.94.1.123 Bcast:24.94.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1000 errors:0 dropped:0 overruns:0
          TX packets:1100 errors:0 dropped:0 overruns:0
          collisions:0 txqueuelan:0
          Interrupt:12 Base address:0x310

eth1      Link encap:10Mbps Ethernet  HWaddr 00:00:09:80:1E:D7
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1110 errors:0 dropped:0 overruns:0
          TX packets:1111 errors:0 dropped:0 overruns:0
          collisions:0 txqueuelan:0
          Interrupt:15 Base address:0x350</PRE
></P
><P
>y su tabla de encaminado similar a:</P
><P
><PRE
CLASS="SCREEN"
># route -n
Kernel routing table
Destination     Gateway         Genmask         Flags MSS    Window Use Iface
24.94.1.0       *               255.255.255.0   U     1500   0       15 eth0
192.168.1.0     *               255.255.255.0   U     1500   0        0 eth1
127.0.0.0       *               255.0.0.0       U     3584   0        2 lo
default         24.94.1.123     *               UG    1500   0       72 eth0</PRE
></P
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Nota:</I
></SPAN
> 24.94.1.0 se encuentra en lado de Internet del cortafuegos y 192.168.1.0  en el lado de la red privada (LAN).</P
><P
>Asegúrese de que todos los computadores de su LAN puedan conectar con la dirección interna de su sistema cortafuegos. (192.168.1.1 en este ejemplo) Si no conectan, vuelva al Cómo de Redes en Linux  y trabaje en la red un poco más.</P
><P
>Luego, desde el cortafuegos, trate de conectar con Internet. Yo uso www.internic.net com página de prueba. Si no funciona, inténtelo con un servidor de su ISP. Si aún así no funciona, es que alguna parte de su conexión a Internet es errónea. Desde el cortafuegos, debería poder conectarse a cualquier direcció de Internet. Trate de revisar la configuración de su puerta de enlace por defecto. Si usted usa una conexión conmutada, revise su nombre (ID) y contraseña (Password), relea el Cómo Net-2, e inténtelo de nuevo.</P
><P
>A continuación, trate de conectar con la dirección externa del cortafuegos (24.94.1.123) desde el computador de su LAN. Esto no debería ser posible, pero si lo consigue es que la máscara o el IP Forwarding están activados, o que ya se han filtrado grupos de paquetes. Apague los equipos e inténtelo de nuevo, puesto que necesita saber si el filtro está activo.</P
><P
>Para núcleos posteriores al 2.1.102 pueder usar la orden;</P
><P
>	<B
CLASS="COMMAND"
>echo "0" &#62; /proc/sys/net/ipv4/ip_forward</B
></P
><P
>Si usa un núcleo anterior (¿por qué?), necesitará recompilar su núcleo con el reenvío de paquetes desactivado. (O mejor actualícelo)</P
><P
>Intente conectar de nuevo con la dirección externa del cortafuegos (24.94.1.123). Ahora no debería conseguirlo.</P
><P
>Conecte a continuación el reenvío de paquetes o la máscara. Debería ser capaz de conectar con cualquier página de Internet desde cualquier equipo de su LAN.</P
><P
><B
CLASS="COMMAND"
>echo "1" &#62; /proc/sys/net/ipv4/ip_forward</B
></P
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>NOTA IMPORTANTE:</I
></SPAN
> Si usted usa una dirección IP "REAL" (que no sea 192.168.1.*) y no puede conectar con Internet, pero PUEDE hacerlo desde el lado de Internet del cortafuegos, asegúrese de que su proveedor de servicios de internet (ISP) encamina paquetes para la dirección de su red privada.</P
><P
>Una manera de comprobarlo es que algún amigo, usando un proveedor local, se conecte con su red. Si la conexión se detiene en el encaminador de su proveedor, entonces no permiten la entrada de información.</P
><P
>¿Funciona? Estupendo. La parte más difícil ha terminado.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN375"
>6.5. Protección del Cortafuegos</A
></H2
><P
>Un cortafuegos es inútil si el sistema en el que está instalado es vulnerable a ataques externos. Un "chico malo" podría acceder desde un servicio sin cortafuegos y modificar el sistema según sus propias necesidades. Usted tendrá que desactivar cualquier servicio innecesario.</P
><P
>Mire el fichero <TT
CLASS="FILENAME"
>/etc/inetd.conf</TT
>  Con él se configurará el <B
CLASS="COMMAND"
>inetd</B
>, también llamado "super servidor", que controla varios servidores demonio y los inicia, cuando se requiere, por un paquete que llega a un puerto "bien conocido".</P
><P
>Deberá desactivar cualquier echo, discard, daytime, chargen, ftp, gopher, shell, login, exec, talk, ntalk, pop-2, pop-3, netstat, systat, tftp, bootp,  finger, cfinger, time, swat que tenga en su cortafuegos.</P
><P
>Para apagarlo, ponga # como primer carácter de la línea de servicio. Una vez hecho esto, envíe un SIG-HUP al proceso mediante la orden <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>"kill -HUP &#60;pid&#62;"</I
></SPAN
>, donde &#60;pid&#62; es el número de preocesos de inetd. Con esto, el inetd se releerá su fichero de configuración (<TT
CLASS="FILENAME"
>inetd.conf</TT
>) y reiniciará  sin apagar el sistema.</P
><P
>Compruébelo haciendo telnet al puerto 15 (netstat) de su cortafuegos. Si se produce una salida de información por pantalla, no ha desactivado todos los servicios.</P
><P
><PRE
CLASS="SCREEN"
>telnet localhos 15</PRE
></P
><P
>Usted también puede crear el fichero <TT
CLASS="FILENAME"
>/etc/nologin</TT
>. Escriba unas cuantas líneas de texto del tipo (MORRALLA RELLENO). Una vez creado el fichero, la entrada de identificación no permitirá la conexión al usuario. Podrá ver los contenidos de este fichero pero no podrá conectar. Sólo root puede hacerlo.</P
><P
>También puede editar el fichero <TT
CLASS="FILENAME"
>/etc/securetty</TT
>. Si el usuario es root, entonces la entrada de identificación debe estar registrada en una tty listada en <TT
CLASS="FILENAME"
>/etc/securetty</TT
>. Los errores se registrarán en la utilidad <B
CLASS="COMMAND"
>syslog</B
>. Con estas dos medidas activadas, la única manera de conectar con el cortafuegos será desde la consola de root.</P
><P
>NUNCA haga un telnet a un sistema identificándose como root. Si necesita realizar acceso root remoto utilice SSH (Secure Shell); tal vez debería incluso desactivar telnet.</P
><P
>Si es usted realmente paranoico tendrá que usar el "lids" (Linux Intrusion Detect System), un parche para el núcleo de Linux que detecta cualquier intrusión en el sistema; el "lids" protege ficheros importantes impidiendo su modificación. Una vez activado, nadie (incluyendo root) puede modificar ficheros, directorios o subdirectorios, a menos que reinicie el sistema con la opción  de LILO security=1, especialmente concebido para modificar ficheros protegidos. (Yo iniciaría además el equipo en el modo de usuario único).</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN396"
>7. Instalación de filtros IP (IPFWADM)</A
></H1
><P
> 
Si está usando el núcleo 2.1.102 o uno más reciente, vaya directamente a la sección sobre  IPCHAINS.</P
><P
>En versiones anteriores al reenvío de paquetes IP se activa por defecto en el núcleo y, por eso, su red deberá comenzar denegándole el acceso a todo y purgando cualquier orden ipfw que fuera ejecutada por últimas vez. Este fragmento del guión debe entrar en el de arranque de red. (/etc/rc.d/init.d/network)</P
><P
><PRE
CLASS="PROGRAMLISTING"
>  #
  # setup IP packet Accounting and Forwarding
  #
  #   Forwarding
  #
  # By default DENY all services
  ipfwadm -F -p deny
  # Flush all commands
  ipfwadm -F -f
  ipfwadm -I -f
  ipfwadm -O -f</PRE
></P
><P
>Este es el último cortafuegos y nada podrá atravesarlo.</P
><P
>Ahora cree el fichero <TT
CLASS="FILENAME"
>/etc/rc.d/rc.firewall</TT
>. Este guión permitirá tráfico de correo, web y DNS ;-)</P
><P
>      <PRE
CLASS="PROGRAMLISTING"
>#! /bin/sh
#
# rc.firewall
#
# Bibioteca de funciones fuente
. /etc/rc.d/init.d/functions

# Obtenemos la configuracion
. /etc/sysconfig/network

# Comprobamos que la red esta activada.
if [ ${NETWORKING} = "no" ]
then
        exit 0
fi
case "$1" in
  start)
  echo -n "Iniciando servicios de cortafuego: "
  # Permitir que el correo llegue 
  # hasta el servidor de correo 
  /sbin/ipfwadm -F -a accept -b -P tcp \
          -S 0.0.0.0/0 1024:65535 -D 192.1.2.10 25
  # Permitir conexiones de correo 
  # hacia los servidores de correo externos
  /sbin/ipfwadm -F -a accept -b -P tcp \
          -S 192.1.2.10 25 -D 0.0.0.0/0 1024:65535
  # Permitir conexiones de correo 
  # hasta nuestro servidor Web
  /sbin/ipfwadm -F -a accept -b -P tcp \
          -S 0.0.0.0/0 1024:65535 -D 192.1.2.11 80
  # Permitir conexiones web 
  # hacia los servidores web externos
  /sbin/ipfwadm -F -a accept -b -P tcp \
          -S 192.1.2.* 80 -D 0.0.0.0/0 1024:65535 
  # Permitir trafico DNS
  /sbin/ipfwadm -F -a accept -b -P udp \
          -S 0.0.0.0/0 53 -D 192.1.2.0/24
  ;;
  stop)
  echo -n "Deteniendo los servicios de cortafuegos: "
  ipfwadm -F -p deny
  ;;
  status)
  echo -n "Se muestran ahora estadísticas del cortafuegos?"
  ;;
  restart|reload)
        $0 stop
        $0 start
        ;;
  *)
        echo "Uso: firewall {start|stop|status|restart|reload}"
        exit 1
esac</PRE
></P
><P
>NOTA: En este ejemplo tenemos el servidor de e-mail (smtp) ejecutándose en el 192.1.2.10, el cual debe ser capaz de recibir y enviar al puerto 25 (servidor web ejecutándose en el 192.1.2.11). Así, estamos permitiendo a cualquiera en el LAN acceder a redes externas y servidores DNS.</P
><P
>Sin embargo, esto no es muy seguro, ya que el puerto 80 no tiene que usarse como puerto de web, pues un hacker habilidoso podría usar este puerto para crear una red virtual privada (VPN) a través del cortafuegos. La forma de evitar esto es instalar un web proxy y sólo permitir actuar al proxy a través del cortafuegos. Así, los usuarios de LAN tendrían que atravesar el proxy para acceder a servidores de web externos.</P
><P
>Usted podrá estar interesado en eliminar tráfico a través de su cortafuegos. Este guión contabilizará cualquier paquete y usted podrá añadir una o dos líneas para eliminar los paquetes destinados a un único sistema.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>          
  # Flush the current accounting rules
  ipfwadm -A -f
  # Accounting
  /sbin/ipfwadm -A -f
  /sbin/ipfwadm -A out -i -S 192.1.2.0/24 -D 0.0.0.0/0
  /sbin/ipfwadm -A out -i -S 0.0.0.0/0 -D 192.1.2.0/24
  /sbin/ipfwadm -A in -i -S 192.1.2.0/24 -D 0.0.0.0/0
  /sbin/ipfwadm -A in -i -S 0.0.0.0/0 -D 192.1.2.0/24</PRE
></P
><P
>Si todo lo que usted necesita es un cortafuegos de filtro, puede parar aquí. Pruébelo y disfrútelo.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN413"
>8. Instalación de Filtros IP (IPCHAINS)</A
></H1
><P
>Ipchains es una nueva versión del código cortafuegos en Linux IPv4 y de ipfwadm, que, según creo, deriva del código de filtrado en BSD (ipfw). Para poder administrar los filtros de paquete IP en Linux, se requiere una versión del núcleo 2.1.102 o superior.</P
><P
>Las limitaciones del código de filtrado BSD (ipfw) son que no trabaja con fragmentos, tiene contadores de 32 bits (al menos en Intel), sólo puede manejar los protocolos TCP, UDP o ICMP, no permite hacer grandes cambios de forma automática, no permite especificar reglas inversas, presenta algunas anomalías, y, sin embargo, puede servir para gestionar (aunque es más fácil que se comentan errores). Al menos, eso es lo que dice el autor.</P
><P
>En realidad, no voy a profundizar sobre cómo controlar un cortafuegos IPChains, porque sobre ello ya existe un ¡GRAN! Cómo en la dirección <A
HREF="http://www.linuxdoc.org/HOWTO/IPCHAINS-HOWTO.html"
TARGET="_top"
>http://www.linuxdoc.org/HOWTO/IPCHAINS-HOWTO.html</A
>. Simplemente acabaría duplicándolo aquí. Apuntaré los conceptos básicos.</P
><P
>Empieza con tres listas de reglas denominadas "chains" (cadenas): input, output y forward, que no se pueden borrar. Usted mismo puede crear cadenas y, entonces, las reglas pueden ser insertadas o eliminadas desde ese conjunto de reglas.</P
><P
>Las operaciones para trabajar con cadenas completas son:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Crear una nueva cadena (-N).</P
></LI
><LI
><P
>Borrar un cadena vacía (-X).</P
></LI
><LI
><P
>Cambiar la política por defecto de una cadena (-P).</P
></LI
><LI
><P
>Listar las reglas contenidas en una cadena (-L).</P
></LI
><LI
><P
>Vaciar una cadena eliminando las reglas que contiene (-F).</P
></LI
><LI
><P
>Poner a cero los contadores de bytes y de paquetes en todas las reglas de una cadena (-Z).</P
></LI
></OL
>&#13;</P
><P
>Existen varias formas de maninpular las reglas de una cadena:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Añadir una nueva reglas a una cadena ya existente (-A).</P
></LI
><LI
><P
>Insertar una nueva reglas en una posición determinada en una cadena (-I).</P
></LI
><LI
><P
>Reemplazar la regla que ocupa una posición determinada en una cadena (-R).</P
></LI
><LI
><P
>Eliminar la regla que ocupa una posición determinada en una cadena (-D).</P
></LI
><LI
><P
>Eliminar la primera regla igual a la especificada de entre todas las reglas de una cadena (-D).</P
></LI
></OL
>&#13;</P
><P
>También hay algunas operaciones relativas al enmascaramiento IP, a falta de un lugar mejor donde colocarlas:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Ver una lista de todas las conexiones actuales que están siendo enmascaradas (-M -L).</P
></LI
><LI
><P
>Establecer el tiempo de espera máximo para una conexión enmascarada (-M -S).</P
></LI
></OL
>&#13;</P
><P
>Hay algunos elementos de la temporalización que pueden alterar las reglas del cortafuegos; por ello, si no es usted cuidadoso, podría dejar pasar algún paquete mientras realiza los cambios. Una aproximación simple es hacer lo siguiente:</P
><P
><PRE
CLASS="SCREEN"
># ipchains -I input 1 -j DENY 
# ipchains -I output 1 -j DENY 
# ipchains -I forward 1 -j DENY</PRE
></P
><P
>... hacer los cambios ...</P
><P
><PRE
CLASS="SCREEN"
># ipchains -D input 1 
# ipchains -D output 1 
# ipchains -D forward 1 
#</PRE
></P
><P
>Esto evitará que entren paquetes mientras usted esté realizando los cambios.</P
><P
>Aquí le presento un duplicado de las reglas del cortafuegos anterior en una IPChains.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh
#
# rc.firewall
#
## Flush everything, start from scratch
  /sbin/ipchains -F input
  /sbin/ipchains -F output
  /sbin/ipchains -F forward

## Redirect for HTTP Transparent Proxy
  #$IPCHAINS  -A input -p tcp -s 192.1.2.0/24 \
               -d 0.0.0.0/0 80 -j REDIRECT 8080

## Create your own chain
  /sbin/ipchains -N my-chain
  # Allow email to got to the server
  /sbin/ipchains -A my-chain -s 0.0.0.0/0 smtp \
                    -d 192.1.2.10 1024:-j ACCEPT
  # Allow email connections to outside email servers
  /sbin/ipchains -A my-chain -s 192.1.2.10 \
                 -d 0.0.0.0/0 smtp -j ACCEPT 	
  # Allow Web connections to your Web Server
  /sbin/ipchains -A my-chain -s 0.0.0.0/0 www \
                  -d 192.1.2.11 1024: -j ACCEPT
  # Allow Web connections to outside Web Server
  /sbin/ipchains -A my-chain -s 192.1.2.0/24 1024: \
                          -d 0.0.0.0/0 www -j ACCEPT
  # Allow DNS traffic
  /sbin/ipchains -A my-chain -p UDP -s 0.0.0.0/0 dns \
                             -d 192.1.2.0/24 -j ACCEPT

## If you are using masquerading
  # don't masq internal-internal traffic
  /sbin/ipchains -A forward -s 192.1.2.0/24 \
                    -d 192.1.2.0/24 -j ACCEPT
  # don't masq external interface direct
  /sbin/ipchains -A forward -s 24.94.1.0/24 \
                       -d 0.0.0.0/0 -j ACCEPT
  # masquerade all internal IP's going outside
  /sbin/ipchains -A forward -s 192.1.2.0/24 \
                         -d 0.0.0.0/0 -j MASQ

## Deny everything else
  /sbin/ipchains -P my-chain input DENY</PRE
></P
><P
>No se detenga aquí. Este cortafuegos no es muy grande y estoy seguro de que usted tiene otros servicios que le pueden ayudar. Por ello, lea de nuevo el Cómo IPCHAINS.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN466"
>9. Instalación de un Servidor Proxy SQUID Transparente</A
></H1
><P
>El servidor proxy squid está disponible en <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
> <A
HREF="http://www.squid-cache.org/"
TARGET="_top"
>http://www.squid-cache.org/</A
></I
></SPAN
>.</P
><P
>Los desarrolladores SQUID incluyen los paquetes RedHat y Debian. Si puede, use el paquete específico de su distribución.</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN472"
>10. Instalación del Servidor Proxy TIS</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN474"
>10.1. Cómo conseguir el Software</A
></H2
><P
>El TIS FWTK se puede conseguir en <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
><A
HREF="http://www.tis.com/research/software/ "
TARGET="_top"
>http://www.tis.com/research/software/</A
></I
></SPAN
>.</P
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>No cometa el mismo error que yo cometí.</I
></SPAN
> Cuando transfiera los archivos desde TIS, LEA EL APARTADO "LÉAME". El TIS fwtk se encuentra bloqueado en un directorio oculto de su servidor.</P
><P
>TIS requiere que lea sus condiciones en <A
HREF="http://www.tis.com/research/software/fwtk_readme.html "
TARGET="_top"
>http://www.tis.com/research/software/fwtk_readme.html</A
> y luego <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>envíe un e-mail a <A
HREF="mailto:fwtk-request@tislabs.com"
TARGET="_top"
>fwtk-request@tislabs.com</A
> </I
></SPAN
> con la palabra <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>accepted</I
></SPAN
> en el cuerpo del mensaje para conocer el nombre del directorio oculto. No es necesario que escriba ningún asunto en el mensaje. Posteriormente, su sistema le enviará el nombre del directorio (válido durante 12 horas) para descargar la fuente.</P
><P
>La versión 2.1. del FWTK resulta más fácil de compilar que cualquier versión previa.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN487"
>10.2. Compilación del TIS FWTK</A
></H2
><P
> 
La versión 2.1 del FWTK se compila mucho más fácilmente que cualquiera de las versiones anteriores.</P
><P
>Ejecute <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>make</I
></SPAN
> ahora.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN492"
>10.3. Instalación del TIS FWTK</A
></H2
><P
>Ejecute <B
CLASS="COMMAND"
>make install</B
>.</P
><P
>El directorio de la instalación por defecto es <TT
CLASS="FILENAME"
>/usr/local/etc</TT
>. Podría cambiarlo a un directorio más seguro. Yo opté por cambiar el acceso a este directorio por <B
CLASS="COMMAND"
>chmod 700</B
>.</P
><P
>Por último, sólo queda configurar el cortafuegos.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN500"
>10.4. Configuración del TIS FWTK</A
></H2
><P
> 
Ahora es cuando realmente empieza lo divertido. Debemos enseñar al sistema a denominar a estos nuevos servicios y a crear las tablas para controlarlos.</P
><P
>No voy a intentar rescribir aquí el manual de TIS FWTK. Le mostraré la configuración que encontré hecha y explicaré los problemas que me surgieron y cómo los solucioné.</P
><P
>Los archivos que componen estos controles son tres:</P
><P
>&#13;<P
></P
><UL
><LI
><P
><TT
CLASS="FILENAME"
>/etc/services</TT
>

<P
></P
><UL
><LI
><P
>Le dice al sistema en qué puertos se encuentra un servicio.</P
></LI
></UL
>&#13;</P
></LI
></UL
>


<P
></P
><UL
><LI
><P
><TT
CLASS="FILENAME"
>/etc/inetd.conf</TT
>

<P
></P
><UL
><LI
><P
>Le dice a <B
CLASS="COMMAND"
>inetd</B
> a qué programa llamar cuando alguien intenta conectarse a un puerto de servicio.</P
></LI
></UL
>&#13;</P
></LI
></UL
>


<P
></P
><UL
><LI
><P
><TT
CLASS="FILENAME"
>/usr/local/etc/netperm-table</TT
>

<P
></P
><UL
><LI
><P
>Le dice a los servicios FWTK a quién admitir y a quién denegar el servicio.</P
></LI
></UL
>&#13;</P
></LI
></UL
>&#13;</P
><P
>Para conseguir que el FWTK funcione, debe editar estos archivos de abajo hacia arriba. Editar el archivo de servicios sin haber configurado correctamente el archivo inetd.conf o netperm-table, podría hacer su sistema inaccesible.</P
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN529"
>10.4.1. El fichero netperm-table</A
></H3
><P
> 
Este archivo controla quién puede acceder a los servicios del TIS FWTK. Debería pensar en el tráfico y usar el cortafuegos desde ambos lados. La gente que se encuentre fuera de su red debería identificarse antes de poder tener acceso, y la que se encuentre dentro podría acceder directamente.</P
><P
>Para que la gente pueda identificarse, el cortafuegos utiliza un program llamado <TT
CLASS="FILENAME"
>authsrv</TT
> para tener una base de datos con los números de identificación (IP) y contraseñas de los usuarios. La sección de autenticación de netperm-table controla dónde se guarda la base de datos y quién puede tener acceso a ella.</P
><P
>Tuve algunos problemas a la hora de cerrar el acceso a este servicio. Observe que la entrada premit-hosts que muestro usa un *' para dar acceso a cualquiera. Si consigue que funcione, la configuración correcta para esta línea es '' <TT
CLASS="LITERAL"
>authsrv: premit-hosts localhost</TT
>.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>  #
  # Tabla de configuración del proxy
  #
  # Reglas de autenticación de clientes y servidores
  authsrv:	database /usr/local/etc/fw-authdb
  authsrv:	permit-hosts *
  authsrv:	badsleep 1200
  authsrv:	nobogus true
  # Client Applications using the Authentication server
  *:		authserver 127.0.0.1 114</PRE
></P
><P
>Para iniciar la base de datos debe hacerlo desde el usuario root y ejecutar <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>./authsrv</I
></SPAN
> en el directorio <TT
CLASS="FILENAME"
>/var/local/etc</TT
> para crear el registro administrativo del usuario. A continuación tiene un ejemplo de una sesión.</P
><P
>Lea la documentación FWTK para aprender a añadir usuarios y grupos.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>    #
    # authsrv
    authsrv# list
    authsrv# adduser admin "Auth DB admin"
    ok - user added initially disabled
    authsrv# ena admin
    enabled
    authsrv# proto admin pass
    changed
    authsrv# pass admin "plugh"
    Password changed.
    authsrv# superwiz admin
    set wizard
    authsrv# list
    Report for users in database
    user   group  longname           ok?    proto   last 
    ------ ------ ------------------ -----  ------  -----
    admin         Auth DB admin      ena    passw   never
    authsrv# display admin
    Report for user admin (Auth DB admin)
    Authentication protocol: password
    Flags: WIZARD
    authsrv# ^D
    EOT
    #</PRE
></P
><P
>Los controles de la puerta de enlace telnet (tn-gw), son muy sencillos y son los primeros que debería instalar.</P
><P
>En mi ejemplo, dejo que el sistema que se encuentra en la red privada tenga acceso sin tener que identificarse (permit-hosts 19961.2.* -passok), pero el resto de los usuarios deben introducir su número de identificación y contraseña para poder usar el proxy (permit-hosts * -auth)</P
><P
>También dejo que otro sistema aparte (192.1.2.202) tenga acceso directo al cortafuegos sin tener que pasar por éste. Existen dos líneas inetacl-in.telnetd para  hacerlo. Más tarde explicaré cómo se llaman estas líneas.</P
><P
>El intervalo de espera (timeout) de Telnet deberá ser corto.</P
><P
><PRE
CLASS="PROGRAMLISTING"
># telnet gateway rules:
tn-gw:	denial-msg	/usr/local/etc/tn-deny.txt
tn-gw:	welcome-msg	/usr/local/etc/tn-welcome.txt
tn-gw:	help-msg	/usr/local/etc/tn-help.txt
tn-gw:	timeout 90
tn-gw:	permit-hosts 192.1.2.* -passok -xok
tn-gw:	permit-hosts * -auth
# Only the Administrator can telnet 
# directly to the Firewall via Port 24
netacl-in.telnetd: permit-hosts 192.1.2.202 \
                   -exec /usr/sbin/in.telnetd</PRE
></P
><P
></P
><P
>Las órdenes que empiezan con la letra r- funcionan de la misma manera que telnet.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>  # rlogin gateway rules:
rlogin-gw:  denial-msg	/usr/local/etc/rlogin-deny.txt
rlogin-gw:  welcome-msg	/usr/local/etc/rlogin-welcome.txt
rlogin-gw:  help-msg	/usr/local/etc/rlogin-help.txt
rlogin-gw:  timeout 90
rlogin-gw:  permit-hosts 192.1.2.* -passok -xok
rlogin-gw:  permit-hosts * -auth -xok
# Only the Administrator can telnet 
#directly to the Firewall via Port
netacl-rlogind: permit-hosts 192.1.2.202 \
             -exec /usr/libexec/rlogind -a</PRE
></P
><P
>No debería permitir que nadie, incluyendo el FTP, acceda directamente a su cortafuegos; por lo tanto, no le ponga un servidor FTP.</P
><P
>Una vez más, la línea de acceso de los sitemas principales permite que cualquiera que se encuentre en la red protegida tenga libre acceso a Internet, mientras que los demás deben identificarse. Incluí el registro de cada fichero enviado, así como los que recibí en mis controles. (-log { retr stor })</P
><P
>El intervalo de espera ftp controla el tiempo que tardará en cortarse una mala conexión, así como el tiempo que se mantendrá abierta la conexión sin que sea usada.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>  # ftp gateway rules:
  ftp-gw:		denial-msg	/usr/local/etc/ftp-deny.txt
  ftp-gw:		welcome-msg	/usr/local/etc/ftp-welcome.txt
  ftp-gw:		help-msg	/usr/local/etc/ftp-help.txt
  ftp-gw:		timeout 300
  ftp-gw:		permit-hosts 192.1.2.* -log { retr stor }
  ftp-gw:		permit-hosts * -authall -log { retr stor }</PRE
></P
><P
>La web, el gopher y el navegador basado en el ftp se modifican con el http-gw. Las dos primeras líneas crean un directorio para almacenar el ftp y los documentos de la web a medida que pasan por el cortafuegos.Estos ficheros los creo bajo una raíz y los coloco en un directorio al que sólo se puede acceder a través de esa raíz.</P
><P
>La conexión a la web deberá ser corta. Controla el tiempo que tendrá esperar el usuario en el transcurso de una mala conexión.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>  # www and gopher gateway rules:
  http-gw:	userid		root
  http-gw:	directory	/jail
  http-gw:	timeout 90
  http-gw:	default-httpd	www.afs.net
  http-gw:	hosts 		192.1.2.* -log { read write ftp }
  http-gw:	deny-hosts 	* </PRE
></P
><P
>Realmente, la ssl-gw es una puerta de enlace. Tenga cuidado con esto. En este ejemplo dejo que cualquiera que se encuentre en la red protegida se conecte a cualquier servidor externo a la red, excepto a las direcciones 127.0.0.* y 192.1.1.*, y sólo de los puertos del 443 al 563. Los puertos del 443 al 563 se conocen como puertos SSL.</P
><P
><PRE
CLASS="PROGRAMLISTING"
># ssl gateway rules:
ssl-gw: timeout 300
ssl-gw: hosts 192.1.2.* \
          -dest { !127.0.0.* !192.1.1.* *:443:563 }
ssl-gw: deny-hosts  *</PRE
></P
><P
>A continuación hay un ejemplo sobre cómo usar la conexión gw para permitir las conexiones a un servidor de noticias. En este ejemplo, dejo que cualquiera que se encuentre dentro de la red protegida se conecte a un solo sistema y a su puerto de noticias.</P
><P
>La segunda línea permite al servidor de noticias transferir sus datos a la red protegida.</P
><P
>Dado que la mayoría de clientes permanecen conectados mientras el usuario lee los datos, el intervalo de espera de un servidor de datos deberá ser largo.</P
><P
><PRE
CLASS="PROGRAMLISTING"
> 
# NetNews Pluged gateway
plug-gw:        timeout 3600
plug-gw: port nntp 192.1.2.* -plug-to 24.94.1.22 -port nntp
plug-gw: port nntp 24.94.1.22 -plug-to 192.1.2.* -port nntp</PRE
></P
><P
>La puerta de enlace <B
CLASS="COMMAND"
>finger</B
> es sencilla. Cualquiera que se encuentre en la red protegida debe, en primer lugar, acceder al sistema y, posteriormente, nosotros le permitimos usar el programa finger, que se localiza en el cortafuegos. Los demás tan solo recibirán un mensaje como el siguiente:</P
><P
><PRE
CLASS="PROGRAMLISTING"
># Enable finger service 
netacl-fingerd: permit-hosts 192.1.2.* \
              -exec /usr/libexec/fingerd
netacl-fingerd: permit-hosts * -exec /bin/cat \
                      /usr/local/etc/finger.txt</PRE
></P
><P
>No he instalado los servicios de Mail y X-windows, así que no voy a dar ejemplos. Si alguien tiene un ejemplo, le agradecería que me enviase un e-mail.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN576"
>10.4.2. El fichero /etc/services</A
></H3
><P
> 
Aquí es donde empieza todo. Cuando un cliente se conecta al cortafuegos, éste se conecta a un puerto desconocido (inferior al 1024); por ejemplo, telnet se conecta al puerto 23. El demonio de inetd verifica esta conexión y busca el nombre del servicio en el fichero /etc/services. Luego llama al programa que tiene asignado este nombre en el fichero /etc/inetd.conf.</P
><P
>Algunos de los servicios que estamos creando no suelen encontrarse en el fichero /etc/services. Puede asignar algunos al puerto que desee; por ejemplo, he asignado el del administrador telnet (telnet-a) al puerto 24. Si hubiese querido, podría haberle asignado el puerto 2323. Para que el administrador (USTED) se conecte directamente al cortafuegos, tendrá que realizar una conexión telnet al puerto 24 y no al 23, y si instala su fichero netperm-table, como yo lo hice, sólo podrá hacerlo desde uno de los sistemas que se encuentran en su red protegida.</P
><P
><PRE
CLASS="PROGRAMLISTING"
> 
telnet-a        24/tcp
ftp-gw          21/tcp    	# this named changed
auth            113/tcp   ident # User Verification
ssl-gw          443/tcp</PRE
></P
></DIV
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN582"
>11. El Servidor Proxy SOCKS</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN584"
>11.1. Instalación del Servidor Proxy</A
></H2
><P
>El servidor proxy SOCKS se encuentra disponible en <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>http://www.socks.nec.com/</I
></SPAN
>.</P
><P
>Una vez descomprimidos, introduzca los archivos en un directorio de su sistema, y siga las instrucciones sobre cómo hacerlo. Tuve algunos problemas cuando lo hice. Asegúrese de que sus Makefiles son correctos.</P
><P
>Una cuestión importante que se debe tener en cuenta es que el servidor proxy necesita ser incluido en /etc/inetd.conf. Para ello debe añadir la línea:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>socks  stream  tcp  nowait  nobody  /usr/local/etc/sockd  sockd</PRE
></P
><P
>, que le comunica al servidor cuándo ha de ejecutarse.</P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN593"
>11.2. Configuración del Servidor Proxy</A
></H2
><P
> 
El programa SOCKS necesita dos ficheros de configuración: uno para comunicarnos que se nos permite el acceso, y otro para enviar las peticiones al servidor proxy correspondiente. El fichero de acceso debería estar en el servidor y el fichero encaminador debería incluirse en cada sistema UNIX. Los computadores DOS y, supuestamente, Macintosh encaminarán por sí mismos.</P
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN596"
>11.2.1. El fichero de Acceso</A
></H3
><P
>Con socks4.2 Beta, el fichero de acceso se llama "sockd.conf". Debería contener dos tipos de líneas: las de permiso y las de prohibición. Cada línea tendrá tres entradas:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>El Identificador (permit/deny)</P
></LI
><LI
><P
>La dirección IP</P
></LI
><LI
><P
>El modificador de dirección</P
></LI
></UL
>&#13;</P
><P
>El identificador es o "permit" (permitir) o "deny" (denegar). Debería tener una línea de cada.</P
><P
>La dirección IP se compone de cuatro octetos según la usual notación de puntos; por ejemplo, 192.168.1.0.</P
><P
>El modificador de dirección es también una dirección IP de cuatro octetos. Funciona como una máscara de red. Hay que verlo como 32 bits (unos o ceros). Si el bit es 1, el bit correspondiente de la dirección que esté comprobando debe coincidir con el bit correspondiente del campo de dirección IP; por ejemplo, si la línea es:</P
><P
>permit 192.168.1.23 255.255.255.255</P
><P
>admitirá sólo direcciones IP en las que coincida cada bit de 192.168.1.23; por ejemplo, sólo 192.168.1.3.  La línea:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>permit 192.168.1.0 255.255.255.0</PRE
></P
><P
>admitirá todas las direcciones desde la 192.168.1.0 hasta la 192.168.1.255, la subred de clase C completa. No debería aparecer la línea:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>permit 192.168.1.0 0.0.0.0</PRE
></P
><P
>ya que ésta permitiría el acceso a cualquier dirección, pase lo que pase.</P
><P
>Así que, permita primero todas las direcciones que quiera admitir, y luego prohiba el resto. Para permitir a cualquiera de la subred 192.168.1.xxx, las líneas:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>permit 192.168.1.0 255.255.255.0 
deny 0.0.0.0 0.0.0.0</PRE
></P
><P
>trabajarán perfectamente. Observe los primeros "0.0.0.0" en la línea de deny. Con un modificador de 0.0.0.0, el campo de dirección IP no importa. Se suele poner 0 porque es más fácil de teclear.</P
><P
>Se permite más de una entrada de cada clase.</P
><P
>También se puede conceder o denegar el acceso a usuarios concretos. Esto se consigue gracias a la autenticación ident. No todos los sistemas admiten ident, incluyendo Trumpet Winsock, así que no entraré en ello aquí. La documentación que acompaña a socks trata este tema adecuadamente.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN624"
>11.2.2. El Fichero de encaminado</A
></H3
><P
> 
El fichero de encaminado tiene el desafortunado nombre de "socks.conf".  Digo que es "desafortunado" porque se parece mucho al fichero de control de acceso, por lo que resulta fácil confundirlos.</P
><P
>El fichero de encaminado tiene la función de comunicar a los clientes de SOCKS cuándo usar socks y cuándo no. Por ejemplo, en nuestra red 192.168.1.3 no necesita usar socks para comunicarse con la 192.168.1.1, el cortafuegos. Tiene una conexión directa vía Ethernet. La dirección 127.0.0.1 define la vuelta atrás automáticamente. Por supuesto que no se necesita SOCKS para hablar consigo mismo. Existen tres tipos de entradas:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>deny</P
></LI
><LI
><P
>direct</P
></LI
><LI
><P
>sockd</P
></LI
></UL
>&#13;</P
><P
>La entrada deny (denegar) comunica a SOCKS cuándo rechazar una petición. Esta entrada dispone de los mismos tres campos que en sockd.conf, identifier, address y modifier. Generalmente, dado que de esto también se encarga el fichero sockd.conf, el fichero de control de acceso, el campo del modificador se pone a 0.0.0.0. Si quiere abstenerse de conectar a un determinado lugar, se puede hacer aquí.</P
><P
>La entrada direct nos dice para qué direcciones no se usa socks. Estas son todas las direcciones a las que se puede llegar sin el servidor proxy. De nuevo hay tres campos: identifier, address y modifier. Nuestro ejemplo tendría</P
><P
><PRE
CLASS="PROGRAMLISTING"
>direct 192.168.1.0 255.255.255.0</PRE
></P
><P
>Lo que nos llevaría directamente a cualquier máquina de nuestra red protegida.</P
><P
>La entrada sockd comunica en qué computador se encuentra el servidor demonio de socks. La sintaxis es:</P
><P
>sockd @=&#60;serverlist&#62; &#60;IP address&#62; &#60;modifier&#62;</P
><P
>Observe la entrada @=. Esta permite establecer las direcciones IP de una lista de servidores proxy. En nuestro ejemplo, sólo utilizamos un servidor proxy, pero puede tener muchos para admitir una carga mayor y un margen para redundancia en caso de fallo.</P
><P
>Los campos del modificador y de la dirección IP funcionan exactamente igual que en los otros ejemplos. Especifican a qué direcciones se van a través de los servidores 6.2.3. DNS desde detrás de un cortafuegos.</P
><P
>Instalar un servicio de nombres de dominio (DNS) desde detrás de un cortafuegos es una tarea relativamente sencilla. Sólo necesita instalar el DNS en el sistema cortafuegos. A continuación, configure cada sistema detrás del cortafuegos para usar este DNS.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN646"
>11.3. Cómo trabajar con un Servidor Proxy</A
></H2
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN648"
>11.3.1. Unix</A
></H3
><P
> 
Para que sus aplicaciones funcionen con el servidor proxy, necesitan ser "sockificadas".  Será necesario disponer de dos telnets distintos: uno para la comunicación directa y otro para la comunicación por medio del servidor proxy. SOCKS se acompaña de instrucciones sobre cómo SOCKificar un programa, así como un par de programas pre-SOCKificados. Si se usa la versión SOCKificada para conectar con algún sitio con el que se tiene acceso directo, SOCKS cambiará de manera automática a la versión para acceso directo. Por ello, tendremos que dar un nuevo nombre a todos los programas de nuestra red protegida y reemplazarlos por los programas SOCKificados. Así, "Finger" pasará a ser "finger.orig", "telnet" pasará a ser "telnet.orig", etc. Todo esto se dará a conocer a SOCKS mediante el fichero include/socks.h.</P
><P
>Algunos programas encaminarán y sockificarán por sí mismos.  Netscape es uno de ellos. Se puede usar un servidor proxy con Netscape simplemente introduciendo la dirección del servidor (en nuestro caso 192.168.1.1) en el campo SOCKs de Proxies.  Todas las aplicaciones necesitarán algún retoque, independientemente de cómo procese un servidor proxy.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN652"
>11.3.2. Trumpet Winsock con MS Windows</A
></H3
><P
> 
Trumpet Winsock viene con capacidad para el servidor proxy incorporada. En el menú "setup", se debe poner la dirección IP del servidor, y las direcciones de todos los computadores a los que llega directamente. Trumpet se encargará entonces de todos los paquetes de salida.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN655"
>11.3.3. Cómo preparar al Servidor Proxy para trabajar con Paquetes UDP</A
></H3
><P
> 
El paquete SOCKS trabaja sólo con paquetes TCP, no con UDP. Esto le resta utilidad. Muchos programas útiles, tales como talk y Archie, usan UDP. Existe un programa de aplicación diseñado para ser utilizado como servidor proxy para los paquetes UDP, denominados UDPrelay de Tom Fitzgerald &#60;fitz@wang.com&#62;. Desafortunadamente, en estos momentos, no es compatible con Linux.</P
></DIV
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN658"
>11.4. Inconvenientes con los Servidores Proxy</A
></H2
><P
> 
El servidor proxy es, por encima de todo, un <TT
CLASS="LITERAL"
>dispositivo de seguridad</TT
>. Usarlo para aumentar el acceso a Internet cuando se tienen pocas direcciones IP presentan muchos inconvenientes. Un servidor proxy permite un mayor acceso desde dentro de la red protegida al exterior, pero mantiene el interior completamente inaccesible desde el exterior. Esto significa la ausencia de servidores, de conexiones talk o archive, o el envío directo de correo a los computadores interiores. Estos inconvenientes podrían parecer insignificantes, pero piense en ello de la siguiente forma:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>Ha dejado un informe que está haciendo en su computador dentro de una red cortafuegos protegida. Está en casa y decide repasarla. No puede. No puede acceder a su computador, porque está detrás del cortafuegos. Intenta entrar primero al <TT
CLASS="LITERAL"
>cortafuegos</TT
>, pero como todo el mundo tiene acceso al exterior desde el servidor proxy, nadie se ha preocupado de abrirle una cuenta en él.&#13;</P
></LI
><LI
><P
>Su hija va a la universidad. Quiere enviarle un e-mail. Tiene cosas privadas que comentarle y preferiría que el correo llegara directamente a su computador. Confía plenamente en el administrador de su sistema; pero, sin embargo, es correo privado.&#13;</P
></LI
><LI
><P
>La incapacidad de utilizar paquetes UDP representa un gran inconveniente con los servidores proxy. Supongo que no por mucho tiempo.</P
></LI
></UL
>&#13;</P
><P
>FTP causa otro problema con un servidor proxy. Cuando se hace un <TT
CLASS="LITERAL"
>ls</TT
>, el servidor FTP establece una conexión con la máquina cliente y manda la información por ella. Un servidor proxy no lo permitirá, así que el FTP no funciona demasiado bien.</P
><P
>Además, un servidor proxy tarda en ejecutarse. Debido a la gran sobrecarga, casi cualquier otro medio de lograr acceso será más rápido.</P
><P
>En resumen, si tiene suficientes direcciones IP, y no le preocupa la seguridad, no use cortafuegos o servidores proxy. Si no dispone de suficientes direcciones IP, y tampoco le preocupa la seguridad, podría considerar la idea de utilizar un emulador IP, como Term, Slirp o TIA. Term está disponible en  <TT
CLASS="LITERAL"
>ftp://sunsite.unc.edu</TT
>, Slirp se encuentra en <TT
CLASS="LITERAL"
>ftp://blitzen.canberra.edu.au/pub/slirp</TT
>, y TIA, en marketplace.com.  Estos programas de aplicación van más rápido, permiten mejores conexiones y proporcionan un mayor nivel de acceso a la red interior desde Internet. Los servidores proxy están bien para las redes que tienen muchos sistemas que quieren conectar con Internet sobre la marcha, con una instalación y un mantenimiento mínimo.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN677"
>12. Configuraciones Avanzadas</A
></H1
><P
>Hay un configuración que me gustaría repasar antes de concluir este documento. La que acabo de esbozar posiblemente será suficiente para la mayoría de la gente; sin embargo, creo que el siguiente ejemplo mostrará una configuración más avanzada que puede aclarar algunas cuestiones. Si tiene duda sobre cualquier otro aspecto no tratado, o simplemente está interesado en la versatilidad de los servidores proxy y cortafuegos, siga leyendo.</P
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN680"
>12.1. Una gran red con el énfasis en la seguridad</A
></H2
><P
>Digamos, por ejemplo, que usted es el líder del clan millisha y quiere poner su sitio web. Dispone de 50 computadores y una subnet de 32 (5 bits) direccions IP. Necesita varios niveles de acceso dentro de su red porque comunica cosas diferentes a sus discípulos; por consiguiente, necesitará proteger ciertas partes de la red del resto.</P
><P
>Los niveles son:</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>El nivel externo. Este es nivel que se enseña a todo el mundo. Aquí es donde hecha una perorata para conseguir adeptos.&#13;</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Nivel iniciado</I
></SPAN
> Este es el nivel de la gente que ha superado el nivel externo. Es el lugar en el que les enseñan sobre el maldito gobierno y sobre cómo fabricar bombas.&#13;</P
></LI
><LI
><P
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Nivel adepto</I
></SPAN
>  Aquí es donde se guardan los <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>auténticos</I
></SPAN
> planes. En este nivel se almacena toda la información sobre cómo el gobierno del tercer mundo va a hacerse con el poder mundial, subplanes que involucran a Newt Gingrich, Oklahoma City, productos de escasa garantía y lo que realmente se almacena en ese hangar del área 51.</P
></LI
></OL
>&#13;</P
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN695"
>12.1.1. Instalación de Red</A
></H3
><P
>Los números IP están dispuestos de la siguiente forma:</P
><P
>&#13;<P
></P
><UL
><LI
><P
>un número es 192.168.1.255, que es la difusión y no es utilizable.</P
></LI
><LI
><P
>23 de las 32 direcciones IP se asignan a las 23 máquinas que serán accesibles a Internet.</P
></LI
><LI
><P
>una dirección IP extra es para una máquina Linux en esa red</P
></LI
><LI
><P
>una dirección IP extra es para otra máquina Linux en esa red</P
></LI
><LI
><P
>dos números de direcciones IP son para el encaminador</P
></LI
><LI
><P
>sobran cuatro, pero se les da los nombres de paul, ringo, john, y george, sólo para confundir las cosas un poco.</P
></LI
><LI
><P
>Las dos redes protegidas tienen direcciones del tipo 192.168.1.xxx</P
></LI
></UL
>&#13;</P
><P
>Entonces, se crean dos redes diferentes, cada una en espacios diferentes.  Son enviadas por medio de Ethernet infrarrojo, de manera que sean completamente invisibles al espacio exterior.</P
><P
>Cada una de estas redes está conectada a una máquina Linux con una dirección IP extra.</P
><P
>Existe un servidor de ficheros que conecta a las dos redes protegidas.  Esto se debe a que los planes para hacerse con el poder mundial implica a algunos de los iniciados más aventajados.  El servidor de ficheros presenta la dirección 192.168.1.17 para la red de iniciados y la 192.168.1.23 para los adeptos.  Tiene que tener asociadas diferentes direcciones IP ya que tiene dos tarjetas Ethernet.  El reenvío de paquetes IP está desconectado.</P
><P
>El reenvío de paquetes IP también está conectado en ambas máquinas Linux.  El encaminador no enviará paquetes destinados a 192.168.1.xxx a menos que se le indique explícitamente lo contrario, así que Internet no podrá entrar.  La razón para desconectar el reenvío de paquetes IP aquí es para que los paquetes de la red de adeptos no llegue a la de iniciados, y viceversa.</P
><P
>El servidor NFS también se puede utilizar para ofrecer diferentes ficheros a las diferentes redes.  Esto puede venir muy bien, y el empleo de algunos trucos con enlaces simbólicos puede hacer que se compartan ficheros comunes a todos.  Con esta instalación y otra tarjeta Ethernet, el mismo servidor de ficheros puede dar servicio al conjunto de las tres redes.</P
></DIV
><DIV
CLASS="SECT3"
><HR><H3
CLASS="SECT3"
><A
NAME="AEN719"
>12.1.2. Instalación del Servidor Proxy</A
></H3
><P
>Ahora, dado que los tres niveles quieren navegar por Internet en beneficio de sus propios intereses, los tres necesitan tener acceso a ella.  La red externa está conectada directamente a Internet, así que aquí no tenemos que modificar los servidores proxy.  Las redes de adeptos e iniciados están detrás del cortafuegos, así que es necesario instalar aquí los servidores proxy.</P
><P
>Ambas redes se instalarán de forma muy parecida.  Ambas tienen asignadas las mismas direcciones IP.  Expondré un par de requisitos, sólo para añadir mayor interés.</P
><P
>&#13;<P
></P
><OL
TYPE="1"
><LI
><P
>Nadie puede usar el servidor de ficheros para acceder a Internet.  Esto expone al servidor de ficheros a virus y a otras cosas desagradables, y es muy importante, por lo que queda prohibido.&#13;</P
></LI
><LI
><P
>No se permitirá a los iniciados acceso a la World Wide Web.  Están en pruebas y la adquisición de este tipo de información podría resultar perjudicial.</P
></LI
></OL
>&#13;</P
><P
>Así que, el fichero sockd.conf en el Linux de los iniciados presentará esta línea:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>deny 192.168.1.17 255.255.255.255</PRE
></P
><P
>y en la máquina de los adeptos:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>deny 192.168.1.23 255.255.255.255</PRE
></P
><P
>Y, la máquina Linux de los iniciados tendrá estea línea</P
><P
><PRE
CLASS="PROGRAMLISTING"
>deny 0.0.0.0 0.0.0.0 eq 80</PRE
></P
><P
>Esto significa denegar el acceso a todas las máquinas que traten de acceder al puerto igualr (eq) a 80, el puerto http. Aunque esto aún permita el acceso al resto de los servicios, deniega el acceso a la Web.</P
><P
>A continuación, ambos ficheros tendrán:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>permit 192.168.1.0 255.255.255.0</PRE
></P
><P
>para permitir a todos los computadores de la red 192.168.1.xxx usar este servidor proxy, exceptuando aquéllos a los que ya se le ha denegado (por ejemplo, cualquier acceso desde el servidor de ficheros y el acceso a la Web desde la red iniciados)</P
><P
>El fichero sockd.conf de los iniciados será:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>deny 192.168.1.17 255.255.255.255 
deny 0.0.0.0 0.0.0.0 eq 80 
permit 192.168.1.0 255.255.255.0</PRE
></P
><P
>y el de los adeptos:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>deny 192.168.1.23 255.255.255.255 
permit 192.168.1.0 255.255.255.0</PRE
></P
><P
>Con esto, todo debería quedar configurado correctamente. Cada red se encuentra aislada como corresponde, con el grado de interaccón adecuado. Todos deberíamos estar satisfechos.</P
></DIV
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN750"
>13. Cómo facilitar la Gestión</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN752"
>13.1. Herramientas Cortafuegos</A
></H2
><P
>Existen varios paquetes de software que facilitarán la gestión de su cortafuegos.</P
><P
>Tenga cuidado, no utilice estas herramientas a menos que pueda prescindir de ellas. Estas programaciones de guiones tanto pueden facilitarle la tarea como conducirle a errores.</P
><P
>Tanto las interfaces de la web como las gráficas han sido diseñadas para trabajar con las normas de filtración de Linux. Algunas compañías incluso han creado cortafuegos comerciales basados en Linux introduciéndolo en su propia máquina con su propio código de gestión. (todo un detalle)</P
><P
>En realidad, no soy un tipo GUI. Sin embargo, llevo utilizando cortafuegos con interfaces GUI desde hace algún tiempo. He descubierto que ayudan proporcionando un buen informe de todas las reglas de forma muy clara.</P
><P
><B
CLASS="COMMAND"
>gfcc</B
> (GTK+ Firewall Control Center) es una aplicación GTK+ capaz de controlar las reglas y directrices del cortafuegos de Linux, basadas en el paquete ipchains. Vaya a <A
HREF="http://icarus.autostock.co.kr/"
TARGET="_top"
>http://icarus.autostock.co.kr</A
> y hágase con una copia. Sinceramente es una excelente herramienta.</P
><P
>He incluido listados de guiones RC en el apéndice A. Estos guiones funcionan con y sin <B
CLASS="COMMAND"
>gfcc</B
>.</P
><P
>Existen muchas programaciones de guiones disponibles para instalar un cortafuegos. Una línea de guión bastante completo está disponible en <A
HREF="http://www.jasmine.org.uk/~simon/bookshelf/papers/instant-firewall/instant-firewall.html"
TARGET="_top"
>http://www.jasmine.org.uk/~simon/bookshelf/papers/instant-firewall/instant-firewall.html</A
>. Otra se encuentra en <A
HREF="http://www.pointman.org/"
TARGET="_top"
>http://www.pointman.org/</A
>.</P
><P
>El cortafuegos K es un punto de inicio GUI para cadenas ipchains o ipfwadm (dependiendo de la versión de su núcleo). <A
HREF="http://megaman.ypsilonia.net/kfirewall/"
TARGET="_top"
>http://megaman.ypsilonia.net/kfirewall/</A
></P
><P
>FCT es una herramienta basada en HTML para la configuración de un cortafuegos. Genera programación de guiones de manera automática para órdenes de filtración IP (ipfwadm) en un cortafuegos para múltiples interfaces y cualquier servicio de Internet. <A
HREF="http://fct.linuxfirewall.org"
TARGET="_top"
>http://fct.linuxfirewall.org</A
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN770"
>13.2. Herramientas Generales</A
></H2
><P
>WebMin es un paquete de aplicación admin para sistemas. No le ayudará a gestionar las reglas, pero le ayudará a la hora de activar y desactivar demonios y procesos. Es un programa MUY bueno, estoy esperando que el señor J. Cameron incluya un módulo de cadenas IPCHAINS. <A
HREF="http://www.webmin.com/"
TARGET="_top"
>http://www.webmin.com/</A
></P
><P
>Si es usted un ISP, querrá saber sobre IPFA (Contabilidad para Cortafuegos IP) <A
HREF="http://www.soaring-bird.com/ipfa/"
TARGET="_top"
>http://www.soaring-bird.com/ipfa/</A
>. Le permite hacer registros cronológicos por mes, por día o por minutos y dispone de una administración por interfaz gráfica de usuario basada en Web.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN776"
>14. Cómo burlar un sistema cortafuegos</A
></H1
><P
>Le revelaré lo fácil que resulta burlar un sistema cortafuegos tan
solo para arruinarle el día y para que se mantenga alerta en lo que
respecta al tema de la seguridad. Precisamente ahora que ha seguido
todos los pasos de este documento y tiene un servidor y una red muy
seguros. Dispone de una red perimétrica (DMZ ) y nadie puede acceder a
su red; además, cualquier conexión que se haga al exterior queda
registrada. Cualquier usuario que quiera acceder a la red debe hacerlo
a través de un servidor proxy.</P
><P
>Entonces uno de sus usuarios, con conexión propia, averigua lo de<A
HREF="http://www.nocrew.org/software/httptunnel.html"
TARGET="_top"
>httptunnel</A
>. httptunnel crea un túnel bidireccional de datos virtuales en los HTTP solicitados. Estos HTTP pueden ser enviados a través de un servidor proxy HTTP si así se desea. O, en sus sistemas instalan una Red Privada Virtual (VPN). Véase a este respecto: <A
HREF="http://sunsite.auc.dk/vpnd/"
TARGET="_top"
>http://sunsite.auc.dk/vpnd/</A
> </P
><P
>O, quizá este usuario simplemente ponga un módem en su sistema NT y
establezca el encaminado. Por último, en la estación de trabajo, en la
LAN privada, cambia la puerta de enlace por defecto para indicarle la
nueva ruta que debe seguir para acceder a Internet. Ahora, desde esta
estación de trabajo, puede ir a cualquier parte. La única cosa que el
admin del cortafuegos podría ver sería una conexión que no deja ver
que es realmente una larga visita DNS. Ahora, !tome el control del
mundo!</P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN783"
>15. APÉNDICE A - Guiones de ejemplo</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN785"
>15.1. Guión RC usando GFCC</A
></H2
><P
><PRE
CLASS="PROGRAMLISTING"
>#!/bin/bash
#
# Firewall Script - Version 0.9.1
#
# chkconfig: 2345 09 99
# description: firewall script for 2.2.x kernel
# Set for testing
# set -x
#
# NOTES:
#
#  This script is written for RedHat 6.1 or better.
#
#  Be careful about offering public services 
#  like web or ftp servers.
#
# INSTALLATION:
#  1. place this file in /etc/rc.d/init.d  
#     (you'll have to be root..)
#     call it something like "firewall"    :-)
#     make it root owned --&#62;  "chown root.root (filename)"
#     make it executable --&#62;  "chmod 755 (filename)"
#
#  2. use GFCC to create your firewall rules 
#     and export them to a file
#     named /etc/gfcc/rules/firewall.rule.sh.
#
#  3. add the firewall to the RH init 
#     structure --&#62; "chkconfig --add (filename)"
#     next time the router boots, 
#     things should happen automagically!
#     sleep better at night 
#     knowing you are *LESS* vulnerable than before...
#
# RELEASE NOTES
#   30 Jan, 2000 - Changed to GFCC script 
#   11 Dec, 1999 - 
#    updated by Mark Grennan &#60;mark@grennan.com&#62;
#   20 July, 1999 -
#    initial writing - Anthony Ball &#60;tony@LinuxSIG.org&#62;
#

################################################

# Source function library.
. /etc/rc.d/init.d/functions

# Source networking configuration.
. /etc/sysconfig/network

# Check that networking is up.
[ ${NETWORKING} = "no" ] &#38;&#38; exit 0

# See how we are called
case "$1" in

  start)
	# Start providing access
	action "Starting firewall: " /bin/true
	/etc/gfcc/rules/firewall.rule.sh
	echo
	;;

  stop)
	action "Stoping firewall: " /bin/true
	echo 0 &#62; /proc/sys/net/ipv4/ip_forward
	/sbin/ipchains -F input
	/sbin/ipchains -F output
	/sbin/ipchains -F forward

	echo
	;;

  restart)
	action "Restarting firewall: " /bin/true
	$0 stop
	$0 start

	echo
	;;

  status)
	# List out all settings
	/sbin/ipchains -L
	;;

  test)
	action "Test Mode firewall: " /bin/true
	/sbin/ipchains -F input
	/sbin/ipchains -F output
	/sbin/ipchains -F forward
	echo 1 &#62; /proc/sys/net/ipv4/ip_forward
	/sbin/ipchains -A input -j ACCEPT
	/sbin/ipchains -A output -j ACCEPT
	/sbin/ipchains -P forward DENY
	/sbin/ipchains -A forward -i $PUBLIC -j MASQ

	echo
	;;

  *)
	echo "Usage: $0 {start|stop|restart|status|test}"
	exit 1

esac</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN789"
>15.2. Guión GFCC</A
></H2
><P
>Este guión fue generado por el programa de Cortafuegos Gráfico (GFCC).  Este no es el conjunto de reglas en funcionamiento, sino el conjunto de reglas exportadas.</P
><P
><PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh
# Generated by Gtk+ firewall control center

IPCHAINS=/sbin/ipchains


localnet="192.168.1.0/24"
firewallhost="192.168.1.1/32"
localhost="172.0.0.0/8"
DNS1="24.94.163.119/32"
DNS2="24.94.163.124/32"
Broadcast="255.255.255.255/32"
Multicast="224.0.0.0/8"
Any="0.0.0.0/0"
mail_grennan_com="192.168.1.1/32"
mark_grennan_com="192.168.1.3/32"

$IPCHAINS -P input DENY
$IPCHAINS -P forward ACCEPT
$IPCHAINS -P output ACCEPT

$IPCHAINS -F
$IPCHAINS -X

# input rules
$IPCHAINS -A input -s $Any \
     -d $Broadcast -j DENY 
$IPCHAINS -A input -p udp -s $Any \
     -d $Any netbios-ns -j DENY 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any netbios-ns -j DENY 
$IPCHAINS -A input -p udp -s $Any \
     -d $Any netbios-dgm -j DENY 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any netbios-dgm -j DENY 
$IPCHAINS -A input -p udp -s $Any \
     -d $Any bootps -j DENY 
$IPCHAINS -A input -p udp -s $Any \
     -d $Any bootpc -j DENY 
$IPCHAINS -A input -s $Multicast \
     -d $Any -j DENY 
$IPCHAINS -A input -s $localhost \
     -d $Any -i lo -j ACCEPT 
$IPCHAINS -A input -s $localnet \
     -d $Any -i eth1 -j ACCEPT 
$IPCHAINS -A input -s $localnet \
     -d $Broadcast -i eth1 -j ACCEPT 
$IPCHAINS -A input -p icmp -s $Any \
     -d $Any -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any -j ACCEPT ! -y 
$IPCHAINS -A input -p udp -s $DNS1 domain \
     -d $Any 1023:65535 -j ACCEPT 
$IPCHAINS -A input -p udp -s $DNS2 domain \
     -d $Any 1023:65535 -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any ssh -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any telnet -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any smtp -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any pop-3 -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any auth -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any www -j ACCEPT 
$IPCHAINS -A input -p tcp -s $Any \
     -d $Any ftp -j ACCEPT 
$IPCHAINS -A input -s $Any \
     -d $Any -j DENY -l 

# forward rules
$IPCHAINS -A forward -s $localnet -d $Any -j MASQ 

# output rules</PRE
></P
></DIV
><DIV
CLASS="SECT2"
><HR><H2
CLASS="SECT2"
><A
NAME="AEN794"
>15.3. Guión RC sin GFCC. Este es el conjunto de reglas de cortafuegos hecho por mí. 
No utiliza GFCC.</A
></H2
><P
><PRE
CLASS="PROGRAMLISTING"
>#!/bin/bash
#
# Firewall Script - Version 0.9.0

# chkconfig: 2345 09 99
# description: firewall script for 2.2.x kernel

# Set for testing
# set -x

#
# NOTES:
#
#  This script is written for RedHat 6.0 or better.
#
#  This firewall script should work for most routers, 
#  dial-up or cable modem.
#  It was written for RedHat distributions. 
#
#  Be careful about offering public 
#  services like web or ftp servers.
#
# INSTALLATION:
# 1. This file planned for a RedHat system.  
#    It would work on other distro's 
#    with perhaps no modification, but again...
#    Who knows?!!?  
#    These instructions apply to RedHat systems.
#
# 2. place this file in /etc/rc.d/init.d  
#   (you'll have to be root..)
#    call it something like "firewall"    :-)
#    make it root owned 
#    --&#62;  "chown root.root &#60;filename&#62;"
#    make it executable 
#    --&#62;  "chmod 755 &#60;filename&#62;"
#
# 3. set the values for your network, 
#    internal interface, and DNS servers
#    uncomment lines further down 
#    to enable optional in-bound services
#    make sure "eth0" is your internal NIC 
#    (or change the value below)
#    test it 
#    --&#62;  "/etc/rc.d/init.d/&#60;filename&#62; start"
#    you can list the rules --&#62;  "ipchains -L -n"
#    fix anything that broke...  :-)
#
# 4. add the firewall 
#    to the RH init structure 
#    --&#62; "chkconfig --add &#60;filename&#62;"
#    next time the router boots, 
#    things should happen automagically!
#    sleep better at night  knowing you are 
#    *LESS* vulnerable than before...
#
# RELEASE NOTES
#   20 July, 1999 - initial writing -
#   Anthony Ball &#60;tony@LinuxSIG.org&#62;
#   11 Dec, 1999 - updated by 
#   Mark Grennan &#60;mark@grennan.com&#62;
#

################################################
#  Fill in the values below to match your
#  local network.

PRIVATENET=xxx.xxx.xxx.xxx/xx

PUBLIC=ppp0
PRIVATE=eth0

# your dns servers
DNS1=xxx.xxx.xxx.xxx
DNS2=xxx.xxx.xxx.xxx

################################################

# some handy generic values to use
ANY=0.0.0.0/0
ALLONES=255.255.255.255

# Source function library.
. /etc/rc.d/init.d/functions

# Source networking configuration.
. /etc/sysconfig/network

# Check that networking is up.
[ ${NETWORKING} = "no" ] &#38;&#38; exit 0

# See how we are called
case "$1" in

  start)
	# Start providing access
	action "Starting firewall: " /bin/true

	##
	## Setup Envirement
	##
	# Flush all lists
	/sbin/ipchains -F input
	/sbin/ipchains -F output
	/sbin/ipchains -F forward

	# Plug up everything
	/sbin/ipchains -I input 1 -j DENY

	# set policy to deny (Default is ACCEPT)
	/sbin/ipchains -P input DENY
	/sbin/ipchains -P output ACCEPT
	/sbin/ipchains -P forward ACCEPT

	# Turn on packet forwarding
	echo 1 &#62; /proc/sys/net/ipv4/ip_forward

	##
	## Install Modules 
	##
	# Insert the active ftp module.  
	# This will allow non-passive ftp to machines
	# on the local network 
	# (but not to the router since it is not masq'd)
	if ! ( /sbin/lsmod | /bin/grep masq_ftp &#62; /dev/null ); \
                                                                then
	    /sbin/insmod ip_masq_ftp
	fi

	##
	## Some Security Stuff
	##
	# turn on Source Address Verification 
        # and get spoof protection
	# on all current and future interfaces.
	if [ -e /proc/sys/net/ipv4/conf/all/rp_filter ]; then
	    for f in /proc/sys/net/ipv4/conf/*/rp_filter; do
	        echo 1 &#62; $f
	    done
	else
	    echo
	    echo "PROBLEMS SETTING UP IP SPOOFING PROTECTION"
            echo "BE WORRIED."
	    echo
	fi

	# deny bcasts on remaining interfaces
	/sbin/ipchains -A input -d 0.0.0.0 -j DENY
	/sbin/ipchains -A input -d 255.255.255.255 -j DENY

	# deny these without logging 
        # because there tend to be a lot...
	# NetBIOS over IP
	/sbin/ipchains -A input -p udp -d $ANY 137 -j DENY
        # NetBIOS over IP
	/sbin/ipchains -A input -p tcp -d $ANY 137 -j DENY 
	# NetBIOS over IP
	/sbin/ipchains -A input -p udp -d $ANY 138 -j DENY
	# NetBIOS over IP
	/sbin/ipchains -A input -p tcp -d $ANY 138 -j DENY
	# bootp
	/sbin/ipchains -A input -p udp -d $ANY 67 -j DENY 
	# bootp
	/sbin/ipchains -A input -p udp -d $ANY 68 -j DENY
        # Multicast addresses
	/sbin/ipchains -A input -s 224.0.0.0/8 -j DENY 

	##
	## Allow private network out
	##
	# allow all packets on the loopback interface
	/sbin/ipchains -A input -i lo -j ACCEPT

	# allow all packets from the internal "trusted" interface
	/sbin/ipchains -A input -i $PRIVATE -s $PRIVATENET \
                                           -d $ANY -j ACCEPT
	/sbin/ipchains -A input -i $PRIVATE \
                        -d $ALLONES -j ACCEPT

	## 
	## Allow Outside Services into the firewall (if you dare)
	##
	# allow ICMP
	/sbin/ipchains -A input -p icmp -j ACCEPT
	# allow TCP
	/sbin/ipchains -A input -p tcp ! -y -j ACCEPT

	# allow lookups to DNS (on firewall)
	/sbin/ipchains -A input -p udp -s $DNS1 domain \
                                 -d $ANY 1023: -j ACCEPT
	/sbin/ipchains -A input -p udp -s $DNS2 domain \
                                 -d $ANY 1023: -j ACCEPT
	# or (BETTER IDEA) run a caching DNS server 
        # on the router and use the 
	# following two/four lines instead...
	# /sbin/ipchains -A input -p udp -s $DNS1 domain \
        #                          -d $ANY domain -j ACCEPT
	# /sbin/ipchains -A input -p udp -s $DNS2 domain \
        #                          -d $ANY domain -j ACCEPT

	# uncomment the following to allow ssh in
	/sbin/ipchains -A input -p tcp -d $ANY 22 -j ACCEPT

	# uncomment the following to allow telnet in (BAD IDEA!!)
	/sbin/ipchains -A input -p tcp -d $ANY telnet -j ACCEPT

	# uncomment to allow NTP 
        # (network time protocol) to router
	# /sbin/ipchains -A input -p udp -d $ANY ntp -j ACCEPT

	# uncomment to allow SMTP in 
        # (not for mail clients - only a server)
	/sbin/ipchains -A input -p tcp -d $ANY smtp -j ACCEPT

	# uncomment to allow POP3 in (for mail clients)
	/sbin/ipchains -A input -p tcp -d $ANY 110 -j ACCEPT

	# allow auth in for sending mail or doing ftp
	/sbin/ipchains -A input -p tcp -d $ANY auth -j ACCEPT

	# uncomment to allow HTTP in 
        # (only if you run a web server on the router)
	/sbin/ipchains -A input -p tcp -d $ANY http -j ACCEPT

	# uncomment to allow FTP in
	/sbin/ipchains -A input -p tcp -d $ANY ftp -j ACCEPT

	##
	## Masquerading stuff
	##
	# masquerade packets forwarded from internal network
	/sbin/ipchains -A forward -s $PRIVATENET -d $ANY -j MASQ

	##
	## deny EVERYthing else 
        ## and log them to /var/log/messages
	/sbin/ipchains -A input -l -j DENY

	# Remove the Plug
	/sbin/ipchains -D input 1

	;;

  stop)
	action "Stoping firewall: " /bin/true
	echo 0 &#62; /proc/sys/net/ipv4/ip_forward
	/sbin/ipchains -F input
	/sbin/ipchains -F output
	/sbin/ipchains -F forward

	echo
	;;

  restart)
	action "Restarting firewall: " /bin/true
	$0 stop
	$0 start

	echo
	;;

  status)
	# List out settings
	/sbin/ipchains -L
	;;

  test)
	##
	## This is about as simple as it gets
	##    (This is not secure AT ALL)
	action "WARNING Test Firewall: " /bin/true
	/sbin/ipchains -F input
	/sbin/ipchains -F output
	/sbin/ipchains -F forward
	echo 1 &#62; /proc/sys/net/ipv4/ip_forward
	/sbin/ipchains -A input -j ACCEPT
	/sbin/ipchains -A output -j ACCEPT
	/sbin/ipchains -P forward DENY
	/sbin/ipchains -A forward -i $PUBLIC -j MASQ

	echo
	;;

  *)
	echo "Usage: $0 {start|stop|restart|status|test}"
	exit 1

esac</PRE
></P
></DIV
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN798"
>16. APÉNDICE B - Un guión VPN RC para RedHat</A
></H1
><P
><PRE
CLASS="PROGRAMLISTING"
>#!/bin/sh
#
# vpnd    This shell script takes care of starting and stopping
#         vpnd (Vertual Privage Network connections).
#
# chkconfig: - 96 96
# description: vpnd 
#

# Source function library.
. /etc/rc.d/init.d/functions

# Source networking configuration.
. /etc/sysconfig/network

# Check that networking is up.
[ ${NETWORKING} = "no" ] &#38;&#38; exit 0

[ -f /usr/sbin/vpnd ] || exit 0

[ -f /etc/vpnd.conf ] || exit 0

RETVAL=0

# See how we were called.
case "$1" in
  start)
        # Start daemons.
        echo -n "Starting vpnd: "
        daemon vpnd
	RETVAL=$?
 	[ $RETVAL -eq 0 ] &#38;&#38; touch /var/lock/subsys/vpnd
	echo
        ;;
  stop)
        # Stop daemons.
        echo -n "Shutting down vpnd: "
        killproc vpnd
	RETVAL=$?
	[ $RETVAL -eq 0 ] &#38;&#38; rm -f /var/lock/subsys/vpnd
        echo
        ;;
  restart)
	$0 stop
	$0 start
	;;
  *)
        echo "Usage: vpnd {start|stop|restart}"
        exit 1
esac

exit $RETVAL</PRE
></P
></DIV
><DIV
CLASS="SECT1"
><HR><H1
CLASS="SECT1"
><A
NAME="AEN802"
>17. Anexo: El INSFLUG</A
></H1
><P
>    El <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>INSFLUG</I
></SPAN
> forma parte del grupo internacional<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
> Linux
Documentation Project</I
></SPAN
>, encargándose de las traducciones al castellano
de los Howtos (Cómos), así como la producción de documentos originales
en aquellos casos en los que no existe análogo en inglés.</P
><P
>    El <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>INSFLUG</I
></SPAN
> se orienta preferentemente a la
    traducción de documentos breves, como los<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>    COMOs</I
></SPAN
> y <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>PUFs</I
></SPAN
> (Preguntas de Uso
    Frecuente o FAQ), etc.</P
><P
>Diríjase a la sede del INSFLUG para más información al respecto.</P
><P
>    En la sede del INSFLUG encontrará siempre las<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>    últimas</I
></SPAN
> versiones de las traducciones: <A
HREF="http://www.insflug.org"
TARGET="_top"
>http://www.insflug.org</A
>.
    Asegúrese de comprobar cuál es la última versión disponible en el
    Insflug antes de bajar un documento de un servidor réplica.</P
><P
>Se proporciona también una lista de los servidores réplica
    (<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>mirror</I
></SPAN
>) del Insflug más cercanos a Vd., e información relativa a
otros recursos en castellano.</P
><P
>El equipo coordinador de Insflug, 
<A
HREF="mailto:insflug@insflug.org"
TARGET="_top"
>insflug@insflug.org</A
> </P
></DIV
></DIV
></BODY
></HTML
>