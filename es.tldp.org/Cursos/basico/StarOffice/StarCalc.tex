%%%%%%%%%%%%%%%%%%%%%
% Sección: StarCalc %
%%%%%%%%%%%%%%%%%%%%%


\section{StarCalc: Hoja de Cálculo}

% La verdad que no sé que meter acá :-(

%Carlos Pérez Pérez {\\tt cperezperez@terra.es}

%*****************************************************
%                           Introducción             *
%*****************************************************

\subsection{Introducción}

Una hoja de cálculo\footnote{También denominada Planilla de Cálculo} es una
herramienta puesta al alcance del usuario para solucionar una cierta clase
de problemas. Estos problemas van desde llevar el cálculo de la contabilidad
del hogar hasta el ánalisis de datos estadísticos pasando por un sinfín de
posibilidades.
El uso de una hoja de cálculo queda supeditada a lo que el usuario quiera,
pero, hay situaciones en las que se hace imprescindible el uso de una hoja de
cálculo. Desde llevar la contabilidad de pequeñas empresas, en las que se
requieran sumar grandes cantidades de cifras que la hoja de cálculo puede
hacer automáticamente, utilizarlo para hacer regresiones estadísticas no
excesivamente complejas, llevar el control de pedidos, de ventas, de \ldots{}.
Un largo etcétera cuyo principal punto en común es el de evitar cálculos
manuales tediosos que puedan inducir a errores.
Definido el problema al que se puede enfrentar el usuario ahora queda la
elección del programa de hoja de cálculo. En el mercado hay una gran cantidad
de paquetes que incorporan hojas de cálculo. Aquí se expondrá el uso de la
StarCalc, la hoja de cálculo perteneciente al paquete ofimático StarOffice.
Pero lo aquí explicado puede ser aplicado sin esfuerzo al uso de otras hojas
de cálculo, como la Excel.
El lector debe tener en cuenta que aquí no se explican todas las opciones  y
características que incorpora StaCalc, sólo se trata de una introducción  al
uso de la misma así como una serie de prácticas en las que se tratará de
extender la parte teórica.

%**********************************************************
%                    Primeros Pasos                       *
%**********************************************************

\subsection{Primeros Pasos}

\subsubsection{Entorno de trabajo.}

El entorno de trabajo de la StarCalc se hace familiar para aquel
usuario que conozca el uso de las hojas de cálculo. Es un entorno
totalmente gráfico e intuitivo desde el principio. En el que podemos
observar una barra de menús donde se encuentran las operaciones que se
pueden hacer con la StarCalc. Debajo se hallan una serie de botones
que se usan para acceder más rápida y cómodamente a funciones y
acciones que se encuentran en los menús.\\

%<Gráfico principal>
\figura{La hoja de cálculo StarCalc}{StarCalc}

La zona de menús, allí se posicionan el menú \menu{Archivo},
\menu{Editar}, \menu{Ver}, \menu{Insertar}, \menu{Formato},
\menu{Herramientas}, \menu{Datos}, \menu{Ventana} y \menu{Ayuda}.
Dentro decada una  de ellas se agrupan las diferentes macros que la StarCalc
tiene predefinidas y que nos permiten realizar las tareas propias
de la hoja de cálculo. Ver figura \ref{fig:StarCalcMenus}.

%<Gráfico menu>
%\figura{Los menús de la StarCalc}{StarCalcMenus}

La siguiente zona está conformada por una serie de botones que permiten el
acceso  rápido a funciones definidas. Este área también se extiende a la parte
izquierda de  la pantalla, que pueden verse en las figuras
\ref{fig:StarCalcBotones} y \ref{fig:StarCalcBotoensLaterales}.

%<Gráfico botones>
\figura{Barra de botones superiores}{StarCalcBotones}
\figura{Barra de botones laterales}{StarCalcBotonesLaterales}

Luego se nos presenta la zona de trabajo, esto es, la parte destinada a la
introducción,  modificación, cálculo y presentación de datos, que puede
observarse en la figura \ref{fig:StarCalcTrabajo}.
 
%<Gráfico trabajo> 
\figura{Zona de trabajo}{StarCalcTrabajo}

La última zona está conformada por una línea en la que se presentan una serie
de datos  sobre características generales de la hoja en la que estemos
trabajando.   

%<Gráfico parte baja>
%\figura{Línea inferior}{StarCalcLinea}

%*************************************************************
%                   Creación de Nuevas Hojas                 *
%*************************************************************

\subsubsection{Creación de nuevas hojas}
Para crear una nueva hoja se puede recurrir a varias formas de hacerlo.
Por un lado se puede hacer doble click en el icono de
\comando{Nueva Hoja de Cálculo} dentro del escritorio del entorno StarOffice.
También se puede crear en el menú \comando{Archivo}, submenú \comando{Nuevo},
y elegir \comando{Hoja de cálculo}. Otra forma es utilizar las plantillas,
para ello se puede acceder al menú  \menu{Archivo}, submenú \menu{Nuevo},
y \menu{Plantillas}, o también presionar \boton{Ctrl+N}.

%Moverse por la hoja de Cálculo.
\emph{Selección de celda.}
Las celdas dentro de la hoja se pueden seleccionar bien usando el ratón 
o con el teclado. Con el ratón se presiona en la celda de inicio y, sin 
soltar, se extiende la selección moviendo el ratón hasta llegar a la celda 
final que se quiere seleccionar. Con el teclado, se posiciona con las teclas 
de dirección sobre la celda a seleccionar y se presiona la teclas \boton{Mayúsculas}. 
Sin soltar dicha tecla se seleccionan las celdas deseadas con las teclas de 
dirección.\\ 
Para seleccionar celdas que no sean contiguas se utilizará el ratón y la 
tecla \boton{Control}. Se selecciona el primer rango de celdas o una sola, y a 
continuación se seleccionan las celdas o rangos deseados sin soltar la  
tecla \boton{Control}.
Para el caso en el que la selección de celdas quede fuera de las ventanas, 
hay que hacer notar que el movimiento es automático y no se necesita 
preocuparse hasta dónde llegar. 
Las columnas y filas se pueden selccionar enteras si se presiona sobre 
el rótulo de fila o columna. 

\subsubsection{Abrir hoja desde archivo} 
%Las maneras de recuperar el trabajo (de otro o nuestro). 
Para recuperar un trabajo desde el lugar donde esté almacenado acudiremos
al menú \menu{Archivo} y \menu{Abrir} con lo que aparecerá el cuadro de
opciones para recuperar el archivo, como se aprecia en la figura
\ref{fig:StarCalcAbrir}.

\figura{Recuperar archivo}{StarCalcAbrir}

Se puede acceder al cuadro de diálogo de abrir archivo presionando
\boton{Ctrl+O}.

%*****************************************************************
%                   Introducción de datos                        *
%*****************************************************************

\subsubsection{Introducción de datos.} 
 
%Manera adecuada de poner los datos en las celdas :) 
 
Se aceptan dos grandes tipos: constantes y fórmulas. 
Las constantes se dividen en: valores numéricos, de texto y de fecha y hora.
Para los valores numéricos y de texto se aceptan: 
Números del 0 al 9 y ciertos carácteres especiales, tales como +-E e () . , 
\$ \% y /. Las restantes entradas se considerarán de texto. Si se quiere 
utilizar un valor numérico como texto se antepondrá el signo ' y luego se 
introduce el valor. 

Para introducir datos nos situaremos en la celda adecuada presionando 
en ella y escribiremos aquello que queramos. 
 
StarCalc puede ayudarnos a introducir datos, por ejemplo, en series de 
números podemos poner el primer número y seleccionar la celda. En la parte
inferior derecha hay un punto negro, al seleccionarlo el puntero del ratón se 
convierte en una cruz, arrastrándolo hacia donde queramos poner los datos se
extenderá la selección y la StarCalc sumará automáticamente los siguientes datos.
En el caso de que los número no sean correlativos se pueden poner los dos
primeros números de la serie y la StarCalc hará el resto. 

Se puede hacer lo mismo con los nombres de los meses, si se introduce enero, y
siguiendo el procedimiento anterior se conseguirá que vaya escribiendo todos
los meses. 
La StarCalc muestra un rótulo al lado del puntero del ratón, de esta manera
sabremos hasta dónde llegar sin tener que hacer cálculos mentales.

\emph{Protección de datos.} Se pueden proteger libros enteros u hojas
individuales, de manera que  se permita acceso de sólo lectura o sin acceso. A
través del menú  \menu{Herramientas} y \menu{Proteger}. 
También se pueden proteger y desproteger celdas individuales. 
 
%*************************************************************************
%                            Construcción de Fórmulas                    *
%*************************************************************************

\subsubsection{Construcción de fórmulas.}
 
Creación de fórmulas para la transformación de los datos.\\ 
 
Se selecciona una celda vacía y se introduce el signo igual precedido de 
la expresión aritmética a utilizar. Por ejemplo, para sumar 3 y 6 pondremos:\\ 
\[=3+6\]
 
\emph{Precedencia de los operadores:}
\begin{itemize} 
\item Se procesan primero las expresiones entre paréntesis. 
\item Se ejecutan la multiplicación y la división antes de la suma y la resta. 
\item Los operadores del mismo nivel se calculan de izquierda a derecha. 
\end{itemize}

\emph{Los paréntesis.} 
Hay que incluir un paréntesis cerrado por cada uno que
se abra.\\
\emph{Referencias a las celdas.}
Dentro de una fórmula nos podemos referir a una celda de diferentes maneras. 
Escribiendo A1 haremos referencia a la celda de la fila 1 columna A, que
también puede ser seleccionada con el ratón. 
En este punto hay que diferenciar el tipo de referencia que se va a utilizar.\\ 
\emph{Referencias relativas.}
Se refieren a las celdas por sus posiciones en relacción a la celda que
contiene la fórmula. De esta manera la celda A1 se convertirá en B2 si
la fórmula se mueve una fila hacia debajo y una columna hacia la derecha.\\ 
\emph{Referencias absolutas.} 
Se identifica a la celda por su posición fija, la fórmula hará referencia 
siempre a la misma celda aunque se mueva la fórmula. La manera de hacer esto 
es utilizando el signo \$. Esto es, \$A\$1 hace referencia a la fila 1
columna A  en todo momento. A\$1 hará referncia a la fila 1 simpre y a la
columna se calculará  de forma relativa a la fórmula. El caso contrario
sería \$A que mantendría fija  la columna.  Nótese que se puede hacer
referencia a cualquier celda dentro del libro de  trabajo.\\
 
%<Ver si se puede en otros libros>. 

\emph{Uso de funciones.}
Las funciones tal y como las hemos visto pude que no tengan demasiado sentido 
si se trata, por ejemplo, de sumar una gran cantidad de celdas:\\
\[=A1+A2+A3+A4+A5+A6+A7+A8+A9+A10+A11+A12\]
por eso se puede utilizar la sintaxis que provee la StarCalc\\
\[=SUMA(A1:A12)\]
 
Se puede utilizar cualquier función definida dentro de la StarCalc pasándole
los parámetros adecuados. Sin embargo, no se pueden conocer o retener todas 
las funciones que tiene la hoja, por eso se puede utilizar insertar función 
que presentará un cuadro con las distintas funciones existentes, una pequeña 
explicación y los parámetros que se necesitan. 

%****************************************************************
%                        Formateo de la Hoja                    *
%****************************************************************

\subsubsection{Formateo de la hoja.} 
%Utilización de los formatos de datos correctos y adecuados.
Para poner el formato correcto de los datos podemos seleccionar
las celdas a formatear y acudir al menú \menu{Formato} \menu{Celda...}
y se nos presentará un cuadro con las diferentes opciones a
configurar, desde el tipo de cuadro hasta el idioma, la fuente, el
color, la justificación o la orientación de la escritura. Al finalizar
la configuración presionamos \boton{Aceptar}.

%****************************************************************
%                     Impresión y Presentación			*
%****************************************************************

\subsubsection{Impresión y presentación.}
%Imprimir documentos y presentación en pantalla
%(eso de los colores y las líneas).
El uso de la impresión dentro de la StarCalc sigue el mismo esquema que en el
resto de la suite StarOffice. Seleccionaremos el menú \menu{Archivo} e
\menu{Imprimir}, también podemos presionar las teclas \boton{Ctrl+P}. En
ambos casos se mostrará un cuadro de diálogo. En el caso de que no necesitemos
ajustar las propiedades presionaremos \boton{Aceptar} y StarCalc mandará el
trabajo a la cola de impresión.
 
%****************************************************************
%                        Salvando nuestro esfuerzo              *
%****************************************************************

\subsubsection{Salvando nuestro esfuerzo.} 
%Formas de grabar en un archivo lo que hayamos hecho. 
Para guardar los datos con los que estamos trabajando acudiremos a
\menu{Archivo} y \menu{Guardar} o \menu{Guardar como} si
queremos guardarlo bajo otro nombre. En el caso de que el archivo
sea nuevo se nos presentará el diálogo de guardar como para indicar
a la StarCalc bajo que nombre y tipo de archivo deseamos que sea
salvado nuestro trabajo.

%***************************************************************
%                     Análisis de Datos                        *
%***************************************************************

\subsection{Análisis de Datos}
%Análisis de datos. 
%Funciones Comunes. 
 
\subsubsection{Funciones comunes.} 
%Las funciones que ofrece la StarCalc 
Sintaxis de las funciones: Las funciones presentas dos partes
diferenciadas, por un lado, el nombre de la función, por el otro, sus
argumentos. Los argumentos de una función deben estar entre paréntesis
inmediatamente después del nombre de la función y su cantidad
dependerá del tipo de función que se use. También hay que destacar el
hecho que dentro de los argumentos se pueden incluir tanto otras
funciones, con sus propios argumentos, como valores numéricos, valores
de texto o valores lógicos, así como matrices y valores de error. La
forma más sencilla de insertar funciones es usándo el autopiloto de
funciones que se encuentra en el menú \menu{Insertar}, \menu{Función},
o presionando las teclas \boton{Ctrl+F2} o usando el botón que se
encuentra en las barras de botones, dónde se introducen las fórmulas.
Aquí no se van a exponer todas las funciones que existen e la
StarCalc, para ver todas las funciones que la hoja puede ofrecer puede
consultar el Autopiloto de Funciones, allí las encontrará agrupadas
según el uso que se les quiera dar. Ver figura \ref{fig:StarCalcFucniones}.

\figura{Autopiloto de funciones.}{StarCalcFunciones}

\subsubsection{Fechas y horas.} 
%Manipulación de fechas para presentación y utilización en cálculos. 
Las fechas se introducen directamente en las celdas siguiendo alguno
de los siguientes formatos que son perfectamente legibles por
StarCalc: d/mm/aa; d-mmm-aa, d--mmm o mmm-aa. Para conseguir 5 de
Noviembre el año 2000, teclearemos \comando{5-nov-2000} y se nos
mostrará tal cual la hemos introducido. En aquellos formatos en los
que se omita alguna parte de la fecha se tratarán de distinta manera,
así si falta el día se introduce automáticamente el día primero, si es
el año se introduce el año en curso.  Nótese que no puede faltar el
mes en los formatos presentados. Para introducir series de fechas
utilizaremos lo aprendido en la sección de introducción de datos, esto
es, podemos extender la selección automáticamente con el ratón.  Para
la introducción de horas se pueden seguir los siguientes formatos:
h:mm AM/PM; h:mm;ss AM/PM; h:mm; h:mm:ss; mm:ss.0; [h]:mm:ss. El
lector interesado puede mirar el Autopiloto de funciones donde se
encuentran algunas funciones para utilizar y transformar fechas.
 
\subsubsection{Análisis financiero.} 
%Cálculo de TAE, VAN, TIR, rentabilidades, intereses, etc. 
En una hoja de cálculo no podían faltar las funciones referidas a
operaciones financieras, tales como el valor actual neto o la tasa
interna de retorno.  Estas funciones son muy utilizadas en entornos
empresariales y para el usuario doméstico que de esta forma puede
calcular el rendimiento de sus ahorros o si la inversión en la compra
de una casa es factible. En esta sección también se debe hacer
referencia a las funciones de depreciación, cálculo de la tasa de
retorno y análisis de valores bursátiles.  En este último caso,
desarrollaremos un método de análisis de acciones y opciones en la
parte teórica que no hace uso de las funciones que propone la
StarCalc.
 
\subsubsection{Análisis estadístico.} 
%Cálculos de medias, modas, varianzas, regresiones, etc. 
StarCalc utiliza funciones estadísticas predefinidas con las que puede
calcular multitud de aspectos sobre poblaciones. Así tenemos funciones
como media, modas, medianas, rango, histogramas, frecuencias
covarianzas, coeficiente de correalción, desviación típica,
distribuciones estándar, binomial, exponencial, normal, ji, poisson,
regresiones lineales, entre otras. Cuya utilización será de utilidad
para aquellas personas que requieran el uso de cálculos estadísticos.
 
%*********************************************************************
%                              Gráficos                              *
%*********************************************************************

\subsection{Gráficos} 
%Creación de gráficos para la mejor comprensión de los datos. 
%Gráficos.
\label{Starcalc-graficos}

Como dice el refrán, más vale una imagen que mil palabras. Por eso la
StarCalc provee una serie de herramientas que permiten convertir los
datos en gráficos para una mejor comprensión.

Creación de un nuevo gráfico. Lo primero es seleccionar los datos que
se desean representar para luego ir a \menu{Diagrama} en el menú
\menu{Insertar}. Se nos mostrará un cuadro pidiendo los datos, estos
serán los que hemos seleccionado o cualquier rango que podemos
ingresar manualmente.  En este punto podremos seleccionar si queremos
nuestro gráfico en la misma hoja o en una nueva hoja. Presionaremos
\boton{Avanzar} y se nos mostrará el cuadro de diálogo para
seleccionar el tipo de gráfico que vamos a utilizar.

\figura{Selección del tipo de gráfico}{StarCalcDiagramaSeleccion}
 
Una vez seleccionado el tipo de gráfico y la variante que vayamos a utilizar,
se nos presenta un cuadro en el que podremos introducir los títulos que van
a acompañar el gráfico. 

\figura{Titulos del gráfico}{StarCalcDiagramaTitulos}

Tras lo cual seleccionaremos \boton{Crear} y se nos presentará el gráfico
dentro de la hoja activa,  o en una hoja nueva si es lo que hemos seleccionado
previamente.  Podremos trabajar directamente sobre el gráfico utilizando el
botón derecho del ratón o el menú  de formato que nos permitirá personalizar
el gráfico. 

\emph{Personalización de gráficos.}
Presionando con el botón derecho elegiremos la opción del menú
\menu{Editar}. De esta manera  activaremos el gráfico y podremos utilizar
las funciones de personalización sobre  aquellas zonas del gráfico que
deseemos cambiar. Para ello seleccionaremos la parte  del gráfico a cambiar y
seleccionaremos la opción \menu{Propiedades del Objeto} que se nos  muestra
con el botón derecho del ratón o dentro del menú \menu{Formato}.  Ha de
hacerce notar que se pueden utilizar la hilera de botones verticales que se
encuentran  en la parte izquierda de la pantalla y que nos permiten acceder a
opciones del gráfico  de forma más rápida.

\figura{Personalización de gráficos}{StarCalcDiagramaGraficoCambioPropiedades}
\ref{fig:StarCalcDiagramaGraficoCambioPropiedades}
%***********************************************************************
%              Gestión de bases de datos y listas                      *
%***********************************************************************

\subsection{Gestión de bases de datos y listas} 
%Utilizar la StarBase para usar con la StarCalc. Utilización de las 
%listas. 
La utilización de listas es muy común en las hojas de cálculo (clientes, teléfonos,
etc.). Las lista deben cumplir una serie de características para que su utilización
sea lo más efectiva posible.

\begin{itemize}
\item Cada columna debe contener el mismo tipo de información.
\item La primera fila deben ser rótulos de descripción del contenido.
\item No debería haber columnas o filas en blanco en la lista.
\item Para el uso de filtros no debería haber otra información en las filas que
ocupe la misma.
\end{itemize}

%Gestión de bases de datos y listas.
%Utilizar la StarBase para usar con la StarCalc. Utilización de las
%listas.

La utilización de listas es muy común en las hojas de cálculo (clientes,
teléfonos, etc.). Las lista deben cumplir una serie de características para
que su utilización sea lo más efectiva posible.

\begin{itemize}
\item Cada columna debe contener el mismo tipo de información.
\item La primera fila deben ser rótulos de descripción del contenido.
\item No debería haber columnas o filas en blanco en la lista.
\item Para el uso de filtros no debería haber otra información en las filas
que ocupe la misma.
\end{itemize}

Para crear una lista a partir de los datos de una hoja vamos al
\menu{Piloto de Datos} en el menú de \menu{Datos}.  Se nos mostrará el
cuadro de seleccionar fuente.

%<Gráfico>

Presionando aceptar se nos mostrará  el cuadro de Pilot de Datos
donde colocaremos por el método arrastar y soltar los datos que  queramos que
se muestren. En el botón de \boton{Opciones} podremos acceder a una serie de
características  para afinar aún más la lista.\\

\emph{Ordenación de listas.}
Para ordenar listas sólo tenemos que seleccionar el área a ordenar y elegir
\menu{Ordenar} dentro del menú  de \menu{Datos} e indicar el método de
ordenación y la columna por la que se ordenará, entre otras opciones  de
personalización. Se debe tener en cuenta que hemos de seleccionar la opción de
Área contiene  encabezamientos de columna para que no ordene los encabezados
junto con los datos. Para esto  seleccionaremos la solapa de Opciones dentro
del cuadro \boton{Ordenar} y marcaremos la opción \boton{Área} contiene 
encabezamientos de columna, a continuación aceptaremos y se creará la lista.   

\emph{Filtrado de listas.}
Con el uso de filtros dentro de las listas conseguiremos analizar aquellos datos
que interesan. Por eso, al crear la lista se añade un botón denominado
\boton{Filtro} que permite definir los  datos que se van a mostrar dependiendo
de aquellos datos que se busquen.   
\emph{Bases de datos.}
StarCalc puede trabajar conjuntamente con bases de datos profesionales. Se
pueden importar tablas desde bases de datos que StarOffice tenga registradas para trabajar
directamente con listas. En la versión 5.2 de StarOffice se instala por defecto el soporte
para Adabas siempre y cuando dicha base de datos se encuentre en el sistema.
El uso de bases de datos tiene su tratamiento en la sección de StarBase. 
 
%*************************************************************************
%                            Tablas dinámicas                            *
%*************************************************************************

\subsection{Tablas dinámicas} 
%Creación de tablas dinámicas para que el cálculo de datos 
%se automático. 
Es un tipo especial de tabla que resume la información de ciertos campos de
una lista o base de datos. 
Las tablas dinámicas están vinculadas a los datos de los que proceden. Cuando
dichos datos cambian, la tabla no se recalcula automáticamente, pero se puede
actualizar en cualquier momento.\\
La creación de tablas dinámicas en StarCalc sigue el mismo procedimiento que
el apartado anterior. Pero, esta vez, en lugar de seleccionar los datos en
la hoja, utilizaremos fuentes externas. Activamos el \menu{Piloto de Datos}
en el menú \menu{Datos}. Seleccionamos \menu{Fuente de datos registrada
en StarOffice}\footnote{En nuestro caso no podemos usar la Fuente
externa/interfaz porque no tenemos registrada ninguna base de datos.}
y presionamos \boton{Aceptar}. Seleccionaremos aquellas fuentes que deseemos
utilizar y persionaremos \boton{Aceptar}. Los siguientes pasos son los del
apartado anterior que el lector ya conoce.
%*************************************************************************
%                           Macros y StarBasic                           *
%*************************************************************************
\subsection{Macros y Starbasic}  
%Creación de Macros y utilización del lenguaje de macros StarBasic.  
%Esto se hará de forma bastante esquemática. :-(   

Una macro es un conjunto de intrucciones que se ejecutan en conjunto y que
permiten hacer tareas repetitivas y complejas.
Para crear una macro dentro de StarBasic tenemos que acceder a
\menu{Herramientas} y \menu{Macro...} se nos mostrá el cuadro Macro de la
figura \ref{fig:StarCalcMacro}.

\figura{Cuadro de Macro}{StarCalcMacro}

Lo primero será introducir el nombre de la macro a grabar y luego presionamos
\boton{Grabar}. Mientras estemos grabando la macro se almacenará cualquier
acción que ejecutemos, tanto con el ratón como a través del teclado. Para
finalizar presionaremos en el cuadro detener macro que se ve en la figura
\ref{fig:StarCalcMacroStop}

\figura{Parar grabación de la macro.}{StarCalcMacroStop}

Una vez grabada la macro podremos depurarla para ajustar algunos parámetros
o para borrar aquellas partes en las que nos hayamos equivocado o queramos
modificar.
Las macros y sus modificaciones se hace utilizando el lenguaje que tiene
la StarCalc y que se denomina StarBasic. Es un lenguaje muy intuitivo y
que se parace al Visual Basic para Aplicaciones de la Excel.Figura
\ref{fig:StarCalcBasic}.

\figura{Entorno de StarBasic}{StarCalcBasic}

Cuando la se tenga la macro finalizada, se puede asignar dicha a macro a una
tecla o combinación de teclas. Para esto se accede al menú \menu{Herramientas},
\menu{Macro}. Dentro del cuadro de Macro presionaremos sobre
\boton{Asignar...} y seleccionaremos la combinación de teclas que quereamos
utilizar para activar la macro creada.
%**************************************************************************
%                         PARTE DE PRÁCTICAS                              *
%**************************************************************************

\subsection{De prácticas} 
En estas prácticas se pretenden enseñar rudimentos de la utilización 
de hojas de cálculo. Así como técnicas que no se enseñan en la parte 
teórica. 
Se presentan de menor a mayor dificultad. Exceptuando las dos últimas 
que son casos aparte.
 
\subsubsection{Control de ingresos y gastos.} 
Objetivo. Llevar la contabilidad doméstica. 
Don Rufino Pensante no sabía por dónde se le escapa el dinero que 
ganaba con su trabajo en una tienda de caramelos así que decidió 
montar un sistema de contabilidad doméstica para llevar un orden y
control de todo el dinero que pasaba por sus manos.\\

\begin{tabular}{|l|r|r|r|r|r|}
\hline
Mes & Enero & Febrero & Marzo & Abril & Mayo\\
Sueldo & 145.000 & 145.000 & 145.000 & 145.000 & 145.000\\
Vivienda & 30.000 & 31.000 & 30.000 & 29.000 & 32.000\\
Comida & 40.000 & 43.000 & 46.000 & 39.000 & 41.000\\
Coche & 15.000 & 6.000 & 16.000 & 8.000 & 9.000\\
Agua & 7.000 & 8.000 & 6.000 & 4.000 & 9.000\\
Luz & 11.000 & 10.000 & 12.000 & 9.000 & 10.500\\
Varios & 10.000 & 18.000 & 11.000 & 8.000 & 11.000\\
\hline
\end{tabular}
\\
Lo primero de todo es diseñar la hoja para no tener que estar más
tarde rediseñando todo el trabajo.  Vemos de que información
disponemos y lo que queremos conseguir. Esto es, tenemos series de
datos correspondientes a ingresos y gastos y queremos ver el saldo al
final de cada periodo. Lo más lógico es pensar en tener una periocidad
mensual aunque no se descarta que sea semanal para aquellas personas,
que, por ejemplo, tengan una nómina semanal.

El siguiente paso lógico es crear un libro nuevo con la StarCalc. Para
eso nos iremos a \menu{Archivo}, \menu{Nuevo}, \menu{Hoja de Cálculo}.
Pondremos los títulos de los encabezados para cada una de las columnas,
empezando en A1, insertaremos {\tt Descripción}. Para los rótulos de las
fechas introducimos la primera fecha y utilizaremos seleccionar y arrastrar
para que StarCalc complete el resto de las cabeceras.
Luego pondremos en la columna A todas las descripciones de los gastos e
ingresos, y debajo de cada fecha las cantidades correspondientes. Para seguir
con la claridad, insertaremos {\tt Gastos} para tener todos los gastos
agrupados e {\tt Ingresos} para los ingresos. De esta manera desglosaremos
los gastos e ingresos y sólo nos restaría añadir una línea para el cálculo del
saldo.

%Gráfico tabla completa.
\figura{Tabla de datos}{StarCalcPracticas-1-1}

Luego procedemos a retocar la estética para resaltar aquellos datos que nos
interesen, tal como los Ingresos, los Gastos y el Saldo. En este punto cada
cual puede poner su sello personal. Como guía, resaltaremos los rótulos en
negrita y las cuentas de Ingresos, Gastos y Saldo con una letra mayor, negrita
y usándo bordes.

Para el cálculo de los totales usaremos la función \comando{SUMA}, para lo que
elgiremos la columna correspondiente a enero y la fila que corresponde a
Gastos e introduciremos \comando{=suma(}. En este punto tendremos dos
opciones: ingresar manualmente el rango de celdas o seleccinarlas con el
ratón, en ambos casos hay que terminar cerrándo el paréntesis
\footnote{StarCalc es capaz de cerrar el mismo el paréntesis en el caso de no
escribirlo.}.

Para calcular el resto de meses, se procederá a copiar la fórmula anterior en
el resto de celdas de la fila correspondientes a los siguientes
meses\footnote{Una manera rápida de hacerlo es seleccionado la celda a copiar
y utilizando las macros. Esto es, \boton{Ctrl+C} para copiar, seleccionar el
resto de celdas y \boton{Ctrl+V} para pegar en todas las celdas a la vez}. La
StarCalc corregirá la fórmula para que coincida con los datos de cada uno de
los meses.

Hasta el momento tenemos los saldos de todas las cuentas de nuestro ejemplo.
Pero queremos que nuestros datos nos faciliten una mayor cantidad de
información. Podemos tener muchas cosas en mente, pero para esta primera
práctica vamos a ver máximos, mínimos, promedios y porcentajes.

Comenzaremos con los máximos y mínimos. Nos situaremos en la barra de rótulos
ingresaremos \comando{Máximo} en N2, \comando{Mínimo} en O2 y\comando{Promedio}
en P2, después de los meses. En la columna de Máximos utilizaremos la fórmula
\comando{MÁX()}, con la tilde incluida porque en otro caso no será reconocida.
Para el mínimo utilizaremos \comando{MÍN()}. La secuencia a ingresar sería: en
N3 \comando{=máx(b3:m3)} y en O3 \comando{mín(b3:m3}. En el caso de los
promedios, nos situaremos en P3 y teclearemos \comando{promedio( b3:m3)}.
Luego sólo nos quedará copiar las tres celdas construidas, en cada una de las
celdas correspondientes a las distintas cuentas.

La salida de los porcentajes se pueden hacer en una hoja distinta o en la misma
hoja. Nosotros lo haremos en la misma hoja, aunque lo que aquí se explique se
puede aplicar a otras hojas.\\
Primero hemos de construir los encabezados y las descripciones, esto es, los
meses y las cuentas. Para ello usaremos un truco que nos permitirá ahorrar
tiempo en el caso de que cambie alguno de los rótulos. Nos situaremos en A15
e introducimos \comando{=A2} y copiamos esta celda hasta M15 y luego repetimos
desde A3 hasta A25.\\
En la celda C16\footnote{No habrá salida para enero porque no tenemos datos
del mes anterior} introducimos \comando{=(c3-b3)/b3} y lo copiamos en el resto
de celdas. No se preocupe de la salida \comando{Err:503}, se produce porque no
hay datos correspondientes a esos meses. Para que los datos sean en porcentaje
tenemos que dar formato a las celdas. Seleccionaremos tadas las celdas que
contengan número, incluso las que contengan errores, y accederemos a
\menu{Formato}, \menu{Celda} y presionaremos las pestaña \boton{Números} si no
se encuentra activada, seleccionaremos \comando{Porcentaje} en Categoría.
Presionaremos \boton{Aceptar} y tendremos la salida con porcentajes.\\
De esta manera hemos obtenido las variaciones porcentuales. Pero, ¿no sería
interesante ver el porcentaje del total que significa cada cuenta?
Repetimos el paso anterior para copiar las etiquetas correspondientes a los
meses y a las cuentas, empezando en A28. Y añadimos en B30 \comando{=
b3/b\$9}, esta fórmula sólo se copiará hasta la cuenta Gastos, que tendrá una
salida del 100\%. En B35 introducimos \comando{=b10/b\$11} y lo copiamos en
todas las cuentas de Ingresos. Luego seleccionamos la columna de enero y la
pegamos en el resto de meses. De esta manera obtenemos el peso de cada una
de las cuentas en los distintos meses.

Por último, sólo nos queda añadir a las tablas efectos de resalte para destacar
aquellos datos que nos interese tener mejor visualizados. También puede
añadirse a la práctica una tabla de datos en la que se muestren los datos
acumulados \footnote{la fórmula a usar para la salida sería \comando{=b3} para
el primer mes y \comando{=b40+c3} y copiar para el resto de celdas esta última.
Nótese que b40 hace referencia a la primera cuenta del mes de febrero y que
podría ser otra en su ejemplo.} de mes a mes y, de esta manera, llevar un
control de los gastos e ingresos que llevamos para todo el año.

\subsubsection{Productos de financiación.}
Objetivo. Calcular las mensualidades del pago de un préstamo o el
rendimiento de los ahorros.

\subsubsection{Análisis de proyectos de inversión.}
Objetivo. Ayuda a la toma de decisiones en inversiones.

\subsubsection{Seguimiento de Acciones y opciones.}
Objetivo. Ver la evolución de los títulos de acciones y opciones que
tengamos. Modelo Black-Scholes.
Hoy en día no es extraño que una persona particular posea una pequeña cantidad
de acciones o de opciones. En esta práctica intentaremos hacer el seguimiento
de las rentabilidades de dichos títulos tratándo de anticipar posibles
cambios que nos indiquen pautas de compra o venta y así evitar riesgos. Aquí
haremos referencia al parqué de la bolsa madrileña por ser la que más
conicimientos poseeo. Para aquellas personas que conozcan la temática no
hace falta que se expliquen los conceptos. Para aquellos que no conozcan
los términos, el objetivo de la práctica son los conceptos de hoja de cálculo
y no los de economía financiera.

Para hacer el trabajo más fácil de hacer y de presentar se hará uso de
de cuatro hojas diferentes: una para las acciones, otra para las opciones,
otra para los cálculos de acciones y opciones y una cuarta para la salida
de gráficos.

El primer paso es crear un libro nuevo de StarCalc para lo que usaremos
el menú \menu{Archivo}, \menu{Nuevo} y \menu{Hoja de cálculo}. Una vez
creado el libro, comezaremos con la parte de acciones que es la más
fácil pues sólo se trata de controlar lo cotización diaria de los títulos.

La fórmula de Black-Scholes:

\begin{displaymath}
C(K,S,T-t,r,\sigma)=S·N(d_{1})-K·e^{-r(T-t)}·N(d_{2})
\end{displaymath}


\subsubsection{Análisis de tendencia.}
Objetivo. Calcular las previsiones para años futuros dada una serie de
datos con un modelo sencillo.

Los datos a utilizar son los siguientes y que se presentan de esta
manera por economía de espacio.

%****************************************************************
%                          CORREGIR
% La tabla se sale de los límites de la página.
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline
t & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12\\
X\(_t\) & 99,93 & 103 & 103,41 & 112,79 & 109,52 & 113,57 & 110,5 & 120,42 &
118,23& 119 & 118,75 & 127,32\\
t & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23 & 24\\
Xt & 124,93 & 128,13 & 127,55 & 137,06 & 131,95 & 133,91 & 135,35 &
146,19 & 138,57 & 143,14 & 144,64 & 153,72\\
\hline
\end{tabular}
%******************************************************************

Se va a indicar la manera de hacer esta práctica paso a paso, por lo
que no será necesario el conocimiento previo ni de análisis de series
de datos ni del uso de la hoja de cálculo \footnote{El lector que haya
seguido este curso puede tratar de personalizar cada uno de los pasos,
o saltar aquellos que considere que no hacen falta.}\\
\begin{itemize}

\item El primer paso sería introducir los datos de la tabla anterior en una
columna que denominaremos \emph{X}.

\item Segundo paso, representar la serie X en el tiempo. Para eso seleccionamos
los datos de la columna X, y vamos a \menu{Insertar} \menu{Diagrama}. Seguiremos
los pasos de la sección \emph{Gráficos} en la página \pageref{Starcalc-graficos}.
\item Supongamos:

%****************************************************************************
%                                ERROR
%Los entornos matemáticos me dan errores pero se presentan bien en pantalla :-?
\[X_{t}=T_{t}+S_{t}+I_{t}\]
\[T_{t}=100+2_{t}\]
%\begin{displaymath}
%S_{t}=
%\left\{
%\begin{array}{cc}
%-1, & t=1,5,9,\ldots\\
%-1, & t=2,6,10,\ldots\\
%-2, & t=3,7,11,\ldots\\
%4,  & t=4,8,12,\ldots
%\end{array}
%\end{displaymath}
%*****************************************************************************

\item Obtener el componente tendencial, \(T_{t}\).\\
En la celda B1, ponemos \comando{t} introducimos \comando{1}, en B3 escribimos
\comando{=1+b2}. Copiamos la celda B3 desde B4 hasta B25. En la celda C1 escribimos
Tt. En C2, \comando{=100+2*b2} \footnote{Este es el valor para t=1}. Y copiamos
C2 desde C3 hasta C25.

\item Componente estacional, \(S_{t}\).\\
Definimos las variables cualitativas:

%****************************************************************************
%                                ERROR
%\begin{displaymath}
%D_{k,t}=
%\begin{array}{cc}
%1, & t \in \text{estación} k
%0, & \text{en otro caso}
%\end{array}
%;k=1,2,3,4.
%\end{displaymath}

%Luego:
%\begin{displaymath}
%S_{t}=-1D_{1,t}-1D_{2,t}-2D{3,t}+4D{4,t}
%\end{displaymath}
%****************************************************************************

\item Obteniendo las variables cualitativas estacionales.\\
En D1 escribimos \comando{d1}, en D2 ponemos \comando{1}, en las celdas D3, D4, D5 se
escribe \comando{0}. En E1, \comando{d2}, para E2, escribimos \comando{1}, y en E2, E4 y
E5, \comando{0}. Para F1, \comando{d3}, \comando{1} en F4, \comando{0} para F2, F3 y F5.
En G1 ponemos \comando{d4}, em G2, G3, G4 \comando{0}, para G5 \comando{1}.
Se seleccionan las celdas D2 hasta G5 y se copian desde D6 hasta G25.\\
En la celda H1 escribimos \comando{St}, y en H2 \comando{=-1*d2-1*e2-2*f2+4*g2},
copiaremos esta casilla desde H3 hasta H25.

\item Componente irregular, \(I_{t}\).
En la celda I1 se escribe \comando{It}. En la celda I2 \comando{=a2-c2-h2}. Copiaremos
I2 desde I3 hasta I25.\\
Calculamos el valor medio de la serie: en I26 insertamos \comando{=suma(i2:125)/24}.

\item El último paso que faltaría es representar gráficamente las series \(T_{t}\),
\(S_{t}\) e \(I_{t}\) frente al tiempo.

\end{itemize}


Para finalizar, lo más aconsejable es guardar los datos con \menu{Archivo} y
\menu{Guardar}.


%*********************************************************************
%                                 El final                           *
%*********************************************************************

%\subsection{Bibliografía}
%De donde he sacado todo lo de arriba.

%\subsection{Agradecimientos}
%Lo que proceda. Aunque no sé si corresponde aquí.
