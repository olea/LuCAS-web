<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><head><title>
Manual de Allegro: 33 Detalles específicos del DOS
</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css">
<!--
A.xref:link    {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:visited {color: blue; text-decoration: none; background: rgb(255, 204, 50);}
A.xref:hover   {color: blue; text-decoration: underline; background: rgb(255, 224, 150);}
A.xref:active  {color: red; text-decoration: none; background: rgb(255, 204, 50);}
blockquote.xref {border: medium solid rgb(255, 204, 51); color: black; background: rgb(255, 204, 50);}
blockquote.code {border: medium solid rgb(255, 204, 50); color: black; background: rgb(255, 255, 155);}
blockquote.text {border: medium solid rgb(175, 235, 255); color: black; background: rgb(210, 244, 255);}
-->
</style>
</head><body bgcolor=white text=black link="#0000ee" alink="#ff0000" vlink="#551a8b">
<h1><a name="33 Detalles específicos del DOS">33 Detalles específicos del DOS</a></h1>

<ul>
<li><a href="#DIGI_*/DOS">DIGI_*/DOS</a>
<li><a href="#GFX_*/DOS">GFX_*/DOS</a>
<li><a href="#i_love_bill">i_love_bill</a>
<li><a href="#JOY_TYPE_*/DOS">JOY_TYPE_*/DOS</a>
<li><a href="#MIDI_*/DOS">MIDI_*/DOS</a>
<li><a href="#split_modex_screen">split_modex_screen</a>
</ul>

<p><br>
<b>Drivers: <a name="JOY_TYPE_*/DOS">JOY_TYPE_*/DOS</a></b><br>
   La biblioteca para DOS soporta los siguientes tipos de parámetros para
   la función install_joystick():
<ul><li>
   JOY_TYPE_AUTODETECT<br>
      Intenta detectar el joystick instalado. En realidad es imposible
      distinguir entre todas las posibles configuraciones, por lo que
      esta rutina sólo puede elegir el controlador de joystick estándar,
      Sidewider, GamePad Pro, o GrIP, pero usará información del fichero
      de configuración si éste existe (el fichero puede ser creado usando
      la utilidad setup o llamando a la función save_joystick_data()), por
      lo que siempre puede usar JOY_TYPE_AUTODETECT en su código y elegir
      el tipo de hardware exacto desde el programa setup.
<li>
   JOY_TYPE_NONE<br>
      Controlador vacío para máquinas sin joystick.
<li>
   JOY_TYPE_STANDARD<br>
      Un joystick normal de dos botones.
<li>
   JOY_TYPE_2PADS<br>
      Modo de joystick dual (dos joysticks, cada uno con dos botones).
<li>
   JOY_TYPE_4BUTTON<br>
      Activa los botones extras de un joystick de 4 botones.
<li>
   JOY_TYPE_6BUTTON<br>
      Activa los botones extras de un joystick de 6 botones.
<li>
   JOY_TYPE_8BUTTON<br>
      Activa los botones extras de un joystick de 8 botones.
<li>
   JOY_TYPE_FSPRO<br>
      Joystick CH Flightstick Pro o compatible, que tiene cuatro botones,
      un mando de gases analógico, y un sombrero de 4 direcciones.
<li>
   JOY_TYPE_WINGEX<br>
      Un Logitech Wingman Extreme, que debería funcionar con cualquier
      joystick compatible Thrustmaster Mk.I. Tiene soporte para cuatro
      botones y un sombrero. Esto también funciona con el Wingman Warrior,
      si conecta el conector de 15 pins (¡recuerde desconectar el conector
      de 9 pins!) y si ajusta el pequeño interruptor de adelante a la
      posición "H" (sin embargo, no podrá usar el mando de gases o el
      'spinner').
<li>
   JOY_TYPE_SIDEWINDER<br>
      El pad digital Microsoft Sidewinder (soporta hasta cuatro mandos,
      cada uno con diez botones y un control digital de dirección).
<li>
   JOY_TYPE_SIDEWINDER_AG<br>
      Versión alternativa de JOY_TYPE_SIDEWINDER. Pruebe con esto si su
      Sidewinder no es reconocido con JOY_TYPE_SIDEWINDER.
<li>
   JOY_TYPE_GAMEPAD_PRO<br>
      El Gravis GamePad Pro (soporta dos mandos, cada uno con diez botones y
      un control digital de dirección).
<li>
   JOY_TYPE_GRIP<br>
      Controlador GrIP de Gravis, usando el fichero de controlador grip.gll.
<li>
   JOY_TYPE_GRIP4<br>
      Versión del controlador GrIP de Gravis que está restringido a moverse
      sólamente a lo largo de los cuatro ejes principales.
<li>
   JOY_TYPE_SNESPAD_LPT1<br>
   JOY_TYPE_SNESPAD_LPT2<br>
   JOY_TYPE_SNESPAD_LPT3<br>
      Pads SNES conectados a los puertos LPT1, LPT2, y LPT3 respectivamente.
<li>
   JOY_TYPE_PSXPAD_LPT1<br>
   JOY_TYPE_PSXPAD_LPT2<br>
   JOY_TYPE_PSXPAD_LPT3<br>
      Pads PSX conectados a los puertos LPT1, LPT2, y LPT3 respectivamente.
      Mire <a href="http://www.ziplabel.com/dpadpro/index.html">http://www.ziplabel.com/dpadpro/index.html</a> para obtener
      información sobre el cable paralelo necesario. El controlador
      automágicamente detecta qué tipos de pads PSX están conectados de
      entre los digitales, analógicos (modo rojo o verde), NegCon, multi
      taps, pistolas de luz Namco, Jogcons (volantes con retroalimentación
      de fuerza), y el ratón. Si el mando no es reconocido es tratado como
      un mando analógico, queriendo decir que el controlador debería
      funcionar con casi cualquier cosa. Puede conectar los mandos como
      desee, pero sólo serán usados los primeros 8.

      El Dual Shock de Sony o el Jogcon de Namco se volverán a colocar ellos
      mismos en modo digital después de no haber sido muestreados durante 5
      segundos. Esto es normal, pasa lo mismo en una Playstation, están
      diseñados para detener cualquier vibración en caso de que la máquina
      anfitrión se cuelgue. Otros mandos multifunción tendrán rarezas
      similares. Sin embargo, si esto le ocurre a un mando Jogcon, el botón
      para cambiar de modo será desactivado. Para reactivarlo, tendrá que
      apretar y mantener pulsados al mismo tiempo los botones Start y Select.

      El G-con45 necesita ser conectado (y apuntar) a un monitor de tipo TV
      conectado a su ordenador. La salida compuesta de vídeo de mi tarjeta
      funciona bien con ésto (una Hercules Stingray 128/3D 8Mb). Los modos
      de vídeo TV también deberían funcionar en Mame.
<li>
   JOY_TYPE_N64PAD_LPT1<br>
   JOY_TYPE_N64PAD_LPT2<br>
   JOY_TYPE_N64PAD_LPT3<br>
      Pads N64 conectados a los puertos LPT1, LPT2, y LPT3 respectivamente.
      Mire <a href="http://www.st-hans.de/N64.htm">http://www.st-hans.de/N64.htm</a> para obtener información
      sobre el adaptador hardware necesario. Soporta hasta cuatro mandos en
      un único puerto paralelo. No es necesario caliblar el control
      analógico, ya que ésto lo hace el mando por si mismo cuando se
      enciende. Esto significa que el stick tiene que estar centrado cuando
      el mando es inicializado. Un posible problema que la gente podría tener
      con este controlador es que es físicamente imposible poner el stick
      analógico totalmente diagonal, pero no veo que esto pueda causar
      grandes problemas. Esto es debido a la forma del mando donde reposa la
      palanca del control analógico. Como el del Gravis Game Pad Pro, este
      controlador necesita desconectar brevemente las interrupciones de
      hardware mientras es muestreado. Esto causa un notable impacto en la
      ejecución de mi maquina con ambos controladores, pero no hay modo de
      evitarlo. En una (muy) tosca suposición diría que ésto relentiza el
      Mame un 5%-10%.
<li>
   JOY_TYPE_DB9_LPT1<br>
   JOY_TYPE_DB9_LPT2<br>
   JOY_TYPE_DB9_LPT3<br>
      Una pareja de joysticks de dos botones conectados al puerto LPT1,
      LPT2 y LPT3 respectivamente. El primer puerto es compatble con un
      controlador joy-db9 (multisistema 2 botones), y el segundo es
      compatible con la interfaz Atari del DirectPad Pro. Lea en el fichero
      de código fuente (src/dos/multijoy.c) información de los pines.
<li>
   JOY_TYPE_TURBOGRAFIX_LPT1<br>
   JOY_TYPE_TURBOGRAFIX_LPT2<br>
   JOY_TYPE_TURBOGRAFIX_LPT3<br>
      Estos controladores soportan hasta 7 joysticks, cada uno con hasta 5
      botones, conectados a los puertos LPT1, LPT2 y LPT3 respectivamente.
      Usan la interfaz TurboGraFX de Steffen Schwenke: mire
      <a href="http://www.burg-halle.de/~schwenke/parport.html">http://www.burg-halle.de/~schwenke/parport.html</a> para más
      detalles sobre cómo construir esto.
<li>
   JOY_TYPE_WINGWARRIOR<br>
      Un joystick Wingman Warrior.
<li>
   JOY_TYPE_IFSEGA_ISA<br>
   JOY_TYPE_IFSEGA_PCI<br>
   JOY_TYPE_IFSEGA_PCI_FAST<br>
      Controlador para las tarjetas con interfaz de joystick IF-SEGA, de
      la companía IO-DATA (éstas existen en variantes PCI, PCI2 e ISA).
</ul>

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg006.html#install_joystick">install_joystick</a>.</font></blockquote>
<b>Drivers: <a name="GFX_*/DOS">GFX_*/DOS</a></b><br>
   La librería para DOS soporta los siguientes parámetros de tarjeta para
   la función set_gfx_mode():
<ul><li>
   GFX_TEXT<br>
      Volver al modo texto.
<li>
   GFX_AUTODETECT<br>
      Deja que Allegro escoja un driver gráfico apropiado.
<li>
   GFX_AUTODETECT_FULLSCREEN<br>
      Autodetecta el driver gráfico, pero sólo usará drivers a pantalla
      completa, fallando si no están disponibles en la plataforma actual.
<li>
   GFX_AUTODETECT_WINDOWED<br>
      Igual que el anterior, pero sólo con drivers en ventana. Esto siempre
      fallará bajo DOS.
<li>
   GFX_SAFE<br>
      Controlador especial para cuando quiere establecer un modo gráfico
      seguro y no le importa realmente en qué resolución o profundidad de
      color. Mire para más detalles la documentación de set_gfx_mode().
<li>
   GFX_VGA<br>
      El modo 13h estándar de 256 colores de la VGA, usando el controlador
      GFX_VGA. Este es normalmente 320x200, que le permitirá trabajar con
      cualquier VGA pero no soporta pantallas virtuales grandes ni scroll
      por hardware. Allegro permite también varias variantes modificadas de
      este modo que permiten scroll, miden 320x100 (con una pantalla virtual
      de 200 pixels de altura), 160x120 (con una pantalla virtual de 409
      pixels de altura), 256x256 (sin scroll), y 80x80 (con una pantalla
      virtual de 819 pixels de altura).
<li>
   GFX_MODEX<br>
      El Modo-X funcionará en cualquier tarjeta VGA, y permite un rango de
      resoluciones modificadas de 256 colores.
<ul><li>
      Resoluciones estables del modo-X:
<ul><li>
         Razón de aspecto cuadrado: 320x240
<li>
         Razón de aspecto oblicuo: 256x224, 256x240, 320x200, 320x400,
                                   320x480, 320x600, 360x200, 360x240,
                                   360x360, 360x400, 360x480
</ul>
         Estos han funcionado en cada tarjeta/monitor que he probado.
<li>
      Resoluciones de modo-X inestables:
<ul><li>
         Razón de aspecto cuadrado: 360x270, 376x282, 400x300
<li>
         Razón de aspecto oblicuo: 256x200, 256x256, 320x350, 360x600,
                                   376x308, 376x564, 400x150, 400x600
</ul>
         Estos sólo funcionan en algunos monitores. Funcionaron bien en mi
         vieja máquina, pero no se llevan bien con mi nuevo monitor. Si está
         preocupado por la posibilidad de dañar su monitor usando estos
         modos, no lo esté. Por supuesto no estoy dando ninguna garantía al
         respecto, y si su hardware explota es una pena, pero no creo que
         este tipo de ajustes puedan hacer daño alguno. De la documentación
         del programa TWEAK de Robert Schmidt:

            "Hace tiempo, poner valores o combinaciones ilegales o no
            soportadas en los registros de la tarjeta de vídeo podía ser
            peligroso para su salud y para su monitor. *Nunca* he declarado
            que esto no pueda pasar si usa TWEAK, pero estoy muy seguro de
            que esto nunca pasará. Nunca he oído que usar TWEAK o cambiar
            manualmente los registros de la VGA hayan ocasionado daño
            alguno."
</ul>
      La mayoría de las funciones de dibujo en el modo-X son más lentas que
      en el modo 13h, debido a la complejidad de la organización planar del
      bitmap, pero los rellenos de áreas sólidas y los blits alineados al
      plano de una parte de la memoria de vídeo a otra pueden ser
      significativamente más rápidos, particularmente en hardware antiguo.
      El modo-x accede a las 256k totales de la RAM de la VGA, por lo que el
      scroll por hardware y el intercambio de páginas es posible, y es
      posible partir la pantalla para mover la parte superior y tener un
      indicador de estado fijo en la parte inferior.
<li>
   GFX_VESA1<br>
      Usa el controlador VESA 1.x.
<li>
   GFX_VESA2B<br>
      Usa el controlador VBE 2.0 con bancos.
<li>
   GFX_VESA2L<br>
      Usa el controlador VBE 2.0 con framebuffer lineal.
<li>
   GFX_VESA3<br>
      Usa el controlador VBE 3.0. Este es el único controlador VESA que
      soporta la función request_refresh_rate().

      Los modos VESA estándares son 640x480, 800x600, y 1024x768. Estos
      deberían funcionar con cualquier tarjeta SVGA: si no lo hacen, consiga
      una copia del Scitech Display Doctor y mire si se soluciona el
      problema. Las profundidades de color disponibles dependen de su
      hardware. La mayoría de las tarjetas soportan resoluciones de 15 y 16
      bits, pero si es posible se recomendaría implementar ambas (no es tan
      difícil...) en caso de que una no esté disponible. Algunas tarjetas
      permiten color verdadero de 24 y 32 bits, en cuyo caso la elección
      es entre 24 (salvar memoria) o 32 (va más rápido), pero algunas
      tarjetas antiguas no tienen modos de 32 bits y algunas nuevas no
      soportan resoluciones de 24 bits. Use el programa de test vesainfo
      para saber qué modos puede visualizar con su controlador VESA.

      Muchas tarjetas también soportan 640x400, 1280,1024 y 1600x1200, pero
      estos modos no siempre están disponibles, por ejemplo las tarjetas S3
      no tienen modo 640x400. Otras resoluciones raras pueden estar
      disponibles, ej: algunas tarjetas Tseng tienen un modo 640x350, y la
      Advance Logic tiene un modo de 512x512.

      El SciTech Display Doctor provee varios modos de baja resolución en
      los que puede hacer scroll en un rango diferente de profundidades de
      color (320x200, 320x240, 320x400, 320x480, 360x200, 360x240, 360x400,
      y 360x480 funcionan en mi ET4000 a 8, 15 o 16 bits por pixel). Estos
      modos son fenomenales, permitiéndle hacer scroll o intercambio de
      páginas sin la complejidad del modo-X, pero desafortunadamente no son
      un estándar, por lo que necesitará el Display Doctor para poder
      usarlos.
<li>
   GFX_VBEAF<br>
      VBE/AF es un superconjunto del estándar VBE 2.0, que trae un API para
      acceder a características de aceleración por hardware. Los
      controladores VBE/AF actualmente sólo están disponibles desde el
      proyecto FreeBE/AF o como una parte del pack del SciTech Display
      Doctor, pero puede proporcionar grandes mejoras en la velocidad si se
      usa con el hardware adecuado. Para ver una discusión detallada sobre
      la aceleración por hardware, lea la documentación sobre la variable
      gfx_capabilities.

      Puede usar el programa test afinfo para comprobar si tiene un
      controlador VBE/AF, y para ver qué resoluciones soporta.

      Los controladores VBE/AF de SciTech requieren que el acceso con
      nearptr esté activado, por lo que cualquier puntero erróneo puede
      bloquear su máquina cuando estos controladores estén en uso. Esto
      significa que puede ser buena idea usar VESA mientras depura su
      programa, y activar VBE/AF sólo cuando el código funcione
      correctamente. Los controladores FreeBE/AF no tienen este problema.
<li>   
   GFX_XTENDED
      Un modo 640X400 con memoria plana como está descrito por Mark Feldman
      en PCGPE. Usa VESA para seleccionar un modo SVGA (por lo tanto, sólo
      funcionará en tarjetas que soporten una resolución VESA 640X400), y
      luego activa la memoria plana como si se fuese a utilizar el modo-x.
      Esto permite que la pantalla entera pueda ser direccionada sin
      necesidad de utilizar conmutación de bancos, aunque el scroll por
      hardware y el intercambio de páginas no serán posibles. Este driver
      nunca será autodetectado (en su lugar el modo VESA 640X400 normal será
      el seleccionado), por lo tanto si desea utilizarlo, deberá pasar
      GFX_EXTENDED explícitamente a set_gfx_mode().
</ul>

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg007.html#set_gfx_mode">set_gfx_mode</a>.</font></blockquote>
<b>Drivers: <a name="DIGI_*/DOS">DIGI_*/DOS</a></b><br>
   Las funciones DOS soportan las siguientes tarjetas de sonido digitales:
<blockquote class="text"><pre>
      DIGI_AUTODETECT      - permite que Allegro elija un driver de sonido
                             digital
      DIGI_NONE            - sin sonido digital
      DIGI_SB              - Sound Blaster (autodetección)
      DIGI_SB10            - SB 1.0 (8 bit mono single shot dma)
      DIGI_SB15            - SB 1.5 (8 bit mono single shot dma)
      DIGI_SB20            - SB 2.0 (8 bit mono dma autoinicializada)
      DIGI_SBPRO           - SB Pro (8 bit stereo)
      DIGI_SB16            - SB16 (16 bit stereo)
      DIGI_AUDIODRIVE      - ESS AudioDrive
      DIGI_SOUNDSCAPE      - Ensoniq Soundscape
      DIGI_WINSOUNDSYS     - Windows Sound System
</pre></blockquote>

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg022.html#detect_digi_driver">detect_digi_driver</a>,
<a class="xref" href="alleg022.html#install_sound">install_sound</a>,
<a class="xref" href="alleg026.html#install_sound_input">install_sound_input</a>.</font></blockquote>
<b>Drivers: <a name="MIDI_*/DOS">MIDI_*/DOS</a></b><br>
   Las funciones DOS soportan las siguientes tarjetas de sonido MIDI:
<blockquote class="text"><pre>
      MIDI_AUTODETECT      - permite que Allegro elija un driver de sonido
                             MIDI
      MIDI_NONE            - sin sonido MIDI
      MIDI_ADLIB           - Adlib o sintetizador FM SB (autodetección)
      MIDI_OPL2            - sintetizador OPL2 (mono, usado en Adlib y SB)
      MIDI_2XOPL2          - sintetizadores duales OPL2 (stereo, usado en SB
                             Pro-I)
      MIDI_OPL3            - sintetizador OPL3 (stereo, SB Pro-II y
                             superiores)
      MIDI_SB_OUT          - interfaz MIDI SB
      MIDI_MPU             - interfaz MIDI MPU-401
      MIDI_DIGMID          - reproductor por software de tablas de ondas
                             basado en samples
      MIDI_AWE32           - AWE32 (chip EMU8000)
</pre></blockquote>

<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg022.html#detect_midi_driver">detect_midi_driver</a>,
<a class="xref" href="alleg022.html#install_sound">install_sound</a>,
<a class="xref" href="alleg026.html#install_sound_input">install_sound_input</a>.</font></blockquote>
<b>void <a name="split_modex_screen">split_modex_screen</a>(int line);</b><br>
   Esta función sólo está disponible en modo-X. Permite la división de la
   pantalla VGA en dos partes por una línea especifica. En la mitad superior
   de la pantalla puede hacer scroll a cualquier punto de la memoria de video
   mediante la función scroll_screen(), pero la parte inferior será siempre
   fija y mostrará el contenido de la posición (0, 0) del bitmap de pantalla
   (screen). Tras dividir la pantalla, normalemente querrá hacer un scroll de
   forma que la parte superior muestre una zona más baja de la memoria de
   video y después creará dos sub-bitmaps para acceder a ambas secciones (en
   examples/exscroll.c tiene una demostración de cómo se puede hacer esto).
   Para desactivar la división, llame a split_modex_screen(0).


<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg007.html#set_gfx_mode">set_gfx_mode</a>,
<a class="xref" href="alleg007.html#scroll_screen">scroll_screen</a>.</font></blockquote>
<b>extern int <a name="i_love_bill">i_love_bill</a>;</b><br>
   Cuando se ejecuta en entorno DOS puro, el temporizador reprograma
   dinámicamente el reloj para generar interrupciones en los momentos
   exactos, lo que confiere una exactitud extremadamente alta.
   Desafortunadamente, esta velocidad constante no funciona correctamente en
   la mayoría de sistemas multitarea (sobre todo bajo Windows), por lo tanto,
   existe un modo alternativo que bloquea la interrupción del temporizador
   por hardware a una velocidad de 200 ticks por segundo. Esto, reduce la
   fiabilidad del temporizador (por ejemplo, rest() redondeará el tiempo de
   espera al 5º milisegundo más cercano al tiempo especificado), e impide al
   simulador de retrazo vertical su funcionamiento, pero como punto positivo,
   permite que los programas de Allegro funcionen bajo Windows. Esta variable
   es inicializada por allegro_init() si se detecta la presencia de un
   sistema operativo multitarea y además se activa el modo de temporizador de
   razón fija.




<blockquote class="xref"><font size="-1" face="helvetica,verdana"><em><b>Relacionado con:</b></em>
<a class="xref" href="alleg004.html#install_timer">install_timer</a>,
<a class="xref" href="alleg000.html#allegro_init">allegro_init</a>,
<a class="xref" href="alleg000.html#os_type">os_type</a>.</font></blockquote>
<hr><a href="allegro.html">Volver al Indice</a>

</body>
</html>
