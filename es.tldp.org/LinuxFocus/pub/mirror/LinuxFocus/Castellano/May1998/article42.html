<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML lang="es">
<HEAD><META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <TITLE>LF vol. 4, RenderMan</TITLE>
 <META name="Author" CONTENT="Miguel Angel Sepulveda">
 <META name="Keywords" CONTENT="linux magazine opengl glut network management">
 <META name="Description" CONTENT="Free online magazine on Linux for users and developers">
 <META name="Copyright" CONTENT="&copy; 1998 LinuxFocus">
 <META name="Translator" CONTENT="">
 <META name="Date" CONTENT="1998-02-03T00:00:00Z">


</HEAD>

<BODY bgcolor="#FFFFFF"  text="#000000" link="#ff0033" vlink="#FF3333">

  <MAP name="navegator">
  <AREA shape="rect" coords="0, 0, 65, 28" alt="Hogar" href="../">
  <AREA shape="rect" coords="66, 0, 124, 28" alt="Indice" href="../indice.html">
  <AREA shape="rect" coords="125, 0, 193, 28" alt="Busqueda" href="../search.html">
  <AREA shape="rect" coords="194, 0, 260, 28" alt="Enlaces" href="../links.html">
  <AREA shape="rect" coords="261, 0, 350, 28" alt="Sobre Nosotros" href="../aboutus.html">
  </MAP>



 <TABLE border="0" width="100%" cellspacing="0" cellpadding="0">

 <THEAD>
   <TR align="center">
      <TD colspan="2"><IMG src="../../common/May1998/border-short.jpg" alt="[LinuxFocus Image]" width="407" height="88"></TD>
   </TR>

   <TR align="center">
      <TD colspan="2" bgcolor="#660033"><IMG src="../../common/May1998/Navegator-bar.gif" ismap usemap="#navegator" border="0" width="351" height="28" alt="[Navegation Bar]"></TD>
   </TR>

   <TR align="center">
     <TD colspan="2">     
           <TABLE  border="0" width="75%" cellspacing="0" cellpadding="5">
		<TR bgcolor="#000000">
		   <TD align="center">
               <A href="../News/"><FONT face="Helvetica,Arial" color="#ffffff"><B>&nbsp; Noticias</B></FONT></A>
               <A href="../Archives/"><FONT face="Helvetica,Arial" color="#ffffff"><B>&nbsp; Archivos</B></FONT></A>
               <A href="../Companies/"><FONT face="Helvetica,Arial" color="#ffffff"><B>&nbsp; Compa&ntilde;ias</B></FONT></A>
               <A href="../Tips/"><FONT face="Helvetica,Arial" color="#ffffff"><B>&nbsp; Consejos y Trucos &nbsp;</B></FONT></A> 
               </TD>
            </TR>
            
		<TR>
            <!--   Here goes the Title of the article, authors name and abstract -->
		   <TD align="center">
 			<FONT face="Helvetica,Arial" color="#660066"><H1>RenderMan</H1></FONT>

		  <H3><FONT FACE="Helvetica,Arial"><FONT COLOR="#000000">Por 
			<A HREF="mailto:ccgrau@disca.upv.es"><FONT COLOR="#000000">Carlos Calzada Grau
			  </font></A></FONT></FONT></H3>

                  <HR size="2" noshade>
	         </TD>
            </TR>

           </TABLE>

     </TD>
   </TR>

 </THEAD>



 <TBODY>
  
 <TR>
    <TD valign="top" align="center">
           <H4><A href="#intro">Introducción</A></H4>
           <H4><A href="#instal">Instalación</A></H4>
           <H4><A href="#pasos">Primeros Pasos</A></H4>
           <H4><A href="#conclu">Conclusiones</A></H4>
    </TD>
   
    <TD align="center">
       <TABLE border="0" width="70%" cellspacing="10" cellpadding="0">
	  <TR>
          <TD>

 <A name="intro"></A>
<h3><FONT FACE="Helvetica,Arial"><FONT COLOR="#660033">Introducci&oacute;n</FONT></FONT></H3>

&iquest; Quien no   ha    o&iacute;do   hablar       de    <A
HREF="http://www.pixar.com">Pixar</A>?, &iquest; Quien   no ha visto <A
HREF="http://www.toystory.com">Toy Story</A>?. Pixar Animation Studios
se dedica desde hace mucho tiempo a la animaci&oacute;n por ordenador.
<I>Luxo Jr. </I>(1986) fue  la primera pel&iacute;cula en 3D realizada
por ordenador  nominada al Oscar, adem&aacute;s gan&oacute; m&aacute;s
de 20 premios en festivales de cine internacionales.

<p>
<CENTER>
<IMG SRC="../../common/May1998/luxo.jpg" HEIGHT=171 WIDTH=180 HSPACE="10">
<IMG SRC="../../common/May1998/tt.jpg" HEIGHT=152 WIDTH=180 HSPACE="10">
</CENTER>

<p> En 1987, <I>Red's Dream</I> gan&oacute; varios premios en el Festival
 Mundial de Animaci&oacute;n en Zagreb  y en el Festival Internacional
 de Cine de San Francisco.&nbsp;

<p>
La primera animaci&oacute;n que  gan&oacute; un  Oscar fue <I>Tin  Toy
</I>(1988),     Pixar realiz&oacute; un  modelo    para  la cara de un
beb&eacute; definiendo m&aacute;s de 40 m&uacute;sculos que controlaba
el animador.

<p>
<CENTER>
<IMG SRC="../../common/May1998/red.jpg" HEIGHT=157 WIDTH=180 HSPACE="10">
<IMG SRC="../../common/May1998/kk.jpg" HEIGHT=120 WIDTH=180 HSPACE="10">
</CENTER>

<p>
En 1989 sacaron <I>Knick Knack</I>, es la historia de un mu&ntilde;eco
de  nieve que vive  en una bola.  La pel&iacute;cula se realiz&oacute;
inicialmente para  verla  en  3D  aunque tambi&eacute;n  sacaron   una
versi&oacute;n normal.

<p>
 Despu&eacute;s de  esto vendr&iacute;an muchos m&aacute;s exitos como
 la reciente pel&iacute;cula  <I><A HREF="http://www.toystory.com">Toy
 Story</A>. </I>Este es  uno de los primeros  largometrajes realizados
 &iacute;ntegramente  por  ordenador.  En    la p&aacute;gina  de   <A
 HREF="http://www.pixar.com">Pixar</A>    pod&eacute;is      encontrar
 m&aacute;s  cosas interesantes, como Toy Story  2 que esperan sacarla
 en 1999.

<p> Pixar desarroll&oacute;  el interface   RenderMan para separar   y
mantener independientes los  "modeladores" y los  "renderizadores". Un
modelador  es   una herramienta  que  se  usa  para  dibujar  escenas,
dise&ntilde;ar animaciones   etc., mientras   que un renderizador   lo
&uacute;nico que hace  es coger esa descripci&oacute;n y representarla
con sombras, luces, texturas, etc.

<p>
 RenderMan permite a los modeladores especificar que es lo que hay que
 renderizar pero  no  c&oacute;mo hacerlo, es   decir, un modelador no
 deber&iacute;a   preocuparse en absoluto   del rendering.   Del mismo
 modo,  un renderizador  que cumpla las  especificaciones del estandar
 RenderMan puede   usar Z-buffer, scan-line,  ray-tracing, radiosity o
 cualquier otro m&eacute;todo para   "dibujar" los objetos, y  esto es
 independiente de RenderMan. Podemos  ver el interface RenderMan  como
 un formato    de descripci&oacute;n de  escenas  del   mismo modo que
 PostScript      es  un      formato  de      descripci&oacute;n    de
 p&aacute;ginas. Este standard es independiente  de arquitecturas y de
 sistemas operativos.

<CENTER>
<IMG SRC="../../common/May1998/pixar1.jpg" HEIGHT=100 WIDTH=72>
<IMG SRC="../../common/May1998/pixar2.jpg" HEIGHT=111 WIDTH=83>
<IMG SRC="../../common/May1998/pixar3.jpg" HEIGHT=126 WIDTH=61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<IMG SRC="../../common/May1998/pixar4.jpg" HEIGHT=115 WIDTH=61>
<IMG SRC="../../common/May1998/pixar5.jpg" HEIGHT=90 WIDTH=53>
<IMG SRC="../../common/May1998/pixar6.jpg" HEIGHT=95 WIDTH=75>
</CENTER>

<CENTER><I>The RenderMan@ Interface Procedures and RIB Protocol are:<br>
Copyright 1988, 1989, Pixar.<br>
All Rights Reserved.<br>
RenderMan@ is a registered trademark of Pixar</I></CENTER>


<P>En  este art&iacute;culo  trataremos de  introducirnos  un poco  en
RenderMan,               para       ello     usaremos               <A
HREF="http://www.seas.gwu.edu/student/gritz/bmrt/html">Blue       Moon
Rendering Tools</A>,  escrito   &iacute;ntegramente por  Larry  Gritz.
Este   paquete   es  un   renderizador   de libre  distribuci&oacute;n
(s&oacute;lo ejecutables y para  uso personal), existen versiones para
muchas m&aacute;quinas  entre las que se encuntra  Linux (de hecho fue
una de las primeras implementaciones), utiliza ray-tracing y radiosity
y no tiene  nada que envidiar   a Photorealistic RenderMan  (PRMan) el
producto comercial de Pixar.

<P>En  un principio el  sistema de  coordenadas del  mundo y  el de la
c&aacute;mara coinciden, son  sistemas de coordenadas lev&oacute;giros
(exactamente igual que el del Pov-Ray), con el  origen en el centro de
la pantalla, el eje X hacia la derecha, el Y hacia arriba y el Z hacia
"dentro" de la  pantalla.  En  la siguiente   figura podemos ver    la
c&aacute;mara que se usa por  defecto (el eje X  es rojo, el Y verde y
el  Z  azul,  para     ver  el c&oacute;digo   fuente  pincha    en la
imagen).&nbsp; Un sistema dextr&oacute;giro es igual pero con el eje Z
cambiado de signo.

<P>
<CENTER><A HREF="../../common/May1998/default_camera.rib">
<IMG SRC="../../common/May1998/default_camera.jpg" HEIGHT=240 WIDTH=320></A>
</CENTER>


<P>En Pov-Ray, el sistema de coordenadas del mundo  es fijo, es decir,
podemos mover   la  c&aacute;mara por el mundo   y  poner los  objetos
mediate transformaciones, en RenderMan,  ocurre justo lo contrario, la
c&aacute;mara  es fija y lo que  se  transforma para obtener distintos
puntos de vista es  el sistema de  coordenadas del mundo. Todo esto lo
veremos m&aacute;s adelante cuando "desmiguemos" un ejemplo.

<P>RenderMan   contempla  much&iacute;simas   primitivas,   tanto   de
definici&oacute;n de  objetos como    de  luces y   dem&aacute;s.    A
continuaci&oacute;n   veremos, como  ejemplo,    el formato    de  las
cu&aacute;dricas  que  son las   m&aacute;s   famosas, aunque  existen
m&aacute;s (como parches bezier, pol&iacute;gonos, etc.).

<p>
<center>
<TABLE BORDER=0 COLS=2 WIDTH="100%" NOSAVE >
<TR>
<TD><A HREF="../../common/May1998/disk.rib"><IMG SRC="../../common/May1998/disk.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>
<TD><A HREF="../../common/May1998/cone.rib"><IMG SRC="../../common/May1998/cone.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>
</TR>

<TR>
<TD><I><B>&nbsp;&nbsp;&nbsp;Disk&nbsp;&nbsp;&nbsp; </B>height&nbsp;&nbsp;&nbsp; radius&nbsp;&nbsp;&nbsp;
thetamax</I>&nbsp;

<P><B>&nbsp;&nbsp;&nbsp; Disk&nbsp;&nbsp;&nbsp;&nbsp; </B>5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 300&nbsp;</TD>

<TD><I><B>&nbsp;&nbsp;&nbsp; Cone</B>&nbsp;&nbsp;&nbsp; height&nbsp;&nbsp;&nbsp;
radius&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp; <B>Cone&nbsp;&nbsp;&nbsp; </B>15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 300&nbsp;</TD>
</TR>
</TABLE>
<!-- ------------------------------------------------------------------- -->
<TABLE BORDER=0 COLS=2 WIDTH="100%" NOSAVE >
<TR>
<TD><A HREF="../../common/May1998/cylinder.rib"><IMG SRC="../../common/May1998/cylinder.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>

<TD><A HREF="../../common/May1998/sphere.rib"><IMG SRC="../../common/May1998/sphere.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>
</TR>

<TR>
<TD><I><B>Cylinder&nbsp;&nbsp;&nbsp; </B>radius&nbsp;&nbsp;&nbsp; zmin&nbsp;&nbsp;&nbsp;
zmax&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp;<B> Cylinder</B>&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
300&nbsp;</TD>

<TD><I><B>&nbsp;Sphere&nbsp;</B>&nbsp;&nbsp; radius&nbsp;&nbsp;&nbsp; zmin&nbsp;&nbsp;&nbsp;
zmax&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp;<B> Sphere</B>&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
300&nbsp;</TD>
</TR>
</TABLE>
<!-- ------------------------------------------------------------------- -->
<TABLE BORDER=0 COLS=2 WIDTH="100%" NOSAVE >
<TR>
<TD><A HREF="../../common/May1998/torus.rib"><IMG SRC="../../common/May1998/torus.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>

<TD><A HREF="../../common/May1998/paraboloid.rib"><IMG SRC="../../common/May1998/paraboloid.jpg" HEIGHT=240 WIDTH=320 ALIGN=LEFT></A></TD>
</TR>

<TR>
<TD><I><B>Torus</B>&nbsp;&nbsp;&nbsp; major rad&nbsp;&nbsp;&nbsp; min rad&nbsp;&nbsp;&nbsp;
phimin&nbsp;&nbsp;&nbsp; phimax&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp; <B>Torus&nbsp;&nbsp;&nbsp; </B>10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 320&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
300&nbsp;</TD>

<TD><I><B>Paraboloid</B>&nbsp;&nbsp;&nbsp; radius&nbsp;&nbsp;&nbsp; zmin&nbsp;&nbsp;&nbsp;
zmax&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp;<B> Paraboloid</B>&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
300&nbsp;</TD>
</TR>
</TABLE>

<!-- ------------------------------------------------------------------- -->

<TABLE BORDER=0 COLS=1 NOSAVE >
<TR ALIGN=CENTER NOSAVE>
<TD NOSAVE><A HREF="../../common/May1998/hyperboloid.rib"><IMG SRC="../../common/May1998/hyperboloid.jpg" HEIGHT=240 WIDTH=320 ALIGN=center></A></TD>
</TR>
<TR ALIGN=CENTER NOSAVE>
<TD NOSAVE><I><B>&nbsp;&nbsp; Hyperboloid</B>&nbsp;&nbsp;&nbsp; point1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
point2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thetamax</I>&nbsp;

<P>&nbsp;&nbsp;&nbsp; <B>Hyperboloid</B>&nbsp;&nbsp;&nbsp; 0 10 -5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10 5 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 300&nbsp;</TD>
</TR>
</TABLE></CENTER>
<!-- ------------------------------------------------------------------- -->
<p>
Podemos observar que el  formato de algunas de  estas primitivas no es
demasiado  sencillo, pero  teniendo en cuenta  que el   fichero  RIB lo   debe
proporcionar un modelador como salida,  este formato es el  m&aacute;s
adecuado, tanto por sencillez como por potencia.


 <A name="instal"></A>
<H3>
<FONT FACE="Helvetica,Arial"><FONT COLOR="#660033">Instalaci&oacute;n</FONT></FONT></H3>

Antes  de  nada  debemos   ir    a   la p&aacute;gina   de&nbsp;    <A
HREF="http://www.seas.gwu.edu">Blue      Moon    Rendering Tools</A> y
bajarnos  el programa. En  estos momentos la versi&oacute;n m&aacute;s
reciente  es la  2.3.6 y  para descomprimirlo  se procede  de la forma
normal:

<pre>
rabit:~/$ gzip -d BMRT2.3.6.linux.tar.gz
rabit:~/$ tar xvf BMRT2.3.6.linux.tar
</pre>

<P>  Una vez   descomprimido   y desempaquetado nos  crear&aacute;  un
directorio llamado BMRT2.3.6, en &eacute;l tenemos los ejecutables (en
<tt>bin/</tt>),    los  ejemplos     (en    <tt>examples/</tt>)   y     la
documentaci&oacute;n  en  postcript    y  HTML    (en    <tt>doc/</tt>),
tambi&eacute;n hay un     <tt>README</tt> en el  que,  adem&aacute;s  de
informaci&oacute;n  &uacute;til sobre el  programa y dem&aacute;s, hay
un apartado de instalaci&oacute;n. Es muy sencillo y no deber&iacute;a
dar problemas a nadie.

 <A name="pasos"></A>
<H3>
<FONT FACE="Helvetica,Arial"><FONT COLOR="#660033">Primeros Pasos</FONT></FONT></H3>

Para familiarizarnos con  la especificaci&oacute;n, veremos un fichero
t&iacute;pico Renderman (<A HREF="../../common/May1998/disptest.rib">../../common/May1998/disptest.rib</A>).  La
imagen se genera con <tt>rendrib -v ../../common/May1998/disptest.rib</tt> (pinchando en la
imagen la veremos a 1024x768 y con<I> anti-aliasing </i>2x2).

<p>Este es  uno de los  muchos ejemplos que encontrar&eacute;is  en el
directorio<tt>  examples/</tt> de BMRT (Blue   Moon Rendering Tools) y
como  pod&eacute;is ver el  fichero  que lo  produce  no es  muy largo
(cuando   hagamos animaciones veremos como   el&nbsp; fichero crece de
forma considerable).

<p>
<CENTER><A  HREF="../../common/May1998/balls2h.jpg">
<IMG  SRC="../../common/May1998/balls2.jpg"   HEIGHT=300      WIDTH=400></A>
</CENTER>     

<P>C&oacute;mo habr&eacute;is   podido  observar, en    el  directorio
<tt>bin/</tt>   hay       varios     ejecutables:    <tt>rendrib</tt>,
<tt>rendribv</tt> y <tt>rgl</tt>.  <tt>Rendrib</tt> es el renderizador
con todas las de la ley, <tt>rendribv</tt> es igual, pero renderiza en
modo  <i>wire-frame</i>,   es     decir, con     l&iacute;neas,    por
&uacute;ltimo, <tt>rgl</tt> renderiza  en modo pol&iacute;gonos. Estos
&uacute;ltimos renderizadores  son para hacer previews  de posiciones,
animaciones   etc.,   el     rendering final   debemos   hacerlo   con
<tt>rendrib</tt>.


<p> El formato de los ficheros RIB (Renderman Interface ByteStream) es
bastante sencillo, aunque no por ello menos potente, y son ficheros de
texto plano (igualito, igualito que  Pov-Ray). Un fichero RIB correcto
contiene lo siguiente:

<OL>
<LI>
Opciones que son constantes para todos los <i>frames</i>
(resoluci&oacute;n, anti-aliasing, etc.).</LI>

<LI>
<tt>FrameBegin</FONT></TT></LI>

<LI>
Inicializaci&oacute;n de las opciones del estado
gr&aacute;fico para este <I>frame</I> (como el nombre del fichero de salida,
nivel de detalle etc.)</LI>

<LI>
Atributos del   estado gr&aacute;fico  para  este  <I>frame</I>  (como
luces, tipo de proyecci&oacute;n, etc.).</LI>

<LI>
<tt>WorldBegin</TT></LI>

<LI>
Modificaci&oacute;n de   los  atributos del estado    gr&aacute;fico y
declaraciones de geometr&iacute;a para el <I>frame</I> actual.</LI>

<LI>
<TT>WorldEnd</TT>. Lo cual provoca: el <I>frame</I>
actual se renderiza y se salva. Toda la geometr&iacute;a y las luces declaradas
en (6) se destruyen. El estado gr&aacute;fico vuelve al que hab&iacute;a
antes de (5).</LI>

<LI>
<TT>FrameEnd</TT>. Esto hace que el estado gr&aacute;fico
vuelva a como estaba antes de (2).</LI>

<LI>
Si hay mas <I>frames</I> se repiten los pasos (2)
a (8).</LI>
</OL>


El estado  gr&aacute;fico  contiene  toda la   informaci&oacute;n para
renderizar una  primitiva.  Se divide en   dos partes: una  global que
permanece constante  de primitiva en  primitiva y un estado actual que
cambia con cada primitiva.   Los par&aacute;metros en el estado global
se   llaman    <I>opciones</I>   y   los      del    estado     actual
<I>atributos</I>.

<P>Para comprender mejor todo esto y para  introducirnos un poco en la
manera de  especificar escenas con RenderMan, vamos   a ver el ejemplo
anterior l&iacute;nea por l&iacute;nea. Con esto  nos haremos una idea
de lo que se puede hacer y de c&oacute;mo hacerlo.

<font size=-1>
<pre>
 1.-  ##RenderMan RIB-Structure 1.0   
 2.-  version 3.03   
 3.-   
 4.-  ###########################################################################   
 5.-  #   
 6.-  # This RIB file demonstrates some more complex procedural textures.   
 7.-  # Two spheres show the use of "stucco" and "dented" displacement shaders.   
 8.-  # The floor shows the gmarbtile_polish shader, which is polised green   
 9.-  # marble tiles.  Note that the reflection is accomplished by the shader   
 10.- # actually calling the trace() function, rather than reflection mapping.   
 11.- #   
 12.- ###########################################################################   
 13.-   
 14.- Option "searchpath" "shader" [".:../shaders:&"]   
 15.- Display "balls2.tif" "file" "rgb"   
 16.- Format 400 300 -1   
 17.- PixelSamples 1 1   
 18.-   
 19.- Declare "prmanspecular" "integer"   
 20.- Option "render" "prmanspecular" [0]   
 21.- Projection "perspective" "fov" 35   
 22.- Translate 0 -0.55 8   
 23.- Rotate -110 1 0 0   
 24.-   
 25.-   
 26.- WorldBegin   
 27.-   
 28.- LightSource "ambientlight" 1 "intensity" 0.02   
 29.-   
 30.- Declare "shadows" "string"   
 31.- Attribute "light" "shadows" "on"   
 32.- LightSource "distantlight" 1 "from" [0 1.5 4] "to" [0 0 0] "intensity" 0.6   
 33.-   
 34.- AttributeBegin   
 35.-   Declare "txtscale" "float"   
 36.-   Declare "Kr" "float"   
 37.-   Declare "darkcolor" "color"   
 38.-   Declare "lightcolor" "color"   
 39.-   Declare "veincolor" "color"   
 40.-   Surface "gmarbtile_polish" "Ka" 1 "txtscale" 0.5 "Kr" .25 "Kd" 0.3 "Ks" 0.2 "roughness" 0.02   
 41.-   Patch "bilinear" "P"  [ -5 -5 0 5 -5 0 -5 5 0 5 5 0  ]   
 42.- AttributeEnd   
 43.-   
 44.- AttributeBegin   
 45.-   Color  [ .6 .6 .6 ]   
 46.-   Translate -1.5 0 1   
 47.-   Surface "matte"   
 48.-   Declare "frequency" "float"   
 49.-   Declare "Km" "float"   
 50.-   Displacement "stucco" "frequency" 20 "Km" 0.3   
 51.-   Sphere 1 -1 1 360   
 52.- AttributeEnd   
 53.-   
 54.- AttributeBegin   
 55.-   Translate 1.5 0 1   
 56.-   Color 1 .45 .05   
 57.-   Declare "Kr" "float"   
 58.-   Declare "Km" "float"   
 59.-   Surface "shiny" "Kd" 0 "Kr" 0.25 "roughness" 0.15 "specularcolor" [1 .5 .06]   
 60.-   Displacement "dented" "Km" 0.5   
 61.-   Sphere 1 -1 1 360   
 62.- AttributeEnd   
 63.-   
 64.- WorldEnd   
</pre>
</font>

<P>Como podemos ver en  la l&iacute;nea 1 y de  la l&iacute;nea 4 a la
12, el s&iacute;mbolo  # se usa  para los comentarios, pueden estar en
cualquier lugar del fichero  y ocupan una  linea (como los comentarios
de  C++ //). Los comentarios los  usaremos  m&aacute;s que nada cuando
editemos estos ficheros a mano ya que ayudan  bastante a comprender el
funcionamiento de la escena.

<P> En la l&iacute;nea 2  est&aacute; la directiva <I>version.</I> Nos
dice qu&eacute; versi&oacute;n del interface se est&aacute; usando (la
3.03), la versi&oacute;n m&aacute;s actual  es la 3.1 de septiembre de
1989  (si, de 1989, no me  he equivocado),  aunque tiene revisiones de
Mayo del 95.

<P>
La linea 14 define con  la directiva <I>searchpath</I> y <I>shader</I>
el   path de   los  "sombreadores",  los   sombreadores le  dicen   al
renderizador de qu&eacute;  forma  un objeto debe  renderizarse  (como
pl&aacute;stico, transparente, etc.), esta   es una de las  cosas  que
hacen potente al interface, ya que las texturas de los objetos son una
especie de  Plug-Ins,  por tanto podemos implementar  nuevas texturas,
efectos etc. sin tener  que  esperar a una versi&oacute;n   m&aacute;s
potente del renderizador.  Normalmente existe una  variable de entorno
(SHADER)  que indica donde est&aacute;n  estos ficheros, por lo que no
se suele declarar en el fichero.

<P>La opci&oacute;n <I>Display</I>  est&aacute; en la l&iacute;nea 15,
con      ella   declaramos el   nombre    del     fichero  de   salida
<I>"balls2.tiff"</I> y su tipo <I>"file" "rgb"</I>,  es decir, de tipo
fichero RGB.&nbsp;</FONT>&nbsp;

<P>En  la   l&iacute;nea  16,   con la   opci&oacute;n <I>Display</I>,
definimos   la  resoluci&oacute;n   del    rendering,  es   decir,  el
tama&ntilde;o de la imagen, que en este caso ser&aacute; de 400x300 el
-1 define  el aspect ratio   del ancho y alto   del pixel (en realidad
deber&iacute;a ser un +1, no s&eacute; por qu&eacute; ponen -1)

<P> A continuaci&oacute;n  tenemos el sampleado horizontal  y vertical
de  cada  pixel,  es  decir,   el n&uacute;mero   de  rayos  que    se
lanzar&aacute;n para renderizar un pixel,  con <I>PixelSamples 2 2</I>
tendremos que por cada pixel lanzaremos 4 rayos,  lo que se traduce en
una mejor calidad de la imagen (esto es el <I>anti-aliasing</I>), pero
por  contra un mayor tiempo de  renderizaci&oacute;n,  en nuestro caso
tendremos &uacute;nicamente un rayo por pixel (1x1=1).

<P>La l&iacute;nea 19 es  una declaraci&oacute;n y en ella simplemente
decimos que <I>prmanspecular</I> en un  <I>integer</I>, en realidad lo
que   hacemos  es definir el   token  <I>prmanspecular</I> y cuando el
renderizador se encuentre con este token,  lo siguiente ser&aacute; un
entero.
<p>

<BR>Seguidamente, en la l&iacute;nea 21, tenemos la declaraci&oacute;n
de  la proyecci&oacute;n, con <I>"perspective"</I>   le decimos que la
proyecci&oacute;n que queremos    es  perspectiva,  y   con   <I>"fov"
35</I>&nbsp;  (<I>field of view</I> o  campo de visi&oacute;n) ponemos
un &aacute;ngulo de visi&oacute;n de 35 grados.

<P> Las siguientes l&iacute;neas, 22 y  23, definen la posici&oacute;n
de la c&aacute;mara.  Primero tenemos   una traslaci&oacute;n y  luego
una  rotaci&oacute;n, pero debido a que  todas las transformaciones se
realizan introduci&eacute;ndolas primero   en la pila y  calculando al
final    (cuando encuentra el   <I>WorldBegin</I>  en  este caso), las
transformaciones se "ejecutan" al rev&eacute;s,  es decir, primero  se
realiza la rotaci&oacute;n de -110 grados en el eje X (para hacerla en
el  eje  Y     se har&iacute;a  <I>Rotate   45   0  1   0</I>),    y a
continuaci&oacute;n la traslaci&oacute;n de -0.55 unidades en el eje Y
y 8 en el eje Z. Hay que tener en cuenta que lo que se gira y traslada
no  es la c&aacute;mara, es el  origen de coordenadas del mundo.&nbsp;
En las siguientes figuras pod&eacute;is  ver las dos transformaciones,
el  estado inicial, la  rotaci&oacute;n  y luego la  traslaci&oacute;n.
<p>

<CENTER>
<A HREF="http:../../common/May1998/default_camera.rib"><IMG SRC="../../common/May1998/default_camera.jpg" HEIGHT=240  WIDTH=320></A>
<A HREF="http:../../common/May1998/camara_pos1.rib"><IMG SRC="../../common/May1998/camara_pos1.jpg" HEIGHT=240 WIDTH=320></A>
<A HREF="http:../../common/May1998/camara_pos2.rib"><IMG SRC="../../common/May1998/camara_pos2.jpg" HEIGHT=240 WIDTH=320></A>
</CENTER>



<P>En  este    punto empieza  la  escena   en   s&iacute;.  Una escena
(declaraci&oacute;n de  las   luces,  de los  objetos,  etc.)  empieza
siempre  con  <tt>WorldBegin</tt>   y   acaba  con   <tt>WorldEnd</tt>
(l&iacute;neas 26 y  64   respectivamente).  Seguidamente  tenemos  la
declaraci&oacute;n de las luces (l&iacute;neas 28 a 32), la primera es
luz    ambiente, es  la  n&uacute;mero uno   (cada  luz  debe tener un
n&uacute;mero, y en teor&iacute;a deben ser distintos) y tiene 0.02 de
intensidad  luminosa.  A  continuaci&oacute;n  vemos  que  se  declara
<tt>shadows</tt>  como una  cadena de   caracteres (<tt>string</tt>) y
activamos la  opci&oacute;n de  las  luces para que  hagan sombra.  La
siguiente l&iacute;nea es una luz  de tipo <tt>distantlight</tt> (como
la del sol por ejemplo) con el n&uacute;mero uno aunque deber&iacute;a
ser otro (por ejemplo el  dos) esto funciona debido  a que BMRT parece
que ignora estos n&uacute;meros,  pero para guardar la  compatibilidad
(por    ejemplo con  PRMan de  Pixar)   debemos  ser  estrictos con el
interface.   La intensidad se  declara igual  que  en la otra  luz(son
atributos  comunes)  y   el  vector  direcci&oacute;n de    la luz con
<tt>from</tt> y <tt>to,</tt> esta  luz lanza rayos paralelos, es  como
si estuviera en el infinito.

<P>A  partir de  aqu&iacute;  tenemos los  tres objetos  que forman la
escena,     cada  objeto    est&aacute;    encerrado   en    un    par
<tt>AttributeBegin</tt>, <tt>AttributeEnd</tt>,  ya que cada uno tiene
sus propias  caracter&iacute;sticas, tanto de posici&oacute;n  como de
apariencia,  si lo &uacute;nico  que cambiaramos  de  un objeto a otro
fuera su posici&oacute;n, podr&iacute;amos declarar la textura fuera y
a continuaci&oacute;n  definir los objetos con <tt>TransformBegin</tt>
y   <tt>TransformEnd</tt>.  El primer  objeto (lineas  34 a  42) es un
parche, los parches pueden ser: uniformes o no-uniformes, racionales o
no-racionales y bilineares o  bic&uacute;bicos, con esto se  consiguen
parches   <tt>Bezier</tt>,  <tt>BSplines</tt>  etc.   (un  libro sobre
gr&aacute;ficos  por  ordenador  ayudar&iacute;a bastante a comprender
esto). En este  caso  tenemos un parche  bilinear  con cuatro  puntos,
estos se definen  con <tt>"P"</tt> y  luego  se ponen las  coordenadas
<tt>(x,y,z)</tt> de los puntos que queramos. La  textura del objeto se
consigue con la directiva <tt>Surface</tt>, el  primer argumento es un
fichero <tt>shader</tt>, las siguientes son espec&iacute;ficas de cada
<tt>shader</tt>. En la  imagen siguiente tenemos  como queda la escena
al        a&ntilde;adir    este       cuadrado.

<CENTER><A
HREF="http:camara_parche.rib"><IMG SRC="../../common/May1998/camara_parche.jpg" HEIGHT=240 WIDTH=320></A>
</CENTER>

<p>El siguiente objeto va  de la l&iacute;nea 44  a la 52, se trata de
una esfera (l&iacute;nea 51)  y el color se  lo proporcionamos  con la
directiva C<tt>olor [R G  B].</tt> A continuaci&oacute;n la ponemos en
el sitio  con <tt>Translat</tt>e y  le decimos que clase de superficie
tiene,  en  este   caso  <tt>matte</tt>   que   no tiene    m&aacute;s
par&aacute;metros.   Despu&eacute;s tenemos la   caracter&iacute;stica
m&aacute;s    importante    de      BMRT,  los   <tt>shaders</tt>   de
desplazamiento. Estos <tt>shaders</tt>  son como  los <I>bump-maps</I>
de Pov-Ray,  con la diferencia que los  "bultos" no son simulados, son
reales. Con esto conseguimos que una esfera con <I>bump-mapping</I> no
se vea redonda por los bordes y  se vea abollada. Los <tt>shaders</tt>
de   desplazamiento  son iguales que los   de   textura, un  nombre de
<tt>shader</tt>   y   sus  par&aacute;metros.&nbsp;  El   formato   de
especificaci&oacute;n  de   esferas  es   un  poco  raro:   el  primer
par&aacute;metro es   el  radio,    el  segundo  y   el   tercero  son
<tt>zmin</tt> y <tt>zmax</tt> respectivamente y recortan la esfera por
esos valores  (<tt>zmin</tt>=-1  y <tt>zmax</tt>=1  la  dejan  entera,
<tt>zmin</tt>=0 y    <tt>zmax</tt>=1 la parten    por la   mitad),  el
&uacute;ltimo valor son los grados que cubre la  esfera, 360 toda, 180
la  mitad etc. La   imagen  siguiente es la   escena  con  la  primera
bola:
<CENTER>
<A HREF="http:camara_bola1.rib"><IMG SRC="../../common/May1998/camara_bola1.jpg" HEIGHT=240 WIDTH=320></A>
</CENTER>

<p>El siguiente  objeto   es igual que    el primero  pero con   otras
caracter&iacute;sticas de  textura y desplazamiento,   por  lo que  no
seremos pesados y lo dejaremos  correr.&nbsp; Como antes, veremos como
queda la escena en  la imagen  siguiente:
<p>
<center>
<A HREF="http:camara_bola2.rib"><IMG SRC="../../common/May1998/camara_bola2.jpg" HEIGHT=240 WIDTH=320></A>
</CENTER>

<P>Con esto se acaba el  fichero. Como pod&eacute;is ver el desarrollo
de escenas no es  muy complejo, pero con  una escena complicada o  con
una animaci&oacute;n  el  fichero se complica bastante.  Para evitarlo
basta usar un modelador que soporte RenderMan (cualquier modelador que
se     precie  deber&iacute;a   exportar     RIB's)  o    programar la
animaci&oacute;n  en C. Con  la distribuci&oacute;n de BMRT vienen los
<tt>includes</tt>   y   las   librerias  necesarias.  Son  simplemente
funciones que  sacan  por  la  salida  estandard  el  fichero  RIB. La
correspondencia entre las dos formas  es total: <tt>WorldBegin</tt> en
un fichero    RIB se corresponde   con  <tt>RiWorldBegin()</tt>  en un
programa C    (para  m&aacute;s  informaci&oacute;n  sobre  esto  leer
<I>RenderMan  for   Poets</I>  que  se   encuentra  en  el  directorio
<tt>doc/</tt>).

<A NAME="conclu"></A>
<H3>
<FONT FACE="Helvetica,Arial"><FONT COLOR="#660033">Conclusiones</FONT></FONT></H3>

El inteface  RenderMan es muy potente y  de hecho Toy Story esta hecho
as&iacute;&nbsp;(con un modelador que se  llama <I>marionet</I>).   En
<A  HREF="http://www.toystory.com">www.toystory.com</A> hay    algunos
n&uacute;meros sobre la pel&iacute;cula y algunas cosillas m&aacute;s.
La especificaci&oacute;n   del  interface la  pod&eacute;is  encontrar
en&nbsp;                                                            <A
HREF="http://giga.cps.unizar.es/prman/RISpec/index.html">giga.cps.unizar.es</A>.
Adem&aacute;s de la especificaci&oacute;n  hay un manual de PRMan  (el
renderizador     de    Pixar)  y       algunos   trabajos     de    <A
HREF="http://giga.cps.unizar.es">giga</A>
hechos con RenderMan.

<P> En  el   pr&oacute;ximo art&iacute;culo intentaremos   modelar  un
monigote,   lo  modelaremos     en   C  para      animarlo  m&aacute;s
f&aacute;cilmente   despu&eacute;s   y para   familiarizarnos  con  la
librer&iacute;a.  El monigote puede ser  el  pinguino de Linux o  Bill
Gate$  (o los  dos   y  hacemos que  el    pinguino lo fr&iacute;a   a
mamporros).
</TR>

<TR>
<TD></TD>
</TR>
</TABLE>

<HR size=2 noshade>
<p align=right>Artículo original en Castellano</p>

</TD>
</TR>

<TR>
<TD COLSPAN="2"><B>Más información en:</B>
<UL>
<LI>Otros artículos en este número <A HREF="http:article1.html">MindsEye: 3D Modeling</A>, 
<A HREF="http:article8.html">Pov-Ray: Nociones básicas</A></LI>
<p>
<LI>Otros artículos en números anteriores <A HREF="http:../March1998/article30.html">Comenzando con Povray</A>

<p>
<li>Página de BMRT  <A HREF="http://www.seas.gwu.edu/student/gritz/bmrt.html">http://www.seas.gwu.edu/student/gritz/bmrt.html</A>
<li>RenderMan Repository  <A HREF="http://rmr.spinne.com/">http://rmr.spinne.com/</A>
<li>Pixar <A HREF="http://www.pixar.com/">http://www.pixar.com/</A>
<li>GIGA (Grupo de Informatica Grafica Avanzada) <A HREF="http://giga.cps.unizar.es/prman/">http://giga.cps.unizar.es/prman/</A>
<li>La página de Tou Story <A HREF="http://www.toystory.com/ ">http://www.toystory.com/</A>
<p>

<li>Curso de RenderMan en PDF: <A HREF="http://rmr.spinne.com/KessonPDF/index.html">http://rmr.spinne.com/KessonPDF/index.html</a>

</UL>
<p>&nbsp;<p>
</TD>


 </TR>

 </TBODY>


 <TR bgcolor="#660033">
   <TD colspan="2" align="center"><FONT face="Helvetica,Arial" color="#FFFFFF"><B>
         &copy; 1998 Carlos Calzada Grau</B></FONT><BR>
    <FONT color="#ffffff">P&aacute;ginas web mantenida por
    <A href="mailto:angel@mercury.chem.pitt.edu"><FONT color="#ffffff">Miguel A Sepulveda</FONT></A></FONT>.
   </TD>
 </TR>



</TABLE>


</BODY>
</HTML>






