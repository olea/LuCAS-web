<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//ES">
<HTML>
<HEAD>
 <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <META NAME="GENERATOR" CONTENT="lfparser_0.6">
 <!-- lfparser can be obtained from http://www.linuxfocus.org/developer/Guido/lfparser.html -->
 <META NAME="LFCATEGORY" CONTENT="Software Development">
 <TITLE>Software Development : PostScript II: La pila de operandos, manipulaciones y operadores matem'atico</TITLE>
 
</HEAD>
<BODY bgcolor="#ffffff"  text="#000000" alink="#336633" link="#336633" vlink="#336633">
<MAP name="top">
  <AREA shape="rect" coords="367,9,418,30" alt="Hogar" href="../">
  <AREA shape="rect" coords="423,9,457,30" alt="Mapa" href="../map.html">
  <AREA shape="rect" coords="463,9,508,30" alt="Indice" href="../indice.html">
  <AREA shape="rect" coords="514,9,558,30" alt="Busqueda" href="../Search/">
</MAP>
<MAP name="bottom">
  <AREA shape="rect" coords="78,0,163,15" alt="Noticias" href="../News/">
  <AREA shape="rect" coords="189,0,284,15" alt="Arca" href="../Archives/">
  <AREA shape="rect" coords="319,0,395,15" alt="Enlaces" href="../Links/">
  <AREA shape="rect" coords="436,0,523,15" alt="Sobre LF" href="../aboutus.html">
</MAP>
<CENTER>
  <IMG src="../../common/images/Topbar-es.gif" width="600" height="40" border="0" alt="[Top bar]" ismap usemap="#top" ><BR>
  <IMG src="../../common/images/Bottombar-es.gif" width="600" height="21" border="0" alt="[Bottom bar]" ismap usemap="#bottom">
</CENTER>

<!-- SHORT BIO ABOUT THE AUTHOR -->
<TABLE ALIGN=LEFT BORDER=0 CELLSPACING=0 CELLPADDING=5 WIDTH="30%" >
<TR>
<TD><IMG SRC="../../common/images/thatsme.gif" ALT="[Photo of the Author]" HEIGHT=147 WIDTH=122>
<BR>por  <A HREF="mailto:">Emre Demiralp</A>
<BR><BR><I>Sobre el Author:</I><BR><p>

Soy un estudiante en el Istanbul American Robert College, y a la vez, uno
de los administradores del Computer Labs en la Faculty of Arts and
Sciences en la Istanbul Technical University. El sistema operativo que
domina sobre todos los demás en estos laboratorios es LINUX. Intereses:
PovRay y PostScript, animación, diseño de CDs, programación, holografía,
etc.. usuario de Linux desde 1994.

</p><P><FONT COLOR="#336633">Contenidos</FONT>:
<OL>
  <LI><A HREF="#lfindex0">Introducción</A></LI>
  <LI><A HREF="#lfindex1">Manipulación de la pila</A></LI>
  <LI><A HREF="#lfindex2">Operadores matemáticos</A></LI>
</OL>
</P>
</TD></TR></TABLE>
<!-- HEAD OF THE ARTICLE -->
<H2>PostScript II: La pila de operandos, manipulaciones y operadores matem'atico</H2>
 <IMG SRC="../../common/images/lfmeta.gif" ALT="[Ilustration]" HSPACE=10 HEIGHT=100 WIDTH=100><P><FONT COLOR="#336633">Resumen</FONT>:
<P>

      Gota a gota, se hace un lago
      -Proverbio Turco-.

El autor describe la pila de operandos del lenguaje PostScript. Se
presentan aquí las manipulaciones de la pila y los operadores
matemáticos. Este artículo no cubre todas las propiedades de la pila de
operandos. Los artículos siguientes continuarán hablando acerca de ello.
</P><HR size="2" noshade><BR>
<!-- BODY OF THE ARTICLE -->


<A NAME="lfindex0">&nbsp;</A>
<H2>Introducción</H2>


<p>
Este es el segundo de una serie de artículos acerca de PostScript. El
propósito principal de este artículo es comentar el manejo de la pila. La
pila de operandos es quizás la parte más importante de PostScript.
Asignaciones, operaciones aritméticas o matemáticas, bucles y operaciones
lógicas son manejadas en esta porción de memoria específica. ¡Sí! La pila
es una región especial de memoria que PostScript usa para ejecutar casi
cualquier cosa que nosotros queramos que PostScript haga. La pila
mantiene la información en orden de forma que el último dato introducido
sale primero. Puedes visualizar esto como una tubería con uno de sus
extremos cerrado. Cuando pones algo en esta tubería, empujará todos los
elementos que ya estaban en ella hacia el extremo cerrado para hacer
sitio para el mismo. Por lo tanto el último elemento en entrar será
siempre el más cercano al extremo abierto de la tubería. Los elementos en
la pila pueden ser cadenas de texto, constantes numéricas, claves,
bloques, ...  
</p>

<A NAME="lfindex1">&nbsp;</A>
<H2>Manipulación de la pila</H2>


<p>
A pesar de que los elementos se ordenan en la pila, hay algunas
operaciones de pila que nos permiten reordenar los elementos. Las
"manipulaciones" se aplican a uno o más de los elementos de la pila. Los
operadores, por definición, manipulan elemento(s) en la pila. Los
operadores pueden o no necesitar parámetros (operandos en la terminología
PostScript) dependiendo del caracter de la manipulación.  Si necesitan
el(los) parámetro(s) entonces estos deben ser apilados en la pila
primero. El operador toma acción entonces con respecto a estos
operandos..  Aquí se da una lista de estos operadores con las
explicaciones necesarias. Además se dan algunos ejemplos para ilustrarlo
con más detalle. 
<dl>
<dt><b>pop: </b></dt><dd>Este operador descarta el 
elemento que está en la cima de la pila de
operandos (el último en ser introducido).

<dt><b>exch: </b></dt><dd>Este operador intercambia los 
dos elementos que se encuentran en
las posiciones más elevadas de la pila de operandos. 

<dt><b>dup: </b></dt><dd>Este operador crea una copia del 
último elemento introducido en la
pila de operandos y lo apila en ella. En otras palabras, duplica el
elemento de más arriba de la pila. 

<dt><b>copy: </b></dt><dd>Este operador necesita un operando 
entero (parámetro) que se debe
introducir en la pila de operandos antes de que el operador actúe. Si le
llamamos <tt>n</tt> a este parámetro entero, entonces el comando será <tt>n copy</tt>.
Cuando se ejecuta el comando, se realiza una copia de los <tt>n</tt> elementos de
la cima (los últimos en ser introducidos) y se colocan en la pila de
operandos como los últimos elementos introducidos. En otras palabras,
<tt>copy</tt> es un operador de duplicación de conjuntos. 

<dt><b>index: </b></dt><dd>Este operador necesita un operando entero que se debe introducir
en la pila de operandos antes de que el operador actúe. Si llamamos <tt>n</tt> a
ese parámetro entero entonces el comando se introducirá como <tt>n index</tt>.
Cuando esto se ejecuta, se crea una copia de los <tt>n</tt> elementos de las
posiciones superiores de la pila (los últimos en ser introducidos) y se
situa en la pila de operandos como los últimos elementos en ser
introducidos. En otras palabras, <tt>index</tt> puede seleccionar un elemento
interno y crear y situar una copia en la pila de operandos. El indexado
de elementos empieza a partir del elemento de más arriba (él último) con
el número <tt>0</tt>. 

<dt><b>roll: </b></dt><dd>Este operador necesita dos parámetros enteros que se deben
introducir en la pila de operandos antes de que el operador actúe. Si
llamamos <tt>m</tt> y <tt>n</tt> a esos dos parámetros enteros entonces el comando será
introducido como <tt>m n roll</tt>. Aquí <tt>m</tt> denota cuantos 
elementos serán rotados
mientras <tt>n</tt> indica el número de rotaciones. Una rotación se define de
manera que el elemento de más arriba de la pila de operandos llega a ser
el elemento <tt>m</tt>-esimo mientras el conjunto de <tt>m-1</tt> elementos bajo el
elemento de la cima son desplazados un lugar hacia la cima. Este esquema
es válido cuando <tt>n</tt> es igual a 1. Si fuese 2 entonces ocurrirían dos
rotaciones consecutivas. En otras palabras <tt>m 2 roll</tt> 
es lo mismo que <tt>m 1 roll m 1 roll</tt>. 
El parámetro <tt>n</tt> puede tomar valores negativos. Si esto
ocurre, se invierte la acción que ocurre cuando <tt>n</tt> es positivo. Esto
significa que el efecto global del comando <tt>m n roll m -n roll</tt> es neutro.
Esto deja la pila de operando sin cambio alguno. El indexado de los
elementos empieza por el elemento de la cima que se considera que ocupa
la posición <tt>0</tt>. 

<dt><b>clear: </b></dt><dd>Este operador descarta todos los elementos de la pila de
operandos. 

<dt><b>count: </b></dt><dd>Este operador cuenta los elementos de la 
pila de operandos. El
resultado se apila en la pila de operandos como un elemento nuevo. Si no
quieres este nuevo elemento entonces puedes formar el comando compuesto
<tt>count pstack pop</tt> donde </t>pop</tt> elimina el nuevo 
elemento que <tt>count</tt> ha creado
después de que el resultado del conteo sea visualizado a través de la
actuación del operando de fichero <tt>pstack</tt>.  

<dt><b>mark: </b></dt><dd>Este operador coloca un elemento 
<tt>-marktype-</tt> en la pila de
operandos. Este elemento se puede usar para dividir el conjunto de
elementos de la pila de operandos en subconjuntos. Hay otras dos
operaciones <tt>cleartomark</tt> y <tt>counttomark</tt> 
que buscan este elemento para sus
acciones. Si no lo encuentran emiten un mensaje de error. 

<dt><b>cleartomark: </b></dt><dd>Este operador elimina todos los elementos desde el que está
en la cima hasta el primer <tt>-marktype-</tt>. Este objeto 
<tt>-marktype-</tt> se elimina
también. Si no hay ningún objeto marktype en la pila de operandos, se
emite un mensaje de error. 

<dt><b>counttomark: </b></dt><dd>Este operador cuenta todos lo elementos 
empezando desde el
elemento de la cima hasta encontrar el objeto <tt>-marktype-</tt>. El resultado que
es un valor entero se apila en la pila de operandos como el último
elemento. El primer elemento <tt>-marktype-</tt> no se incluye en el resultado. Si
no hay ningún elemento marktype en la pila de operandos PostScript
informa el error y no hace nada. 
</dl>
</p>

<p>
Permitenos decir algo ahora acerca de la pila. Si quieres ver en acción a
los operadores anteriores, debes activar primero el interprete
Postscript. Como se mencionó en el primer artículo, en el mundo Linux se
usa un interprete disponible publicamente, de nombre <tt>ghostscript</tt>.
Ghostscript puede activarse de diferentes maneras mediante el paso de los
parámetros apropiados en la linea de comandos. La forma habitual de
hacerlo es teclear <tt>gs</tt> en el entorno X Window. A veces puede que no
funcione debido a algún problema de configuración en X. Se visualizará un
mensaje de error acerca de la incapacidad de crear un consola gráfica.
Entonces o bien solucionas esos problemas o puedes forzar a ghostscript a
usar el dispositivo <tt>x11</tt>. Para conseguirlo debes teclear 
<tt>gs -sDEVICE=x11</tt>.
Tanto esto como un simple <tt>gs</tt> (si esto último funciona) crea un ventana
vacía con el fondo blanco que se usará para los mensajes que se crearán
durante la sesión. Dado que los mensajes (displays) no se tratan en este
artículo no necesitamos esta ventana y es posible librarse de ella. Para
ello, se puede activar el interprete ghostscript sin displays tecleando
el parámetro <tt>-dNODISPLAY</tt> en la linea de comandos después de
<tt>gs</tt> o de <tt>gs -sDEVICE=x11</tt>. 
Si se hace esto, se visualizará una cabecera de copyright
seguida del prompt de ghostscript <tt>GS&gt;</tt> al principio de una nueva linea. En
este punto, ghostscript está preparado para tus comandos. La pila de
operandos está vacía.
</p>

<p>
Para ver el contenido de la pila de operandos puedes usar el operador de
fichero <tt>pstack</tt>. Se le llama operador de fichero porque envía información
acerca del contenido de la pila al fichero de salida estandar que por
defecto es la pantalla. Si introduces este comando en el prompt no se
visualiza nada y un nuevo prompt <tt>GS&gt;</tt> aparecerá al principio de una nueva
linea. Esto significa que la pila de operandos está vacía. 
</p>

<p>
Para introducir elementos en la pila de operandos puedes teclear los
elementos en el prompt. Por ejemplo si quieres introducir <tt>1</tt> como un
elemento, solo tienes que teclear <tt>1</tt> en el prompt. Después de esto se crea
un nuevo prompt al principio de la linea siguiente. Pero, ahora, el
prompt no es <tt>GS&gt;</tt>. Es <tt>G&lt;1&gt;</tt>. 
Esta nueva forma de prompt refleja el número
de elementos en la pila de operandos. De modo que, si tu tienes <tt>GS&lt;123&gt;</tt>
en cualquier momento en tu sesión ghostscript esto significa que hay 123
elementos en la pila de operandos. 
</p>

<p>
Puedes introducir más de un elemento en la pila de operandos de un solo
paso. Para ello, debes teclear todos los elementos consecutivamente, pero
separados por un espacio en blanco. Por ejemplo, si tu tecleas 
<tt>1 2 3 4 5 6</tt>
 en el prompt, los elementos <tt>1, 2, 3, 4, 5, 6</tt>, 
se apilarán en la pila de
operandos respectivamente. Si ejecutas <tt>pstack</tt> después de esto, entonces
los elementos se visualizarán en orden vertical de forma que el último
elemento introducido se visualiza primero. La visualización de esta
sesión de dos comandos puede quedar como sigue: 
<PRE>
GS&gt;1 2 3 4 5 6 G&lt;6>pstack
6
5
4
3
2
1
G&lt;6&gt;
</PRE>

<p>
También es posible introducir elementos en la pila de operandos y ver el
contenido de la pila en un solo paso. Todo lo que tienes que hacer es
añadir el comando <tt>pstack</tt> después de los elementos a ser introducidos. Por
tanto: 
<pre>
GS&gt;1 2 3 4 5 6 pstack6
5
4
3
2
1
G&lt;6&gt;
</pre>
</p>

<p>
Hasta ahora hemos usado números para introducir elementos. Los números no
son el único tipo de elementos, es posible introducir otros tipos de
elementos como variables o claves, cadenas de texto, bloques, etc. Los
trataremos más tarde en detalle. De todas maneras hay algo que debemos
decir:&nbsp; si intentas introducir por ejemplo, un solo caracter <tt>a</tt> o una
cadena <tt>abc</tt> se emitirá un mensaje de error. Esto es debido a que
PostScript no puede entender estas cosas. Si quieres introducir un
caracter o una cadena tienes que encerrarlo mediante los símbolos ().
Aquí hemos hablado también acerca de un tipo especial de elemento que se
llama marktype. Para ver todo esto podemos dar la siguiente sesión de
ejemplo: 
<pre>
GS&gt;1 2 3 mark 4 5 6 pstack6
5
4
-marktype-
3
2
1
G&lt;7&gt;
</pre>
</p>

<p>
Ahora vamos a ver algunos ejemplos de las operadores que manipulan la
pila de operandos. Daré una sesión para mostrar como actuan estos
operadores y me gustaría cerrar esta sección sin más explicaciones. 
<pre>
GS&gt;1 2 3 mark 4 5 6 pstack6
5
4
-marktype-
3
2
1
G&lt;7&gt;pop pstack
5
4
-marktype
3 
2
1
G&lt;6&gt;exch pstack
4
5
-marktype
3
2
1
G&lt;6&gt;dup pstack
4
4
5
-marktype-
3
2
1
G&lt;7&gt;2 copy pstack
4
4
4
4
5
-marktype
3
2
1
G&lt;9&gt;5 index pstack
-marktype-
4
4
4
4
5
-marktype
3
2
1
G&lt;10&gt;cleartomark cleartomark pstack
3
2
1
G&lt;3&gt;3 1 roll pstack
2
1
3
G&lt;3&gt;count pstack
3
2
1
3
G&lt;4&gt;mark 7 8 pstack
8
7
-marktype-
3
2
1
3
G&lt;7&gt;counttomark pstack
2
8
7
-marktype-
3
2
1
3
G&lt;8&gt;clear pstack
GS&gt;
</pre>
</p>

<A NAME="lfindex2">&nbsp;</A>
<H2>Operadores matemáticos</H2>


<p>
Aparte de los operadores de manipulación de la pila de operandos de
PostScript hay algunos operadores aritméticos y matemáticos. Más abajo se
dan estos operadores. No habrá ejemplos. Esto se deja en manos del lector
que debería ser capaz de crearlos, después de haber estudiado las
sesiones de ejemplo de arriba.
<dl>
<dt><b>add: </b></dt><dd>Este comando necesita dos parámetros numéricos cuyos valores se
suman. Si llamamos <tt>m</tt> y <tt>n</tt> a estos valores, entonces el comando 
sería <tt>m n add</tt>. Al ejecutarlo se introducen primero 
<tt>m</tt> y después <tt>n</tt> en la pila de
operandos. La fase final es al ejecución del operador <tt>add</tt> sobre los dos
operandos de la cima de la pila. Esto crea un nuevo elemento cuyo valor
es la suma de <tt>m</tt> y <tt>n</tt>. Una vez finalizada la operación 
<tt>m</tt> y <tt>n</tt> desaparecen de
la pila. En su lugar, el resultado llega a ser el elemento de la cima de
la pila de operandos.

<dt><b>div: </b></dt><dd>Este comando necesita dos parámetros numéricos 
que serán los que se
usarán en la operación de división. Sean estos parámetros, <tt>m</tt> y <tt>n</tt>, la
instrucción sería <tt>m n div</tt>. La mecánica de la operación es la misma que la
de la operación <tt>add</tt>. La operación de división trabaja a nivel de
aritmética de punto flotante. Después de que finaliza la operación solo
queda en la pila de operandos el resultado de la operación de división
como un nuevo elemento. <tt>m</tt> y <tt>n</tt> desaparecen.

<dt><b>idiv: </b></dt><dd>Este comando necesita dos parámetros numéricos 
que se usarán en la
operación de división entera. Sean estos parámetros, 
<tt>m</tt> y <tt>n</tt>, la
instrucción sería <tt>m n idiv</tt>. Todo funciona como en el 
caso de <tt>div</tt> excepto
por la división misma. En este caso se trata de una división que funciona
en el nivel de la aritmética entera. También funcionará aunque los
parámetros no sean enteros.

<dt><b>mod: </b></dt><dd>Este comando necesita dos parámetros enteros. 
Obtiene el resto de
dividir el primer parámetro entre el segundo. Si cualquiera de los
parámetros no es entero la operación falla. Al final lo único que queda
en la pila de operandos es el resultado de la operación, no los
parámetros.

<dt><b>mul: </b></dt><dd>Igual que add, div. Es un operador binario que necesita dos valores
numéricos. El resultado es la multiplicación de los parámetros y se
mantiene en la pila de operandos como un nuevo elemento.

<dt><b>sub: </b></dt><dd>Igual que add, div, mul. La única diferencia es el tipo de
operación. En operador resta el valor del segundo parámetro del valor del
primero. Tanto los parámetros como el resultado son valores numéricos y
el resultado queda en la pila de operandos después de que la operación ha
finalizado.

<dt><b>exp: </b></dt><dd>Este es un operador matemático binario. Necesita dos parámetros. El
primero es la base y el segundo el exponente. Eleva el valor de la base a
la potencia cuyo valor es el exponente. Los parámetros deben estar dentro
de los límites de la operación de exponenciación. El resultado es un
número en punto flotante que queda como un nuevo elemento de la pila de
operandos.

<dt><b>atan: </b></dt><dd>Este es otro operador matemático binario, en este caso para evalúa
un ángulo. El ángulo se da en grados entre <tt>0</tt> y <tt>360</tt>. Se necesitan dos
parámetros. La razón del primer parámetro al segundo es igual a la
tangente del ángulo a ser evalúado. Cualquiera de los parámetros puede
ser 0 pero no ambos. Los signos de los parámetros determinan el cuadrante
donde el resultado yace. Los valores positivos en el primer parámetro
corresponden a planos <tt>y</tt> positivos. Por otro lado, los valores positivos
en el segundo parámetro indican planos <tt>x</tt> positivos.

<dt><b>abs: </b></dt><dd>Este es un operador matemático unario. Necesita un solo parámetro
cuyo valor absoluto es el resultado de la operación. De forma similar a
lo visto arriba, el resultado permanece en la pila como un nuevo
elemento.

<dt><b>neg: </b></dt><dd>Cambia el signo de su único parámetro. Es un operador aritmético
unario.

<dt><b>ceiling: </b></dt><dd>Es un operador unario cuyo valor es el entero más cercano por
arriba al parámetro que recibe.

<dt><b>floor: </b></dt><dd>Es un operador unario cuyo valor es el entero más cercano por
abajo al parámetro que recibe.

<dt><b>round: </b></dt><dd>Es un operador unario cuyo valor es el entero más cercano al
parámetro que recibe.

<dt><b>truncate: </b></dt><dd>Es un operador unario que elimina la parte decimal de su
parámetro.

<dt><b>sqrt: </b></dt><dd>Es un operador unario cuyo valor es la raíz cuadrada (square root)
de su parámetro.

<dt><b>cos: </b></dt><dd>Es un operador unario cuyo valor es el coseno de su parámetro. El
parámetro debe estar en grados.

<dt><b>sin: </b></dt><dd>Es un operador unario cuyo valor es el seno de su parámetro. El
parámetro debe estar en grados.

<dt><b>ln: </b></dt><dd>Es un operador unario cuyo valor es el logaritmo natural de su
parámetro.

<dt><b>log: </b></dt><dd>Es un operador unario cuyo valor es el logaritmo en base 10 de su
parámetro.
</dl>
</p>

<p>
Antes de terminar este artículo una nota más. Si bien se ha mencionado
arriba, quizás de forma implícita, los parámetros (operandos en la
terminología PostScript) de un comando pueden crear algunos problemas
desagradables. El comando (u operador en la terminología PostScript)
busca sus parámetros en la pila de operandos. Cuando se encuentran el
comando los usa y son borrados de la pila de operandos. De manera que
ejecutar, a propósito o por error, un comando que necesita parámetro(s)
sobre una pila de operandos sin valores para ellos, puede provocar bien
una notificación sobre los parámetros que están el cima de la pila si
estos no son válidos para el tipo de parámetro requerido, o que alguno(s)
de los elementos de la pila de operandos sean eliminados. Por tanto el
usuario debe tener mucho cuidado con esto.
</p>

<p>
Antes de finalizar esta presentación recomendamos escribir programas más
complicados y completos a los usuarios que quieran avanzar con el
lenguaje PostScript. Todas las preguntas y comentarios son bienvenidos.
</p>




<HR size="2" noshade>
<!-- ARTICLE FOOT -->
<CENTER><TABLE WIDTH="95%">
<TR><TD ALIGN=CENTER BGCOLOR="#777777">
<A HREF="../../common/lfteam.html"><FONT COLOR="#FFFFFF">Contactar con el equipo de LinuFocus</FONT></A>
<BR><FONT COLOR="#FFFFFF">&copy; Emre Demiralp <BR>LinuxFocus 1999</FONT></TD>
<TD BGCOLOR="#777777"><!-- TRANSLATION INFO -->
<font size=2>Translation information:</font><TABLE>
<tr><td><font size=2>en</font></td>
    <td><font size=2>-&gt;</font></td>
    <td><font size=2>--</font></td>
    <td><font size=2><a href="mailto:"><FONT COLOR="#FFFFFF">Emre Demiralp</FONT></a></font></td>
</tr>
<tr><td><font size=2>en</font></td>
    <td><font size=2>-&gt;</font></td>
    <td><font size=2>es</font></td>
    <td><font size=2><a href="mailto:"><FONT COLOR="#FFFFFF">David Abilleira Freijeiro</FONT></a></font></td>
</tr>
<tr><td><font size=2>en</font></td>
    <td><font size=2>-&gt;</font></td>
    <td><font size=2>en</font></td>
    <td><font size=2><a href="mailto:"><FONT COLOR="#FFFFFF">Jorge M. Paulo y Jose Quesada</FONT></a></font></td>
</tr>
</TABLE></TD>
</TR></TABLE></CENTER>
<p><font size=1>1999-07-02, generated by lfparser version 0.6</font></p></BODY></HTML>
