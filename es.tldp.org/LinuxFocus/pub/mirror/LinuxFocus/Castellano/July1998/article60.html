<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML lang="es">

<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>LinuxFocus Julio 1998: A&ntilde;adiendo Seguridad a una Distribuci&oacute;n Linux</TITLE>
</HEAD>

<BODY bgcolor="#FFFFFF"  text="#000000" alink="#336633" link="#336633" vlink="#336633">

<!-- MAP for top navegation bar -->
<MAP name="top">
<AREA shape="rect" coords="367, 9, 418, 30" alt="Home" href="../">
<AREA shape="rect" coords="423, 9, 457, 30" alt="Map" href="../map.html">
<AREA shape="rect" coords="463, 9, 508, 30" alt="Index" href="../indice.html">
<AREA shape="rect" coords="514, 9, 558, 30" alt="Search" href="../search.html">
</MAP>

<!-- MAP for bottom navegation bar -->
<MAP name="bottom">
<AREA shape="rect" coords="78, 0, 163, 15"   alt="News" href="../News/">
<AREA shape="rect" coords="189, 0, 284, 15"  alt="Archives" href="../Archives/">
<AREA shape="rect" coords="319, 0,  395, 15" alt="Links" href="../Links">
<AREA shape="rect" coords="436, 0,  523, 15" alt="About LF" href="../aboutus.html">
</MAP>

<CENTER>
<IMG src="../../common/images/../../common/images/Topbar-es.gif" width="600" height="40" border="0" alt="[Top Bar]" ismap usemap="#top"><BR>
<IMG src="../../common/images/../../common/images/Bottombar-es.gif" width="600" height="21" border="0" alt="[Bottom Bar]" 
ismap semap="#bottom">
</CENTER>

<!-- BREVE BIO DEL AUTOR -->
<TABLE  align="left" width="30%" border="0" cellspacing="0" cellpadding="5">
<TR>
 <TD>
   <IMG src="../../common/images/Michael-J.gif" width="173" height="164" alt="[Foto del autor]"><BR>

   <FONT color="#336633" size="+2"> Michael Jastremski </FONT><BR>

   <FONT  color="#336633">Sobre el autor</FONT>: Michael Jastremski ha
   estado hackeando Unix durante los &uacute;ltimos  cuatro a&ntilde;os.  Su website
   puede                encontrarse                en               <a
   href="http://westphila.net/mike">http://westphila.net/mike</a>.
   Agradece  a  Andrew  <andy@westphila.net>  por   ayudarle  con   su
   ingl&eacute;s.


<P><A href="mailto:mike@westphila.net">Escribe al autor.</A></P>


<!--   INDEX      -->
<FONT color="#336633">Contenido</FONT>: <BR>
<A href="#section1">Introducci&oacute;n</A><BR>
<A href="#section2">Pasos para la seguridad</A><BR>

 </TD>
</TR>

</TABLE>
<TABLE>

<TR>
<TD>

<!--   BODY OF THE ARTICLE    -->
<H2> 
A&ntilde;adiendo Seguridad a una Distribuci&oacute;n de Linux
</H2>

<IMG src="../../common/images/illustration37.gif" width="100" height="100" hspace="10" alt="[Ilustracion]">

<P align="top">
<FONT color="#336633" size="2">Pr&oacute;logo</FONT>:
<FONT size="2" face="Helvetica,Arial,Roman">
Este  art&iacute;culo discute  las maneras que  tieme un administrador
para asegurar su sistema contra los  instrusos. Trata varias formas de
mejorar la seguridad de los sistemas Linux.
</FONT>
</P>
<BR clear="all">
<BR>
<HR size="0" noshadow>

<A name="section1"></A>
<H3>Introducci&oacute;n</H3>

<p>
&Uacute;ltimamente  se est&aacute;n volviendo habituales los esfuerzos
a  gran  escala   para  sabotear los   ordenadores  de  internet.  Los
servidores con  Linux y FreeBSD se han  convertido en  blanco de estos
ataques, utilizando desbordamientos de  buffer en los fuentes de imapd
y BIND.  Cada   d&iacute;a,   vulnerabilidades  de todas   formas    y
tama&ntilde;os se reparten entre  los casi 20.000 subscriptores de  la
lista                 de               correo                       <a
href="http://www.lsoft.com/scripts/wl.exe?SL1=BUGTRAQ&H=NETSPACE.ORG">BUGTRAQ</A>
(si solo  te   subscribes  a  una  lista de  correo  sobre  seguridad,
deber&iacute;a ser esta).

<p>
Ser&iacute;a   sensato asumir  que   al menos    uno  de  esos  19.305
subscriptores    vaya a   escribir  un  bucle   for()   y  un  poco de
l&oacute;gica alrededor de un 'exploit' cut+paste con las esperanza de
lograr acceso ileg&iacute;timo a tantos ordenadores como sea posible.

<p>
Tarde o temprano, el bucle construir&aacute; la direcci&oacute;n de tu
ordenador.    Cuando   llegue   ese momento     deber&iacute;as  estar
preparado.<p>A  pesar de  lo   que algunos "expertos"  puedan  hacerte
creer,  instalar   y   mantener  un   ordenador  seguro  no   es  algo
d&iacute;ficil.  Algunas    pr&aacute;cticas  bien   conocidas      en
administraci&oacute;n de sistemas sirven como protecci&oacute;n de las
amenazas  de la red  global. Este art&iacute;culo  describe algunas de
las precauciones que generalmente  tomo  cuando configuro un   sistema
Linux RedHat conectado a  la  red. Aunque este art&iacute;culo  provee
pautas para  proteger tu ordenador de  los intentos malvados de otros,
no intenta ser una referencia completa.

<p>
Los siguientes  son  algunos  pasos    que evitar&aacute;n   que    tu
instalaci&oacute;n caiga  v&iacute;ctima  del   pr&oacute;ximo   hueco
p&uacute;blico en tu software  de red. ADVERTENCIA: Si no est&aacute;s
absolutamente seguro de  lo que haces, no  lo hagas. Algunos  de estos
pasos asumen un moderado  grado de experiencia por  tu parte. Al final
dar&eacute; la bibliograf&iacute;a recomendada.

<p>
<A name="section2"></A>
<b>Pasos para la seguridad</b>

<p><b>1.</b> Quita todos  lo servicios de  red que no necesites. Menos
maneras de conectarse a tu ordenador significan menos oportunidades de
que un intruso penetre en &eacute;l.  Comenta todo lo que no necesites
en <tt>/etc/inetd.conf</tt>.  ¿No necesitas hacer telnet a tu sistema?
Inhabilitalo. Lo mismo  para <tt>ftpd, rshd, rexecd, gopher,  chargen,
echo, pop3d</tt>  y similares.  No  olvides hacer un '<tt>killall -HUP
inetd</tt>'    despu&eacute;s       de        editar  el       fichero
<tt>inetd.conf</tt>.           Tampoco    descuides el      directorio
<tt>/etc/rc.d/init.d</tt>. Algunos servicios de red (BIND, demonios de
impresoras) son programas que se inician desde estos scripts.

<p><b>2.</b> Instala SSH. SSH  es un sustituto para  la mayor&iacute;a
de  esos viejos  comandos    '<tt>r'</tt> de  Berkely.  Lo   siguiente
est&aacute;   estra&iacute;do      de      la p&aacute;gina   en    <a
href="http://www.cs.hut.fi/ssh">http://www.cs.hut.fi/ssh</a>:

<p>
<font size=+1 color="#FF6600"> Ssh (Secure  Shell) es un programa para
conectarse a otro ordenador en una red,  para ejecutar comandos en una
m&aacute;quina remota,  y para mover archivos  de una m&aacute;quina a
otra.  Proporciona  autentificaci&oacute;n fuerte  y    comunicaciones
seguras sobre canales inseguros.  </font></p>

<p>
Tambi&eacute;n realiza muchas otras cosas que cualquier aspirante a
hacker encontrar&aacute; interesantes.  B&aacute;jate el SSH desde <a
href="http://ftp.rge.com/pub/ssh">http://ftp.rge.com/pub/ssh</a>.

<p><b>3.</b> Usa <tt>vipw(1)</tt> para bloquear las cuentas sin acceso
a login. F&iacute;jate que en RedHat Linux,  las cuentas con un nombre
de shell nulo inician sesi&oacute;n con la shell <tt>/bin/sh</tt>, que
probablemente no  es   lo que  quieres.  Tambi&eacute;n asegurate  que
ninguna de tus cuentas tenga password nulo. El siguiente es un ejemplo
de como ser&iacute;a la parte de sistema de un fichero passwd correcto
y seguro:

<p>
<font size=-1>
<pre>
daemon:*:2:2:daemon:/sbin:/bin/sync
adm:*:3:4:adm:/var/adm:/bin/sync
lp:*:4:7:lp:/var/spool/lpd:/bin/sync
sync:*:5:0:sync:/sbin:/bin/sync
shutdown:*:6:0:shutdown:/bin:/sync
halt:*:7:0:halt:/sbin:/bin:/sync
mail:*:8:12:mail:/var/spool/mail:/bin/sync
news:*:9:13:news:/var/spool/news:/bin/sync
uucp:*:10:14:uucp:/var/spool/uucp:/bin/sync
operator:*:11:0:operator:/root:/bin/sync
games:*:12:100:games:/usr/games:/bin/sync
gopher:*:13:30:gopher:/usr/lib/gopher-data:/bin/sync
ftp:*:14:50:FTP User:/home/ftp:/bin/sync
nobody:*:99:99:Nobody:/:/bin/sync
</pre>
</font>

<p><b>4.</b> Quita los bits 's' de  los programas cuyo propietario sea
el root y que  no precisen de  tal privilegio. Esto se hace ejecutando
el  comando  '<tt>chmod a-s</tt>'  con  el   nombre  o nombres de  los
archivos involucrados como argumentos.

<p>
Tales programas son (pero la lista no est&aacute; completa):

<p><ol>
        <LI> programs que nunca uses

        <LI> programas que no  quieres que un  usuario que no sea root
        los use

        <LI> programas que uses ocasionalmente,  y no te importe tener
        que hacer un su(1) a root para ejecutarlos
</ol>

<p>
He    colocado un  asterisco   (*)  al   lado de   cada  programa  que
personalmente inhabilitar&iacute;a.   Recuerda que tu sistema necesita
algunos  programas  con    suid  root  para trabajar    perfectamente,
as&iacute; que ten cuidado.

<p>
Alternativamente,  podr&iacute;as  crear  un   grupo  especial llamado
'<tt>suidexec</tt>', poner los  usuarios en los que conf&iacute;as  en
este  grupo,  <tt>chgrp(1)</tt> el programa   o  programas dudosos que
precisen del suid  bit al grupo suidexec,  y quitarle los  permisos de
ejecuci&oacute;n global.


<pre>     
# find / -user root -perm "-u+s"
</pre>
<table valign=top border=1 rules=cols>
<tr><th> Comando </th><th> Comentario</th>
<tr> 
<td>
*/bin/ping<td> </td><td>&nbsp;</td>
</tr><tr><td>
*/bin/mount  </td><td>             s&oacute;lo el root deber&iacute;a montar sistemas de ficheros
</tr><tr><td>
*/bin/umount </td><td>             idem
</tr><tr><td>
/bin/su       </td><td>            ¡no toques este!
</tr><tr><td>
/bin/login </td><td> &nbsp; </td>
</tr><tr><td>
/sbin/pwdb_chkpwd </td><td> &nbsp; </td>
</tr><tr><td>
*/sbin/cardctl  </td><td>          utilidad de control para tarjetas PCMCIA
</tr><tr><td>
*/usr/bin/rcp </td><td>            Usa ssh
</tr><tr><td>
*/usr/bin/rlogin    </td><td>      idem
</tr><tr><td>
*/usr/bin/rsh    </td><td>          "
</tr><tr><td>
*/usr/bin/at    </td><td>          usa cron, o inhabilitalo del todo
</tr><tr><td>
*/usr/bin/lpq      </td><td>       instala LPRNG
</tr><tr><td>
*/usr/bin/lpr </td><td>            "
</tr><tr><td>
*/usr/bin/lprm  </td><td>          "
</tr><tr><td>
*/usr/bin/mh/inc </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/bin/mh/msgchk </td><td> &nbsp; </td>
</tr><tr><td>
/usr/bin/passwd</td><td>           ¡no tocar!
</tr><tr><td>
*/usr/bin/suidperl </td><td>       cada nueva versi&oacute;n de suidperl parece tener un desbordamiento del buffer
</tr><tr><td>
*/usr/bin/sperl5.003 </td><td>     &uacute;salo solo si es necesario
</tr><tr><td>
/usr/bin/procmail </td><td>       &nbsp; </td>  
</tr><tr><td>
*/usr/bin/chfn </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/bin/chsh </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/bin/newgrp </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/bin/crontab </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/X11R6/bin/dga </td><td>      muchos desbordamientos de buffer como en X11
</tr><tr><td>
*/usr/X11R6/bin/xterm </td><td>    "
</tr><tr><td>
*/usr/X11R6/bin/XF86_SVGA </td><td>   "
</tr><tr><td>
*/usr/sbin/usernetctl </td><td> &nbsp; </td>
</tr><tr><td>
/usr/sbin/sendmail </td><td> &nbsp; </td>
</tr><tr><td>
*/usr/sbin/traceroute </td><td>    puedes soportar escribir el password de root de vez en cuando
</tr></table>

<p><b>5.</b> Actualiza el sendmail. Baja el c&oacute;digo fuente de <a
href="ftp://ftp.sendmail.org/pub/sendmail">ftp://ftp.sendmail.org/pub/sendmail</a>.
Desempaquetalo y lee las instrucciones.  Instala el smrsh (empaquetado
con  sendmail) si   tienes un par   de  minutos extras, este  programa
soluciona muchas de las cosas que interesan a  la mayor&iacute;a de la
gente  sobre  el  sendmail,  tales   como  enviar  emails a  programas
arbitrarios.     Edita   sendmail.cf    y    pon   la    opci&oacute;n
'<tt>PrivacyOptions</tt>' en '<TT>goaway</tt>':

<pre>
        O PrivacyOptions=goaway
</pre>

<p>
Si  no  tienes  previsto  recibir correo  de   internet,  ¡NO EJECUTES
SENDMAIL EN EL  MODO DE RECEPCI&Oacute;N  (<tt>sendmail -bd</tt>)!. En
este caso,  deshabilita <tt>/etc/rc.d/init.d/sendmail.init</tt>  y haz
un '<tt>killall -TERM sendmail</tt>'. Con esto a&uacute;n ser&aacute;s
capaz de enviar email, pero no de recibir.

<p><b>6.</b>   Actualiza    BIND  si   lo    usas.   La  &uacute;ltima
versi&oacute;n     de     BIND  la      puedes     encontrar   en   <a
href="http://www.isc.org">http://www.isc.org</a>  .  Si   no lo   usas
deshabilitalo del todo.

<p><b>7.</b> Recompila el kernel. Generalmente lo hago para reducir el
tama&ntilde;o  del  kernel  por  defecto.  CONSEJO:  Activa todas  las
opciones de firewall incluso si tu ordenador no es un firewall.

<pre>
CONFIG_FIREWALL=y
CONFIG_NET_ALIAS=y
CONFIG_INET=y
# CONFIG_IP_FORWARD is not set
# CONFIG_IP_MULTICAST is not set
CONFIG_SYN_COOKIES=y
CONFIG_RST_COOKIES=y
CONFIG_IP_FIREWALL=y
CONFIG_IP_FIREWALL_VERBOSE=y
# CONFIG_IP_MASQUERADE is not set
# CONFIG_IP_TRANSPARENT_PROXY is not set
CONFIG_IP_ALWAYS_DEFRAG=y
CONFIG_IP_ACCT=y
# CONFIG_IP_ROUTER is not set
# CONFIG_NET_IPIP is not set
CONFIG_IP_ALIAS=m
</pre>

<p>
<b>8.</b> Aplica los  parches:   Cualquier problema conocido  con   el
software de RedHat se puede encontrar en  las p&aacute;ginas de Errata
de                         RedHat.               (ver               <a
href="http://www.redhat.com/support/docs/errata.html">
http://www.redhat.com/support/docs/errata.html  </a>    para     saber
qu&eacute; parches puedes aplicar a tu versi&oacute;n). RedHat hace un
excelente trabajo  de mantenimiento para mantener estas p&aacute;ginas
actualizadas.  Estas  p&aacute;ginas incluyen tambi&eacute;n enlaces a
los archivos  RPM que necesitar&aacute;s,  junto con  instrucciones de
instalaci&oacute;n.

<p>
<b>9.</b>     Configura   tcp_wrappers:  Los   tcp_wrappers   son   un
m&eacute;todo  para controlar qu&eacute;  ordenadores en la red tienen
permiso para hablar   con el   tuyo. Este   paquete,  escrito  por  el
gur&uacute; en seguridad  Wieste Venema,  se coloca  en frente de  los
programas que se ejecutan desde el  inetd (o aquellos enlazados con su
biblioteca)  consultando  sus  archivos  de  configuraci&oacute;n para
determinar  si deben negar  o   permitir una trasancci&oacute;n en  la
red. Por ejemplo, para permitir telnet y  ftp desde tu casa v&iacute;a
un   ISP, no permitiendo  nada   m&aacute;s,  coloca lo siguiente   en
<tt>/etc/hosts.allow</tt>:

<pre>
        in.ftpd : .dialup.tu-isp.com : allow 
        all : all : deny 
</pre>

<p>
SSH, sendmail  y otros  paquetes  pueden construirse con  soporte para
tcp_wrappers.  Lee la  p&aacute;gina <tt>tcpd(1)</tt> del  manual para
m&aacute;s informaci&oacute;n.

<p>
<b>Bibliograf&iacute;a</b>

<p>Parches de seguridad para Linux por Solar Designer:<BR>
<a href="http://www.false.com/security/linux/">http://www.false.com/security/linux/</a><br><br>

P&aacute;ginas de cryptograf&iacute;a para RedHat de replay.com: <br>
<a href="http://www.replay.com/redhat/">http://www.replay.com/redhat/</a><br><br>

Mejora la Seguridad de tu Site introduci&eacute;ndote en &eacute;l:<BR>
<a href="http://www.alw.nih.gov/Security/Docs/admin-guide-to-cracking.101.html"> 
<font size=-1>http://www.alw.nih.gov/Security/Docs/admin-guide-to-cracking.101.html</font></a><br><br>

Slashdot es una buena fuente de noticias actualizadas:<br>
<a href="http://www.slashdot.org">http://www.slashdot.org</a><br><br>

Para estar al tanto en actualizaciones de software, visita FreshMeat regularmente:<br>
<a href="http://www.freshmeat.net">http://www.freshmeat.net</a><br><br>

Extraordinario: <br>

<a href="http://reality.sgi.com/nate/machines/security/P49-14-Aleph-One"> 
<font size=-1>http://reality.sgi.com/nate/machines/security/P49-14-Aleph-One</font>

</a>

<HR size="1" noshade>

<p align=right><i>Traducido por 
<A HREF="mailto:"><FONT color="#000000">Ruben Sotillo</font></A> y revisado por 
<A href="mailto:lastras@writeme.com"><FONT color="#000000">Hugo Lastras</font>
</a>
</I></P>

</TD>
</TR>
</TABLE>

<!-- ARTICLE FOOT -->
   <BR clear="all">
    <CENTER>
      <TABLE width="95%">
	
	<TR>
	  <TD align="center" bgcolor="#666666">
	    <FONT color="#ffffff">
	      P&aacute;ginas web mantenidas por Miguel &Aacute;ngel Sep&uacute;lveda<BR>
&copy; Michael Jastremski<br>
	      <B>LinuxFocus 1998</B>
	    </FONT>
	  </TD>
	</TR>
	
      </TABLE>
    </CENTER>
    
    
    
  </BODY>
  
</HTML>

