<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
 <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <META NAME="GENERATOR" CONTENT="lfparser_2.34">
 <META NAME="LFCATEGORY" CONTENT="SystemAdministration">
 <link rel="icon" href="../../common/images/lf-16.png" type="image/png">
 <TITLE>lf249, SystemAdministration: Enviando y recibiendo faxes con Efax</TITLE>
<style type="text/css">
<!--
 td.top {font-family: Arial,Geneva,Verdana,Helvetica,sans-serif; font-size:12 }
 pre { font-family:monospace,Courier }
 p.cl { color:#EE9500 }
 a.nodec { text-decoration:none }
 p.trans { font-size:8pt; text-align:right }
 p.clbox { width:50%; alignment:center; background-color:#FFD700; 
           border-style:none; border-width:medium; border-color:#FFD700; 
           padding:0.5cm;  text-align:center }
 p.code { width:80%; alignment:center; background-color:#aedbe8; 
          border-style:none; border-width:medium; border-color:#aedbe8; 
          padding:0.1cm;  text-align:left }
 p.foot { background-color:#AAAAAA; color:#FFFFFF; border-style:none; 
          border-width:medium; border-color:#AAAAAA; padding:0.5cm ; 
          margin-top:0.1cm; margin-right:1cm; margin-left:1cm; 
          text-align:center }
 .mark  { background-color:#e6e6ff }
-->
</style>
 
</HEAD>
<BODY bgcolor="#ffffff" text="#000000">
 <!-- this is generated html code. NEVER use this file for your
 translation work. Instead get the file with the same article number
 and .meta.shtml in its name. Translate this meta file and then
 use lfparser program to generate the final article -->
 <!-- lfparser can be obtained from http://www.linuxfocus.org/~guido/dev/lfparser.html -->

<!-- this is used by a number of tools:
 =LF=AUTHOR: Mark Nielsen
 =LF=CAT___: SystemAdministration
 =LF=TITLE_: Enviando y recibiendo faxes con Efax
 =LF=NUMBER: 249
 =LF=ANAME_: article249.html
 -->

<!-- 2pdaIgnoreStart -->

<!-- start navegation bar -->
 <!-- top navegation bar -->
 <TABLE summary="topbar_1" cellspacing="0" cellpadding="0" border="0" align="center" width="90%">
   <TR bgcolor="#2e2292">
     <TD class="top"><TABLE summary="topbar_1_logo" cellspacing="0" cellpadding="0" border="0" width=
       "100%">
         <TR><TD width="319"><IMG src="../../common/images/logolftop_319x45.gif"
           alt="[LinuxFocus-icon]" width="319" height="45" align="left" 
           border="0"></TD>

           <TD class="top">
             <TABLE summary="topbar_1_links" width="100%">
               <TR align="right">
                 <TD class="top"><A class="nodec" href="../"><FONT color=
                 "#DDDDDD" size="2">Hogar</FONT></A> &nbsp;|&nbsp; <A class=
                 "nodec" href="../map.html"><FONT color=
                 "#DDDDDD" size="2">Mapa</FONT></A> &nbsp;|&nbsp; <A class=
                 "nodec" href="../indice.html"><FONT color=
                 "#DDDDDD" size="2">Indice</FONT></A> &nbsp;|&nbsp; <A class=
                 "nodec" href="../Search/"><FONT color=
                 "#DDDDDD" size="2">Busqueda</FONT></A> </TD>
               </TR>

               <TR align="right">
                 <TD class="top">
                   <HR width="100%" noshade size="1">
                 </TD>
               </TR>
             </TABLE>
           </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end top navegation bar -->
 <!-- blue bar -->
 <TABLE summary="topbar_2" cellspacing="0" cellpadding="0" border="0" align="center"
 width="90%">
   <TR bgcolor="#00ffff">
     <TD><IMG src="../../common/images/transpix.gif" width="1" height=
     "2" alt=""></TD>
   </TR>
 </TABLE>
 <!-- end blue bar -->
 <!-- bottom navegation bar -->
 <TABLE summary="topbar_3" cellspacing="0" cellpadding="0" border="0" align="center"
 width="94%">
   <TR bgcolor="#000000">
     <TD>
       <TABLE summary="topbar_3_links" cellspacing="0" cellpadding="1" border="0" width=
       "100%">
         <TR align="center">
           <TD WIDTH="20%"><A class="nodec" href="../News/"><FONT color=
           "#FFFFFF">Noticias</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Archives/"><FONT color=
           "#FFFFFF">Arca</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../Links/"><FONT color=
           "#FFFFFF">Enlaces</FONT></A> </TD>
           <TD WIDTH="5%"><FONT color="#FFFFFF">|</FONT> </TD>
           <TD WIDTH="20%"><A class="nodec" href="../aboutus.html"><FONT color=
           "#FFFFFF">Sobre LF</FONT></A> </TD>
         </TR>
       </TABLE>
     </TD>
   </TR>
 </TABLE>
 <!-- end bottom navegation bar -->
<!-- stop navegation bar -->

<!-- SSI_INFO -->

<!--#include virtual="../../dynahead.shtml" -->

<!-- SSI_INFO STOP -->
<!-- 2pdaIgnoreStop -->

<!-- SHORT BIO ABOUT THE AUTHOR -->
<TABLE ALIGN=LEFT BORDER=0  WIDTH="190" summary="about the author">
<TR>
<TD>

<!-- 2pdaIgnoreStart -->
<!-- PALM DOC -->
<TABLE BORDER=0 hspace=4 vspace=4 summary="pda download"> <TR> <TD>
<font size=1> <img src="../../common/images/2doc.gif" width=34 align=left border=0 height=22 alt="convert to palm"><a href="http://cgi.linuxfocus.org/cgi-bin/2ztxt">Convert to GutenPalm</a><br>or <a href="http://cgi.linuxfocus.org/cgi-bin/2pda">to PalmDoc</a></font>
</TD> </TR> </TABLE>
<!-- END PALM DOC -->
<!-- 2pdaIgnoreStop -->
<br>
<img src="../../common/images/Mark-Nielsen_2.jpg" width="97" height="52" alt="[Mark]">
<BR>por  Mark Nielsen <br> <small>&lt;articles(at)audioboomerang.com&gt;</small>
<BR><BR>
<I>Sobre el autor:</I><BR>
<!-- aboutauthor_start -->

Mark Nielsen labora en <a href=
"http://www.audioboomerang.com/">AudioBoomerang.com</a>
empresa para la cual crea, entrega y da seguimiento de correo
personalizado con contenido multimedia, as&iacute; como a campa&ntilde;as
en Web y Grupos de Noticias. Una de sus funciones es la de fungir
consultor en la entrega de productos finales como
Reportes Estad&iacute;sticos Avanzados a los clientes de AudioBoomerang.com,
reportes que son usados para definir perfiles demogr&aacute;ficos o psicol&oacute;gicos
en futuras campa&ntilde;as. En su tiempo libre escribe art&iacute;culos cuyos
temas principales son el Software Libre (GPL) y la Documentaci&oacute;n
Libre (FDL), est&aacute; relacionado tambi&eacute;n con el Centro de Aprendizaje <a

href="http://www.eastmont.net">Eastmont Computing Center</a>.



<!-- aboutauthor_stop -->
<!-- TRANSLATED TO es -->
<BR><BR><I>Taducido al espa&ntilde;ol por:</I><BR>
Edgar Hern&aacute;ndez Z. <small>&lt;cybered(at)linuxmail.org&gt;</small>
<br>
<!--
 =LF=TRANSTO=es: Edgar Hern&aacute;ndez Z.
-->
<!-- TRANSLATED TO STOP -->
<BR><i>Contenidos</i>:
<UL>
  <LI><A HREF="#249lfindex0">Purpose</A></LI>
  <LI><A HREF="#249lfindex1">Archivos de
Configuraci&oacute;n</A></LI>
  <LI><A HREF="#249lfindex2">Efax y fax recibiendo un s&oacute;lo fax</A></LI>
  <LI><A HREF="#249lfindex3">Efax y fax m&uacute;ltiples a trav&eacute;s de inittab</A></LI>
  <LI><A HREF="#249lfindex4">Qu&eacute; hacer despu&eacute;s de recibir los faxes?</A></LI>
  <LI><A HREF="#249lfindex5">Enviando faxes</A></LI>
  <LI><A HREF="#249lfindex6">Referencias</A></LI>
  <LI><A HREF="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=249">Formulario de "talkback" para este art&iacute;culo</A></LI>
</UL>

</TD></TR></TABLE>
<!-- HEAD OF THE ARTICLE -->
<br>&nbsp;
<table border="0"><tr><td>
<H2>Enviando y recibiendo faxes con Efax</H2>
 <img src="../../common/images/illustration249.gif" width="181"
height="168" alt="[Tux jugando con el fax...]" hspace="10">
<!-- ABSTRACT OF THE ARTICLE -->
<P><i>Resumen</i>:
<P>
<!-- articleabstract_start -->

Configuraci&oacute;n de Efax para el env&iacute;o y recepci&oacute;n de faxes en Red Hat Linux 7.2.


<!-- articleabstract_stop -->

<br><!-- HR divider --><center><font color="#8282e0"><b>_________________ _________________ _________________</b></font></center><br>
</td></tr></table>
<!-- BODY OF THE ARTICLE -->


<A NAME="249lfindex0">&nbsp;</A>
<H3>Purpose</H3>

Ten&iacute;a la intenci&oacute;n de instalar un servidor de faxes. Pens&eacute; en usar HylaFax,
pero mi sistema Red Hat Linux el cual ya ten&iacute;a mgetty instalado
comenz&oacute; a tener problemas cuando intente instalar HylaFax v&iacute;a
rpm. Tambi&eacute;n me parec&iacute;a indicado usarlo ya que con mgetty me
ser&iacute;a posible conectarme y establecer sesiones de voz al igual
que sesiones de fax. Por ahora, solo quer&iacute;a recibir faxes
utilizando la instalaci&oacute;n por defecto de Red Hat 7.2 sin usar
software adicional.

<p>Efax y fax son realmente lo mismo. 'fax' es solamente un
script que manda ejecutar &eacute;fax'.</p>

<A NAME="249lfindex1">&nbsp;</A>
<H3>Archivos de
Configuraci&oacute;n</H3>

Existen dos archivos en los que puedes realizar las configuraciones
para lograr que las cosas funcionen:

/usr/bin/fax y /etc/inittab

<p>Procede a copiar /usr/bin/fax a /usr/bin/fax_custom, y cambia
las siguientes l&iacute;neas:</p>
<pre>
FAXDIR=/var/spool/fax/incoming
NAME="Servidor de faxes de AudioBoomerang.com..."
FROM="+1 111 222 3333"
ANSFNAME="fax_%Y%m%d_%H%M%S"
</pre>

<p>En /etc/inittab, cambia:</p>
<pre>
S0:2345:respawn:/bin/sh /usr/bin/fax_custom answer
</pre>

<A NAME="249lfindex2">&nbsp;</A>
<H3>Efax y fax recibiendo un s&oacute;lo fax</H3>

Para recibir s&oacute;lo un fax, ejecuta el siguiente comando:
<pre>
efax -d /dev/ttyS0 -l "268 1162"  -c 1,5 -r reply
</pre>
o
<pre>
fax answer
</pre>

<p>Si no deseas que el servidor se mantenga a la espera en
caso de que se presente otra conexi&oacute;n de fax, no debes agregar
los cambios en el archivo /etc/inittab que fueron mencionados
en la secci&oacute;n Archivos de Configuraci&oacute;n.</p>

<A NAME="249lfindex3">&nbsp;</A>
<H3><a name="multiple"></a>Efax y fax m&uacute;ltiples a trav&eacute;s de inittab</H3>

Si has modificado el archivo /etc/inittab como fu&eacute; descrito anteriormente,
es necesario que reinicies tu equipo, con ello, conseguir&aacute;s que el
m&oacute;dem est&eacute; listo para recibir faxes los cu&aacute;les ser&aacute;n almacenados en
el directorio /var/spool/fax/incoming.

<p>Si ejecutas el comando:</p>
<pre>
ps auxw | grep efax
</pre>
Deber&aacute; aparecer la sesi&oacute;n de Efax ejecut&aacute;ndose en segundo plano, el
resultado ser&aacute; similar a este:<br>
<tt>root 1698 0.0 0.4 1576 616 ? S< 21:47 0:00
/usr/bin/efax
-v -v chewmainrxtf -d/dev/modem -iZ -i&amp;FE&amp;D2S7=120
-i&amp;</tt>

<p>La ventaja es que, si matas el proceso cuyo ID es "1698", este
ser&aacute; reiniciado y volver&aacute; a leer el archivo /usr/bin/fax_custom.
Por lo tanto, si llegas a realizar cualquier cambio a dicho archivo,
ser&aacute; suficiente que mates el proceso para que puedas probar la nueva
configuraci&oacute;n.</p>

<A NAME="249lfindex4">&nbsp;</A>
<H3><a name="what"></a>Qu&eacute; hacer despu&eacute;s de recibir los faxes?</H3>

Bien, ser&aacute; necesario que corras un proceso a trav&eacute;s de cron que ordene los
archivos que se encuentran en /var/spool/fax/incoming, cree un archivo
bloqueado para cada grupo de faxes y por &uacute;ltimo, sean convertidos a
PDF para ser visualizados a trav&eacute;s de un navegador o para que sean impresos.

<p>Si deseas imprimirlos, debes usar efix como se muestra a continuaci&oacute;n:</p>
<pre>
efix -ops fax_20020606_014847.001 | lpr
</pre>

<p>Se recomienda que imprimas el archivo y lo almacenes en un directorio de

respaldo.</p>

<A NAME="249lfindex5">&nbsp;</A>
<H3><a name="sending"></a>Enviando faxes</H3>

Configurar el servicio de impresi&oacute;n es m&aacute;s complicado de lo que hab&iacute;a pensado.
Para ello, ser&aacute; necesario llevar a cabo lo que se menciona en la p&aacute;gina del
manual, as&iacute; como algunas modificaciones:

<ol>
<li>
<pre>
ln /usr/bin/fax /usr/bin/faxlpr
</pre>
</li>

<li>
  En /etc/printcap.local
<pre>
 fax:lp=/dev/null:sd=/var/spool/fax:if=/usr/bin/faxlpr_perl:
</pre>
</li>

<li>
<pre>
mkdir /var/spool/lpd/fax
touch /var/spool/lpd/fax/lock
</pre>
</li>

<li>
<pre>
/etc/rc.d/init.d/lpd restart
</pre>
</li>
</ol>

<p>Ahora, los cambios que sugiero son los siguientes:</p>

<ol>
<li>
  En /usr/bin/faxlpr, modifique
<pre>
l=`$FAX send "$num" fax$$`

por

`gs -q -sDEVICE=tiffg3 -dNOPAUSE -sOutputFile=fax_out fax$$
</dev/null`
l=`efax -t $num fax_out`
`rm fax_out`
</pre>
  y tambi&eacute;n modifique estas tres l&iacute;neas en la secci&oacute;n faxlpr:
<pre>
num=` echo "$cfile" | sed -e /^[^J]/d -e s/..//`
host=`echo "$cfile" | sed -e /^[^H]/d -e s/..//`
user=`echo "$cfile" | sed -e /^[^P]/d -e s/..//`
</pre>
</li>

<li>
  Cree un shell script en /usr/bin/faxlpr_perl con permisos
  755 /usr/bin/faxlpr_perl:
<pre>
#!/usr/bin/perl

my $String = "";
foreach my $Arg (@ARGV)
{
if ($Arg =~ /\-j/)
{
my $Copy = $Arg;
$Copy =~ s/\-j//;
open(FILE,">lock"); print FILE "hfA$Copy";
close FILE;
}
}
my $Command = "/usr/bin/faxlpr";
system ($Command, @ARGV);
print 1;
</pre>
</li>

<li>Esta es la parte que realmente odio, ya que es necesario asignar
atributos "chmod 666 /dev/ttyS1" a fin de permitir que el usuario lpr
que es el que controla los trabajos de impresi&oacute;n, pueda utilizar el m&oacute;dem.</li>
</ol>

<p>El script en Perl, podr&aacute; encontrar el n&uacute;mero del proceso y cambiar el
nombre del proceso de "fax" a "efax", tal como se requiere, ya que este,
intentar&aacute; crear los archivos bloqueados los cuales no deseamos que sean
creados.</p>

<p>Creo que el m&eacute;todo que utilizo, tambi&eacute;n se deshar&aacute; de los archivos
bloqueados que ya han sido creados, lo cual puede provocar problemas si
estas intentando enviar faxes mientras se esta recibiendo uno.</p>

<p>Despu&eacute;s de todo el dolor y sufrimiento, tu programa de impresi&oacute;n, podr&aacute;
recibir la opci&oacute;n "-J", por lo tanto podr&aacute;s usar un comando parecido a este:
'lpr -P fax -J "555 1212" file.ps'. De otra manera, tendr&aacute;s que imprimir
primero a un archivo y despu&eacute;s imprimirlo desde la l&iacute;nea de comandos.</p>

<p>Tambi&eacute;n es posible que utilices efax para enviar faxes y no hacerlo a trav&eacute;s
del servicio de impresi&oacute;n. Necesitas usar gs para convertirlos antes de ser
enviados, lo cual puede ser un problema todav&iacute;a.</p>

<h3<a name="conclusions"></a>Conclusiones.</h3>
En cuanto tenga oportunidad, tratar&eacute; de ver si es posible:

<ul>
<li>Enviar faxes usando Samba con mgetty. Substituir&iacute;a
/usr/bin/fax_custom con mgetty en inittab esto, me permitir&iacute;a enviar
y recibir faxes sin tantos problemas. Recibir faxes y
enviarlos manualmente usando efax est&aacute; muy bien, pero tener que
hacerlo a trav&eacute;s del servicio de impresi&oacute;n es un gran problema.</li>

<li>Comprobar si es posible usar mgetty no s&oacute;lo para faxes, sino
 tambi&eacute;n para conexiones y voz.</li>
</ul>

<p>Efax es solamente una soluci&oacute;n temporal hasta que configure
mgetty. La &uacute;nica raz&oacute;n para no usar HylaFax, como ya he mencionado,
han sido los problemas con mgetty al tratar de instalarlo con el
RPM. Estoy realmente interesado en mgetty y me he divertido con efax.
Intentar&eacute; usar mgetty en el futuro para poder usar el mismo m&oacute;dem en
conexiones y sesiones de voz, as&iacute; como en el servicio de fax.
Aparentemente esposible hacerlo, salvo algunos problemas con los m&oacute;dems
para detectar correctamente cuando se est&aacute; realizando una sesi&oacute;n de voz,
cuando es una conexi&oacute;n y cuando un fax. La verdad es que no me agrada
enviar faxes manualmente con efax y el sistema de impresi&oacute;n de mi equipo.
Espero que mgetty me resuelva todos estos problemas.</p>

<A NAME="249lfindex6">&nbsp;</A>
<H3><a name="REF"></a>Referencias</H3>


<ol>
<li><a href=
"../March2001/article196.shtml">
The Easy Fax Server!</a></li>

<li><a href="http://linuxgazette.com/issue79/fraile.html">A

Linux Fax Server for a Windows Network</a></li>

<li><a href=
"http://linuxgazette.com/issue28/vermeer1.html">Linux
 Fax for Dummies</a></li>

<li><a href=
"http://linuxgazette.com/issue25/pardo.html">Hylafax</a></li>

</ol>

<p><small>
 Article Version <b>1.2</b> : Date Last Changed
<b>Thu Jun 13
04:17:31 2002</b></small></p>



<!-- 2pdaIgnoreStart -->
<A NAME="talkback">&nbsp;</a>
<h2>Formulario de "talkback" para este art&iacute;culo</h2>
Cada art&iacute;culo tiene su propia p&aacute;gina de "talkback". A trav&eacute;s de esa p&aacute;gina puedes enviar un comentario o consultar los comentarios de otros lectores
<center>
<table border="0"  CELLSPACING="2" CELLPADDING="1" summary="tb-button-outerpart">
 <tr BGCOLOR="#C2C2C2"><td align=center>
  <table border="3"  CELLSPACING="2" CELLPADDING="1" summary="tb-button">
   <tr BGCOLOR="#C2C2C2"><td align=center>
    <A href="http://cgi.linuxfocus.org/cgi-bin/lftalkback?anum=249"><b>&nbsp;Ir a la p&aacute;gina de "talkback"&nbsp;</b></a>
   </td></tr></table>
</td></tr></table>
</center>

<HR size="2" noshade>
<!-- ARTICLE FOOT -->
<CENTER><TABLE WIDTH="98%" summary="footer">
<TR><TD ALIGN=CENTER BGCOLOR="#9999AA" WIDTH="50%">
<A HREF="../../common/lfteam.html">Contactar con el equipo de LinuFocus</A>
<BR><FONT COLOR="#FFFFFF">&copy; Mark Nielsen, <a href="../../common/copy.html">FDL</a> <BR><a href="http://www.linuxfocus.org">LinuxFocus.org</a></FONT>
</TD>
<TD BGCOLOR="#9999AA">
<!-- TRANSLATION INFO -->
<font size=2>Informaci&oacute;n sobre la traducci&oacute;n:</font>
<TABLE summary="translators">
  <tr><td><font size="2">en --&gt; -- : Mark Nielsen <small>&lt;articles(at)audioboomerang.com&gt;</small></font></td></tr>
  <tr><td><font size="2">en --&gt; es: Edgar Hern&aacute;ndez Z. &lt;cybered(at)linuxmail.org&gt;</font></td></tr>
</TABLE>
</TD>
</TR></TABLE></CENTER>
<p><font size=1>2003-03-17, generated by lfparser version 2.34</font></p>
<!-- 2pdaIgnoreStop -->
</BODY>
</HTML>
