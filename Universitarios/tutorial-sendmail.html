<!-- BASE HREF="file:///C|/sendmail.htm" -- >
<!-- Autor: David Rubert. Fecha: 18-Feb-1998 -- >

<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="David Rubert">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.03 [es] (Win95; I) [Netscape]">
   <TITLE>Tutorial sendmail</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#DADADA" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">

<CENTER><B><FONT SIZE=+4>TUTORIAL DE SENDMAIL</FONT></B></CENTER>

<HR WIDTH="100%">
Este documento fue realizado en la UJI (Universidad Jaume I de Castellon)
durante el transcurso del curso universitario 97-98, en la asignatura <A HREF="http://moon.inf.uji.es/mollar/ISA">Interconexion de Sistemas Abiertos.</A>
Se permite la libre distribucion o copia de este documento. Si tienes cualquier duda, critica o
sugerencia, puedes contactar con el autor, que soy yo:
<CENTER>David Rubert Viana&nbsp;&nbsp; (<A HREF="mailto:al004260@alumail.uji.es">al004260@alumail.uji.es</A>)</CENTER>

<HR WIDTH="100%">
<UL>
<UL><FONT SIZE=+1>1. Introducci&oacute;n</FONT>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A HREF="#Función">1.1 Funci&oacute;n y caracter&iacute;sticas
de sendmail</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A HREF="#Ficheros">1.2 Situaci&oacute;n y
descripci&oacute;n de los programas y ficheros de soporte utilizados por
sendmail</A>

<P><FONT SIZE=+1>2. Funciones de sendmail</FONT>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#MUA">2.1 Sendmail como agente de usuario</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#MTA">2.2 Sendmail como agente de transporte</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Cola">2.3 La cola de correo</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Cola">2.4 Los Alias en sendmail</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2.4.1 El fichero /etc/aliases
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2.4.2 El fichero .forward
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2.4.3 Las listas de correo
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Traza">2.5 Sendmail en modo traza</A>
<BR>&nbsp;&nbsp;&nbsp; <FONT COLOR="#000000"><A HREF="#Parámetros">2.6
Par&aacute;metros m&aacute;s comunes de la l&iacute;nea de comandos en
sendmail</A></FONT>

<P><FONT SIZE=+1>3. El fichero de configuraci&oacute;n de sendmail</FONT>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Función">3.1 Funci&oacute;n y organizaci&oacute;n
del fichero</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#macros">3.2 Macros</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.2.1 Los nombres
largos
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.2.2 Los condicionales
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.2.3 Las macros
internas de sendmail
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#clases">3.3 Clases</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.3.1 Clases
internas m&aacute;s comunes
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.3.2 Ejemplo
del uso conjunto de macros y clases
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Opciones">3.4 Opciones</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 34.1 Opciones
m&aacute;s comunes
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.4.2 Modos
de reparto
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.4.3 Timeouts
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Precedencia">3.5 Precedencia de mail</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#Trusted">3.6 Trusted Users</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#cabeceras">3.7 Formato de las cabeceras</A>
<BR>&nbsp;&nbsp;&nbsp; <A HREF="#reglas">3.8 Las reglas de reescritura</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8.1 Los conjuntos
de reglas de reescritura (Rewriting rule sets)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8.2 La parte
izquierda y derecha de una regla (Left-hand-side &amp; Right-hand-side)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8.3 Los separadores
de tokens
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8.4 Como probar
nuestras propias reglas de reescritura
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.8.5 Ejemplos
de reglas de reescritura extraidas del fichero de configuraci&oacute;n
de LINUX
<BR>&nbsp;&nbsp; <A HREF="#mailers">3.9 Definici&oacute;n de mailers</A>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.9.1 Campos
m&aacute;s comunes en la definici&oacute;n de mailers
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.9.2 Par&aacute;metros
m&aacute;s comunes en la definici&oacute;n de mailers
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.9.3 Ejemplos
de definici&oacute;n de mailers
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.9.4 La definici&oacute;n
del mailers en el fichero de configuraci&oacute;n de LINUX
<BR><FONT SIZE=+1>4. Links interesantes</FONT>

<P>&nbsp;</UL>
</UL>

<HR WIDTH="100%">
<BR><FONT SIZE=+3>1. Introducci&oacute;n</FONT>

<P>&nbsp;&nbsp;&nbsp; Este tutorial intenta dar una visi&oacute;n global
de sendmail v8.8.7 (Berkeley), programa de distribuci&oacute;n gratuita
creado (y actualmente revisado) por Eric Allman. La versi&oacute;n actual
es la v8.8.8, aunque nosotros trataremos la anterior versi&oacute;n. Se
intentar&aacute; explicar claramente la mayor&iacute;a de sus funciones
sin entrar muy a fondo en cada una de ellas, pero dando ejemplos conprensivos.
Tambi&eacute;n veremos como podemos configurar sendmail para su funcionamiento
en un sistema espec&iacute;fico.
<BR>&nbsp;

<P><A NAME="Función"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>1.1 Funci&oacute;n y caracter&iacute;sticas
de sendmail</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Existe una gran variedad de programas de correo
electr&oacute;nico que proveen al usuario de una aplicaci&oacute;n para
la creaci&oacute;n y env&iacute;o de mail. Estos programas son los llamados
Agentes de Usuario o MUA (Mail User Agent), y su prop&oacute;sito es el
aislar al usuario de los Agentes de Transporte o MTA (Mail Transport Agent),
que son los encargados de transferir los mails a su correcto destino.
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Sendmail es el agente de transporte de correo m&aacute;s
com&uacute;n de Internet (en los sistemas UNIX). Aunque actua principalmente
como MTA, tambi&eacute;n puede ser utilizado como MUA (aunque no posee
interfaz de usuario). Las misi&oacute;nes b&aacute;sicas de sendmail son
las siguientes:
<UL>
<LI>
Recogida de mails provinientes de un Mail User Agent (MUA) como pueden
ser elm, Eudora o pine; o provinientes de un Mail Transport Agent (MTA)
como puede ser el propio sendmail.</LI>
</UL>

<UL>
<LI>
Elecci&oacute;n de la estrategia de reparto de los mails, bas&aacute;ndose
en la informaci&oacute;n de la direcci&oacute;n del destinatario contenida
en la cabecera:</LI>

<BR>&nbsp;
<UL>
<LI>
Si el mail es local en nuestro sistema, enviar&aacute; el mail al programa
de reparto local de mails.</LI>
</UL>
&nbsp;
<UL>
<LI>
Si el mail no es local, sendmail utilizar&aacute; el DNS de nuestro sistema
para determinar el host al que debe ser enviado el mail. Para transferir
el mensaje, iniciar&aacute; una sesi&oacute;n SMTP con el MTA de dicho
host.</LI>
</UL>
&nbsp;
<UL>
<LI>
Si no es posible mandar el mail a su destino (porque la maquina receptora
esta desconectada, o va muy lenta), sendmail almacenar&aacute; los mails
en una cola de correo, y volver&aacute; a intentar el env&iacute;o del
mail un tiempo despues. Si el mail no puede ser enviado tras un tiempo
razonable, el mail ser&aacute; devuelto a su autor con un mensaje de error.
Sendmail debe garantizar que cada mensaje llegue correctamente a su destino,
o si hay error este debe ser notificado (ning&uacute;n mail debe perderse
completamente).</LI>
</UL>
</UL>

<UL>
<LI>
Reformatear el mail antes de pasarlo a la siguiente m&aacute;quina, seg&uacute;n
unas reglas de reescritura. Seg&uacute;n el tipo de conexi&oacute;n que
poseamos con una determinada m&aacute;quina, o seg&uacute;n el agente de
transporte al que vaya dirigido el mail, necesitaremos cambiar los formatos
de las direcciones del remitente y del destinatario, algunas lineas de
la cabecera del mail, o incluso puede que necesitemos a&ntilde;adir alguna
l&iacute;nea a la cabecera. Sendmail debe realizar todas estas tareas para
conseguir la m&aacute;xima compatibilidad entre usuarios distintos.</LI>
</UL>

<UL>
<LI>
Otra funcion muy importante de sendmail es permitir el uso de "alias" entre
los usuarios del sistema; lo que nos permitir&aacute; (entre otras funciones)
crear y mantener listas de correo entre grupos.</LI>
</UL>

<UL>
<LI>
Ejecuci&oacute;n como agente de usuario (MUA). Aunque no posee interfaz
de usuario, sendmail tambien permite el env&iacute;o directo de mails a
trav&eacute;s de su ejecutable.</LI>
</UL>
&nbsp;&nbsp;&nbsp; Todas estas caracter&iacute;sticas y muchas otras que
posee el sendmail deben ser configuradas y variar&aacute;n de unos sistemas
a otros. Para configurarlas hacemos uso del fichero de configuraci&oacute;n
de sendmail. La revisi&oacute;n y modificaci&oacute;n de este fichero es
bastante complicada y necesita de una serie de conocimientos previos.
<BR>&nbsp;

<P>&nbsp;<A NAME="Ficheros"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>1.2 Situaci&oacute;n y descripci&oacute;n
de los programas y ficheros de soporte utilizados por sendmail</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR><B>1. /usr/sbin/sendmail ( /usr/lib/sendmail en algunos sistemas)</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ejecutable del sendmail.

<P><B>2. /etc/sendmail.cf (/usr/lib/sendmail.cf)</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fichero de configuraci&oacute;n
de sendmail.

<P><B>3. /etc/aliases</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fichero donde se almacenan
los alias del sistema.

<P><B>4. /usr/bin/newaliases</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reconstruye la base de datos de
alias usada por sendmail, a partir del fichero aliases. Es un enlace simb&oacute;lico
a sendmail en el modo <B>-</B>bi.

<P><B>5. /var/spool/mqueue</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Es el directorio donde se
almacena la cola de correo.

<P><B>6. /usr/bin/mailq</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Saca por pantalla el contenido
de la cola de correo. Es un enlace simb&oacute;lico a sendmail en el modo
-bp.
<BR>&nbsp;
<BR>&nbsp;
<BR>
<HR WIDTH="100%">

<P><FONT SIZE=+3>2. Funciones de sendmail</FONT>

<P>&nbsp;
<BR>&nbsp;<A NAME="MUA"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.1 Sendmail como agente de
usuario</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Como agente de usuario, sendmail lee por defecto
de su entrada estandard hasta encontrar un end-of-file (EOF) o una linea
que contenga &uacute;nicamente un punto ("."). En ese momento manda una
copia de ese mensaje a cada una las direcciones destino (que se le habr&aacute;n
pasado previamente en la l&iacute;nea de comandos). &Eacute;l mismo determinar&aacute;
la ruta a seguir (consultando el DNS si fuera necesario), bas&aacute;ndose
en el contenido de la direcci&oacute;n destinataria.

<P>&nbsp;&nbsp;&nbsp; Sendmail determina c&oacute;mo enrutar un mensaje
(cuyo destino sea la direcci&oacute;n o direcci&oacute;nes que le habremos
establecido), de acuerdo a la informaci&oacute;n que posee en su fichero
de configuraci&oacute;n (por defecto /usr/lib/sendmail.cf).
<BR>&nbsp;
<BR>Ejemplo 1:
<BR>&nbsp;&nbsp;&nbsp; Este comando manda un mail a "alonso@xyz.com", sin
t&iacute;tulo y cuyo cuerpo contiene &uacute;nicamente "hola que tal".
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$ sendmail alonso@xyz.com</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
hola que tal</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
..</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$</FONT>

<P>Ejemplo 2:
<BR>&nbsp;&nbsp;&nbsp; Podemos tambien pasarle el cuerpo del mail mediante
un fichero:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$ cat fichero | sendmail alonso@xyz</FONT>

<P>Ejemplo 3:
<BR>&nbsp;&nbsp;&nbsp; Podemos incluso pasarle los datos de la cabecera
manualmente, mediante el par&aacute;metro -t:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$ sendmail -t alonso@xyz</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
From: al001010@alumail.uji.es</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Date: ....</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.....</FONT>
<BR>&nbsp;

<P>&nbsp;<A NAME="MTA"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.2 Sendmail como agente de
transporte</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; La utilizaci&oacute;n de sendmail como demonio en
el sistema nos permite enviar y recibir correo SMTP. Para ello, sendmail
se queda como proceso residente escuchando el puerto 25, admitiendo y realizando
conexiones SMTP cuando sea necesario (es decir, actua como un Agente de
Transporte de Correo (MTA)). Cuando reciba o una petici&oacute;n de conexi&oacute;n,
crear&aacute; un proceso hijo que se encargar&aacute; de ello, mientras
el proceso padre seguir&aacute; escuchando el puerto 25.
<BR>Solo puede ser ejecutado en este modo por el superusuario del sistema.

<P>&nbsp;&nbsp;&nbsp; Para utilizar sendmail como demonio, debemos iniciarlo
en el arranque del sistema en uno de los scripts de inicio con los siguiente
par&aacute;metros:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sendmail -bd -q15m</FONT>

<P>&nbsp;&nbsp;&nbsp; Con esta orden, sendmail actuar&aacute; en modo background
admitiendo conexiones por el puerto 25. La opci&oacute;n -q15m le indica
que actualice la cola de correo cada 15 minutos (este par&aacute;metro
puede variar).

<P>El par&aacute;metro -bD es igual al -bg, pero actuando en foreground.
<BR>&nbsp;

<P><A NAME="Cola"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.3 La cola de correo</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; Cuando el env&iacute;o de un mail no puede alcanzar
su destino porque nos rechazan la conexi&oacute;n (normalmente debido a
que la m&aacute;quina destinataria est&eacute; apagada o sobrecargada),
&eacute;ste debe ser almacenado en una cola de la m&aacute;quina que manda
el mail, para intertar de nuevo el env&iacute;o m&aacute;s tarde.

<P>&nbsp;&nbsp;&nbsp; La cola de correo se encuentra en /var/spool/mqueue.
En este directorio se crean unos ficheros temporales para cada mail que
se almacena. El formato de los ficheros en este directorio es el siguiente:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - df---------</FONT>&nbsp;&nbsp;&nbsp;&nbsp;
(ficheros donde se guardan los cuerpos de los mensajes, sin las cabeceras).
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - qf---------</FONT>&nbsp;&nbsp;&nbsp;&nbsp;
(ficheros donde se guardan la informaci&oacute;n necesaria para procesar
los trabajos).
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - tf---------</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(ficheros temporales imagen de los ficheros qf cuando estos est&aacute;n
siendo reconstruidos).
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - xf---------&nbsp;&nbsp;</FONT>&nbsp;&nbsp;
(fichero donde se almacena toda la informaci&oacute;n transmitida durante
la apertura y cierre de una sesi&oacute;n).

<P>&nbsp;&nbsp;&nbsp; Para visualizar el contenido de la cola usamos el
comando "mailq", que es un link simb&oacute;lico a el comando "sendmail
-bp". Este producir&aacute; una lista con los identificadores de los mensajes,
su tama&ntilde;o, la fecha en la que el mensaje entr&oacute; en la cola,
el remitente y el destinatario.
<BR>&nbsp;
<BR>Para procesar la cola de correo (autom&aacute;tica o manualmente),
se utiliza el comando:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sendmail -q&lt;tiempo></FONT>

<P>que procesa la cola de correo cada &lt;tiempo> (solo pude ser ejecutado
por el superusuario, y normalmente se carga junto con el sendmail en modo
demonio en un script de inicio).

<P>&nbsp;&nbsp;&nbsp; &lt;tiempo> es un n&uacute;mero seguido de caracteres.
El caracter "s" significa segundos, "m" significa minutos, "h" significa
horas, "d" significa dias y "w" significa semanas. Si se omite &lt;tiempo>,
sendmail procesar&aacute; la cola en ese momento

<P>Ejemplo:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>sendmail -q1h30m</FONT>
<BR>Actualizar&aacute; la cola de correo cada hora y media. Y es equivalente
a sendmail -q90m.
<BR>&nbsp;
<BR>Si lo que queremos es procesar la cola en un instante, utilizaremos
el comando:&nbsp;&nbsp;&nbsp; <FONT SIZE=+1>sendmail -q</FONT>
<BR>Pueden utilizarse otros par&aacute;metros especiales para procesar
la cola:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; - qISubstr</FONT>&nbsp;&nbsp; Procesar&aacute;
&uacute;nicamente aquellos trabajos que tengan &lt;Substr> como subcadena
de los identificativos de mail.
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; - qRSubstr</FONT>&nbsp; Procesar&aacute;
&uacute;nicamente aquellos trabajos que tengan &lt;Substr> como subcadena
de los destinatarios.
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; - qSSubstr</FONT>&nbsp; Procesar&aacute;
&uacute;nicamente aquellos trabajos que tengan &lt;Substr> como subcadena
de los remitentes.
<BR>&nbsp;

<P><A NAME="Alias"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.4 Los Alias en sendmail</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; El uso de alias en correo electr&oacute;nico, y gracias
a sendmail, nos permiten:
<UL>
<LI>
Tener nombres alternativos (nicknames) para usuarios individuales.</LI>

<LI>
Env&iacute;o de correo a otras m&aacute;quinas, aunque la direcci&oacute;n
sea local.</LI>

<LI>
Listas de correo.</LI>
</UL>
<B><FONT SIZE=+1>2.4.1 El fichero /etc/aliases</FONT></B>

<P>&nbsp;&nbsp;&nbsp; Existe un fichero de texto (/etc/aliases) donde es
posible ver o modificar la base de datos actual de alias del sistema. Pero
no ser&aacute; &eacute;ste el fichero usado directamente por sendmail,
sino que primero debe ser convertido y procesado con el comando "newaliases",
que crear&aacute; la base de datos de alias que s&iacute; podr&aacute;
utilizar sendmail.

<P>&nbsp;&nbsp;&nbsp; El formato del fichero (/etc/aliases) es el siguiente:
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; <FONT SIZE=+1>alias: recipient [recipient,....]</FONT>
<BR>&nbsp;
<TABLE BORDER CELLPADDING=5 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>alias</FONT></TD>

<TD>es el nombre de la persona a la que mandamos el mail (Debe ser de un
usuario local en la m&aacute;quina).</TD>
</TR>

<TR>
<TD>&nbsp;<FONT SIZE=+1>recipient</FONT></TD>

<TD>es el nombre al cual mandamos el mail. Puede ser un nombre de usuario,
el nombre de otro alias, o una&nbsp;&nbsp; direcci&oacute;n e-mail completa
conteniendo tanto el nombre de usuario como el nombre de la m&aacute;quina
(y su dominio). (Incluyendo el nombre de la m&aacute;quina el mail puede
ser mandado a una m&aacute;quina remota)&nbsp;</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>[recipient,...]</FONT></TD>

<TD>Podemos a&ntilde;adir varios receptores para un mismo alias. Un mail
mandado a ese alias sera recibido por todos los recipeints. (Es una lista
de correo (Mailing list)). Una particularidad es que aunque incluyamos
el nombre de origen a la lista de correo, &eacute;ste no recibir&aacute;
el mail (a menos que establezcamos la opci&oacute;n de MeToo activada).</TD>
</TR>
</TABLE>
&nbsp;
<BR>Ejemplo del fichero /etc/aliases:

<P><FONT SIZE=+1># nombres especiales para los administradores del sistema</FONT>
<BR><FONT SIZE=+1>postmaster: rob</FONT>
<BR><FONT SIZE=+1>root: mike</FONT>

<P><FONT SIZE=+1># Reenv&iacute;o del correo a una direcci&oacute;n remota</FONT>
<BR><FONT SIZE=+1>luisa: luisa@xyz.es</FONT>

<P><FONT SIZE=+1># lista de correo</FONT>
<BR><FONT SIZE=+1>clientes: pepe, juan@xyz, al001010@alumail.uji.es</FONT>
<BR><FONT SIZE=+1># (Si se manda un mail a "clientes", una copia del mail
se mandar&aacute; para cada uno de los destinatarios)</FONT>

<P>&nbsp;
<BR><B><FONT SIZE=+1>2.4.2 El fichero .forward</FONT></B>

<P>&nbsp;&nbsp;&nbsp;&nbsp; A nivel de usuario, sendmail tambien permite
a cualquier usuario normal crearse su propia tabla de alias. &Eacute;sta
viene definida en el fichero .forward del $HOME de cada usuario. Y tiene
precedencia sobre el fichero /etc/aliases creado por el root.
<BR>&nbsp;

<P><B><FONT SIZE=+1>2.4.3 Las listas de correo</FONT></B>

<P>&nbsp;&nbsp;&nbsp; Una funci&oacute;n especial de sendmail para las
listas de correo es la siguiente:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
owner-&lt;lista>: &lt;nombre></FONT>
<BR>&nbsp;&nbsp;&nbsp; donde &lt;lista> es el nombre de una lista de correo.
La persona especificada en &lt;nombre> es la responsable de la lista de
correo identificada en &lt;lista>. Esta funci&oacute;n es util si, por
ejemplo, sendmail tiene problemas mandando correo a alguno de los destinatarios
de la lista de correo. Gracias a esta identificaci&oacute;n del responsable
de la lista, se le mandar&aacute; un mensaje de error a juan indic&aacute;ndole
que han habido problemas en el envio del mail.

<P>Ejemplo:

<P><FONT SIZE=+1>clientes: pepe,juan@xyz,al001010@alumail.uji.es</FONT>
<BR><FONT SIZE=+1>owner-clientes: marcos</FONT>
<BR><FONT SIZE=+1>&nbsp;</FONT>
<BR>&nbsp;&nbsp;&nbsp; Una forma m&aacute;s f&aacute;cil de mantener listas
de correo ser&iacute;a la siguiente l&iacute;nea en /etc/aliases (o en
el .forward, si no somos superusuarios):

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pepe: "| sendmail
'cat &lt;lista>'"</FONT>

<P>donde &lt;lista> contiene todos los suscriptores actuales de la lista
de correo. Con la tuber&iacute;a conseguimos que, al recibir un mail el
usuario "pepe" se ejecute la l&iacute;nea de comandos que sigue a la tuber&iacute;a.
<BR>Las prioridades del programa que se ejecute, ser&aacute;n las mismas
que las de el usuario que recibe el mail.
<BR>&nbsp;

<P>&nbsp;<A NAME="Traza"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.5 Sendmail en modo traza</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; El par&aacute;metro "-dx.l" establece sendmail en modo
traza. La x indica la parte de sendmail de la que queremos hacer la traza.
La l indica el nivel de detalle de la traza. Al ejecutar sendmail con este
par&aacute;metro, al mandar correo a una direcci&oacute;n va explicando
cada uno de los pasos que va realizando para conseguir mandar el mensaje.

<P>&nbsp;&nbsp;&nbsp; Ejemplo:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>sendmail&nbsp;&nbsp;&nbsp;&nbsp; -d21.20&nbsp;&nbsp;&nbsp;
al010100@alumail.uji.es</FONT>

<P>&nbsp;&nbsp;&nbsp; Los tipos de traza m&aacute;s &uacute;tiles son los
siguientes:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT SIZE=+1>21</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
REESCRITURA DE DIRECCIONES
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
- <FONT SIZE=+1>d21.4</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Muestra las direcciones reescritas.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
- <FONT SIZE=+1>d21.20</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Muestra la
parte izquierda y derecha de las reglas de reescritura.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>37.1</FONT>&nbsp;&nbsp;&nbsp; Muestra las opciones utilizadas
de sendmail.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>35.9</FONT>&nbsp;&nbsp;&nbsp; Muestra todas las definiciones
de macros.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>32.1</FONT>&nbsp;&nbsp;&nbsp; Muestra las lineas de cabecera
utilizadas.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>0.15</FONT>&nbsp;&nbsp;&nbsp; Muestra las reglas de reescritura
de direcciones y las definiciones de mailers utilizados.
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>8.8</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Muestra la informaci&oacute;n
del DNS accedida.
<BR>&nbsp;

<P>&nbsp;<A NAME="Parámetros"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>2.6 Par&aacute;metros m&aacute;s
comunes de la l&iacute;nea de comandos en sendmail</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;
<TABLE BORDER CELLPADDING=5 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>-B&lt;tipo></FONT></TD>

<TD>Establece el tipo del cuerpo del mensaje a &lt;tipo> ( 7BIT o 8BITMIME
).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-ba</FONT></TD>

<TD>Modo Arpanet. Es el mismo modo que el estandard (-bm), excepto que
todas las lineas de entrada deben terminar con CR-LF, todas las l&iacute;neas
de salida terminar&aacute;n con CR-LF, y que extrae el remitente leyendo
el campo de la cabecera "From:".&nbsp;</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bd</FONT></TD>

<TD>Ejecutar el demonio de sendmail. Ver <A HREF="#MTA">sendmail como agente
de transporte</A></TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bm</FONT></TD>

<TD>Env&iacute;a el mail introducido por la entrada estandard hasta la
direcci&oacute;n de destino. Puede ir seguido por cualquier otro par&aacute;metro
o modo en la linea de comandos. Es el modo de trabajo estandard.&nbsp;</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bp</FONT></TD>

<TD>Visualizar el contenido de la cola de correo. Ver <A HREF="#Cola">La
cola de correo</A></TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bi</FONT></TD>

<TD>Actualizar la base de datos de alias. Ver <A HREF="#Alias">Los alias
en sendmail</A></TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bt</FONT></TD>

<TD>Modo test de direcciones. Se usa para testear el correcto funcionamiento
de las reglas de reescritura de direcciones.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-bv</FONT></TD>

<TD>Modo verificaci&oacute;n. Simplemente verifica la existencia de los
nombres, no recoge ni manda los mensajes. Se usa normalmente para validar
usuarios o listas de correo.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-C&lt;fichero></FONT></TD>

<TD>Uso de &lt;fichero> como fichero de configuraci&oacute;n de sendmail
alternativo.&nbsp;</TD>
</TR>

<TR>
<TD ALIGN=LEFT><FONT SIZE=+1>-dx.l</FONT></TD>

<TD>Ver <A HREF="#Traza">Sendmail en modo traza</A></TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-f [address]</FONT></TD>

<TD>Establece la direcci&oacute;n fuente, es decir, qui&eacute;n env&iacute;a
el mail. Ser&aacute; v&aacute;lido solo si la direcci&oacute;n [address]
se corresponde con el usuario que est&aacute; ejecutando sendmail, o si
&eacute;ste es un "trusted user" definido en el fichero de configuraci&oacute;n.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-h [cont]</FONT></TD>

<TD>Establece el contador de "hops" a [cont]. El contador de "hops" se
incrementa cada vez que un mismo mail es procesado. Cuando se supera el
l&iacute;mite, se abandona el env&iacute;o de ese mail, y se le devuelve
al emisor con un mensaje de error "too many hops".&nbsp;
<BR>Por defecto, sendmail determina la cuenta de hops de un mensaje contando
las lineas "Received:" del mensaje.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-F name</FONT></TD>

<TD>Establece el nombre completo del usuario a name.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-Mx valor</FONT></TD>

<TD>Establece la macro "x" al valor especificado.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-n</FONT></TD>

<TD>No utilizar los alias.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-ox valor</FONT>&nbsp;
<BR><FONT SIZE=+1>-O option=val</FONT></TD>

<TD>Establece la opci&oacute;n "x" al valor especificado.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-R &lt;tipo></FONT></TD>

<TD>Establece el tipo de devoluci&oacute;n que har&aacute; sendmail si
el mail no puede ser mandado a su destino. El par&aacute;metro "full" indicar&aacute;
que se devuelva todo el mail, y "hdrs" indicar&aacute; que se devuelva
solo la cabecera.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-t</FONT></TD>

<TD>Extrae el o los destinatarios de el mismo mensaje. Leer&aacute; las
direcci&oacute;nes de "To:", "Cc:" y "Bcc:". Cualquier direcci&oacute;n
de la linea de comandos ser&aacute; suprimida (no recibir&aacute; el mail).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>-q[intervalo]</FONT></TD>

<TD>Tiempo de procesamiento autom&aacute;tico de la cola de correo. Ver
<A HREF="#Cola">La cola de correo</A></TD>
</TR>
</TABLE>
&nbsp;
<HR WIDTH="100%">
<BR>&nbsp;

<P><FONT SIZE=+3>3. El fichero de configuraci&oacute;n de sendmail</FONT>

<P>&nbsp;
<BR>&nbsp;<A NAME="Función"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.1 Funci&oacute;n y organizaci&oacute;n
del fichero</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; En el fichero de configuraci&oacute;n de sendmail
se encuentra toda la informaci&oacute;n relativa a nuestro sistema que
sendmail utilizar&aacute; cada vez que sea ejecutado. Este fichero no puede
ser compilado con el ejecutable, ya que debe permitir la portabilidad de
la configuraci&oacute;n entre sistemas. El lenguaje utilizado en este fichero
de configuraci&oacute;n est&aacute; pensado para que dicho fichero sea
procesado lo m&aacute;s r&aacute;pidamente posible. En las antiguas m&aacute;quinas,
esta velocidad de procesamiento era absolutamente necesaria, ya que dicho
fichero debe ser procesado cada vez que ejecutamos sendmail. Debido a esto,
el lenguaje utilizado es muy cr&iacute;ptico y poco comprensible. Las nuevas
versiones de sendmail, y gracias a la potencia de las nuevas tecnolog&iacute;as,
se consigue hacer m&aacute;s comprensible el lenguaje utilizado para configurar
sendmail, utilizando el procesamiento m4 (aunque no vamos a tratarlo en
este tutorial).

<P>&nbsp;&nbsp;&nbsp; Este fichero de configuraci&oacute;n podemos encontrarlo
en /etc/sendmail.cf. Con respecto a su contenido, podemos organizarlo en
las siguientes secciones:
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR BGCOLOR="#C0C0C0">
<TD><B>Macros Generales&nbsp;</B></TD>

<TD>Informaci&oacute;n espec&iacute;fica sobre la red local (Nombre del
dominio, nombre oficial de la m&aacute;quina, ...).</TD>
</TR>

<TR>
<TD><B>Clases</B></TD>

<TD>Definici&oacute;n de grupos de nombres de m&aacute;quinas o nombres
de dominios.</TD>
</TR>

<TR>
<TD><B>Opciones</B></TD>

<TD>Definici&oacute;n de las opciones de sendmail.</TD>
</TR>

<TR>
<TD><B>Precedencia de mensajes</B></TD>

<TD>Definici&oacute;n de los valores de la precedencia de mensajes usada
por sendmail.</TD>
</TR>

<TR>
<TD><B>Usuarios de confianza (Trusted users)</B></TD>

<TD>Definici&oacute;n de usuarios a los que le proporcionamos la opci&oacute;n
de que puedan omitir su direcci&oacute;n cuando mandan mails (Suele causar
problemas de seguridad).</TD>
</TR>

<TR>
<TD><B>Formato de las cabeceras</B></TD>

<TD>Definici&oacute;n del formato de las cabeceras que sendmail inserta
en los mails (no debe ser modificada).</TD>
</TR>

<TR>
<TD><B>Reglas de reescritura de direcciones</B></TD>

<TD>Definici&oacute;n de las regas usadas para reescribir las direcciones
de mail.</TD>
</TR>

<TR>
<TD><B>Definici&oacute;n de mailers</B></TD>

<TD>Definici&oacute;n de las instrucciones que usa sendmail para invocar
los programas de reparto del correo.</TD>
</TR>
</TABLE>
&nbsp;
<BR>Para implementar estas secciones, cada una de las l&iacute;neas del
fichero de configuraci&oacute;n comienzan por una de estas letras, seg&uacute;n
la funci&oacute;n que realizan:
<BR>&nbsp;
<CENTER><TABLE BORDER WIDTH="60%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>S</FONT></TD>

<TD>Definici&oacute;n de un conjunto de reglas de reescritura</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>R</FONT></TD>

<TD>Definici&oacute;n de una regla de reescritura</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>D</FONT></TD>

<TD>Definici&oacute;n de una macro</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>C</FONT></TD>

<TD>Definici&oacute;n de una clase&nbsp;</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>F</FONT></TD>

<TD>Extraer los tokens de una clase de un fichero&nbsp;</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>O</FONT></TD>

<TD>Definici&oacute;n de opciones</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>H</FONT></TD>

<TD>Formato del texto de la cabecera</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>T</FONT></TD>

<TD>Usuarios de confianza (Trusted Users)</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>P</FONT></TD>

<TD>Precedencia y prioridad para los mensajes</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>M</FONT></TD>

<TD>Definici&oacute;n de un agente de transporte</TD>
</TR>
</TABLE></CENTER>
&nbsp;
<BR>&nbsp;
<BR>&nbsp;<A NAME="macros"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.2 Macros</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; Las macros nos sirven para definir una informaci&oacute;n
espec&iacute;fica sobre la red local o nuestra m&aacute;quina. Las clases
nos permiten definir grupos de nombres de m&aacute;quinas o nombres de
dominios. La utilidad de estas dos funciones es que nos permiten exportar
las configuraciones de sendmail a otros sistemas similares, sin tener que
cambiar todo el fichero de configuraci&oacute;n, sino simplemente cambiando
los valores de algunas macros o clases.

<P>&nbsp;&nbsp;&nbsp; Una macro puede definirse de la siguiente forma:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT SIZE=+1>
Dxval</FONT>
<BR>&nbsp;&nbsp;&nbsp; La primera "D" indica que estamos usando el comando
"definir macro". La "x" es el nombre de la macro que estamos definiendo.
Y "val" es el valor asignada a esa macro.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Podemos utilizar las macros, por ejemplo en
una regla de reescritura. Por ejemplo, con esta definici&oacute;n de macro:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT SIZE=+1>
DDxyz.com&nbsp;&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(Definici&oacute;n de un dominio)
<BR>&nbsp;&nbsp;&nbsp; poniendo $D en la lhs o la rhs de una regla de reescritura,
estaremos haciendo referencia a el dominio "xyz.com".

<P><B><FONT SIZE=+1>3.2.1 Los nombres largos</FONT></B>
<BR>&nbsp;&nbsp;&nbsp; Un nombre de macro, de clase o de opci&oacute;n
de sendmail puede ser un simple car&aacute;cter ASCII o un nombre largo.
Las antiguas versiones de sendmail solo soportan nombres cortos, pero con
las nuevas versiones, y gracias al aumento de velocidad de procesamiento
de las m&aacute;quinas se ha incluido la opci&oacute;n de definir nombres
largos. Para definir un nombre largo de macro, clase u opci&oacute;n utilizamos
la siguiente sintaxis:

<P>&nbsp;<FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
D{LongName}&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Definici&oacute;n
de una macro de nombre largo.
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
${LongName}</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Referencia
a una macro de nombre largo.

<P>Las letras min&uacute;sculas est&aacute;n reservadas para las macros
internas de sendmail, por tanto, para definir una macro de usuario utilizaremos
una letra may&uacute;scula o un nombre largo que comience por una letra
may&uacute;scula.

<P><B><FONT SIZE=+1>3.2.2 Los condicionales</FONT></B>
<BR>&nbsp;&nbsp;&nbsp; Otra utilidad de utilizar las macros en las reglas
de reescritura es el uso de <U>condicionales</U>, con el siguiente formato:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT SIZE=+1>&nbsp;&nbsp;&nbsp;
$?x text1 $| text2 $</FONT>
<BR>&nbsp;&nbsp;&nbsp; indicamos que usar&aacute; text1 si la macro $x
est&aacute; establecida, y si no usar&aacute; text2 (opcional).
<BR>&nbsp;
<BR><B><FONT SIZE=+1>3.2.3 Macros internas</FONT></B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Las macros internas m&aacute;s importantes
de sendmail son las siguientes:
<BR>&nbsp;
<TABLE BORDER CELLPADDING=5 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>$a</FONT></TD>

<TD>Fecha de origen del mail en formato RFC 822 (Extraida de la linea "Date:").</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$b</FONT></TD>

<TD>Fecha actual en formato RFC 822</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$c</FONT></TD>

<TD>Contador del n&uacute;mero de hops. (Cuenta el n&uacute;mero de l&iacute;neas
"Received:").</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$d</FONT></TD>

<TD>Fecha actual en formato UNIX.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$f</FONT></TD>

<TD>Direcci&oacute;n del remitente extraida de la cubierta (envelope).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$g</FONT></TD>

<TD>Direcci&oacute;n del remitente relativa al destinatario. (Es decir,
si $f es "luis", $g ser&aacute; "luis@host.domain".</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$h</FONT></TD>

<TD>M&aacute;quina destinataria.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$i</FONT></TD>

<TD>Identificador de la cola.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$j</FONT></TD>

<TD>Nombre oficial del dominio.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$m</FONT></TD>

<TD>Nombre del dominio, menos la m&aacute;quina. (Nomalmente $j es equivalente
a $w.$m.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$n</FONT></TD>

<TD>Nombre del demonio encargado de los mensajes err&oacute;neos (Por defecto:
MAILER-DAEMON).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$o</FONT></TD>

<TD>Separadores.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$p</FONT></TD>

<TD>Identificador del proceso de sendmail.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$q</FONT></TD>

<TD>Formato por defecto de la direcci&oacute;n del destinatario. Ejemplos:&nbsp;
<BR><FONT SIZE=+1>Dq$g$?x&nbsp; ($x)$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user@host&nbsp; (Nombre completo del usuario)</FONT>&nbsp;
<BR><FONT SIZE=+1>Dq$?x $x $. &lt;$g>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Nombre del usuario &lt;user@host>&nbsp;</FONT></TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$s</FONT></TD>

<TD>Nombre de la maquina del remitente.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$w</FONT></TD>

<TD>Nombre de la m&aacute;quina local.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$u</FONT></TD>

<TD>Nombre de usuario del destinatario.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$x</FONT></TD>

<TD>Nombre completo del remitente.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>$_</FONT></TD>

<TD>Direcci&oacute;n validada del remitente.</TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;<A NAME="clases"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.3 Clases</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; Las clases son grupos de tokens (por ejemplo de nombres
de m&aacute;quinas o nombres de dominios) que nos sirven para hacer comparaciones
en las LHS de una regla de reescritura. Para definir una clase, utilizamos:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>CXvalor1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; valor2</FONT>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esta expresi&oacute;n a&ntilde;ade
el valor1 y el valor 2 a la clase $=X&nbsp; (Siempre se van a&ntilde;adiendo
los nuevos tokens metidos en una clase a los que ya estaban).
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT SIZE=+1>
FX /dir/fichero</FONT>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extrae los valores de la
clase $=X del fichero /dir/fichero.

<P>&nbsp;&nbsp;&nbsp; El nombre de una clase puede ser un car&aacute;cter
ASCII o una nombre largo entre {corchetes}. Las letras min&uacute;sculas
y car&aacute;cteres especiales est&aacute;n reservadas uso del sistema.
Para definir una clase de nombre largo:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
C{Longname}&nbsp;&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&ntilde;adir tokens a una clase de nombre largo.
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$={Longname}&nbsp;&nbsp;&nbsp;&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Comparaci&oacute;n de un token con una clase de nombre largo.
<BR>&nbsp;

<P>Ejemplo 1:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>CHmarret llevant gregal</FONT>
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; esta expresi&oacute;n es
equivalente a:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CHmarret</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CHllevant</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CHgregal</FONT>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lo que hacen es a&ntilde;adir
a la clase H los nombres de m&aacute;quinas "marret", "llevant" y "gregal".

<P><B><FONT SIZE=+1>3.3.1 Clases internas m&aacute;s comunes</FONT></B>
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD>$=m</TD>

<TD>Conjunto de dominios por los que se conoce la m&aacute;quina actual.</TD>
</TR>

<TR>
<TD>$=t</TD>

<TD>Conjunto de usuarios de confianza (trusted users).</TD>
</TR>

<TR>
<TD>$=w</TD>

<TD>Conjunto de nombre por los que se conoce la m&aacute;quina actual.</TD>
</TR>
</TABLE>
&nbsp;

<P><B><FONT SIZE=+1>3.3.2 Ejemplo del uso conjunto de macros y clases</FONT></B>

<P>Cambio de todos los nombres por los que es conocido el dominio de una
m&aacute;quina, por el nombre oficial del dominio:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Regla LHS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Regla RHS</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
R$+&lt;@$=m>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$1&lt;@$j></FONT>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; La regla LHS busca tokens
que sean miembros de la clase D (definida por el usuario)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; La regla RHS cambia el token
anterior por la macro j (con el nombre oficial del dominio)
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;<A NAME="Opciones"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.4 Opciones</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;

<P>&nbsp;&nbsp;&nbsp; Existe un gran n&uacute;mero de opciones globales
que pueden definirse en el fichero de configuraci&oacute;n directamente.
Nos permiten definir por ejemplo la localizaci&oacute;n de los ficheros
utilizados por sendmail, los modos de operaci&oacute;n por defecto, o la
asignaci&oacute;n de valores a determinadas caracter&iacute;sticas. La
sintaxis es la siguiente:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
O opt=val</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; </FONT>Establece la opci&oacute;n
"opt" al valor "val". La sintaxis de las antiguas versiones es la siguiente:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Ooval</FONT>
<BR>&nbsp;&nbsp;&nbsp; Establece la opci&oacute;n "o" al valor "val".

<P>Los valores que podemos asignar a una opci&oacute;n pueden ser enteros,
una cadena, un booleano, o un intervalo de tiempo.
<BR>&nbsp;
<BR><FONT SIZE=+1>3.4.1 Opciones m&aacute;s comunes</FONT>

<P>&nbsp;&nbsp;&nbsp; Las opciones m&aacute;s comunes son las siguientes
(entre corchetes viene indicado su nombre corto si lo posee):
<BR>&nbsp;
<TABLE BORDER CELLPADDING=5 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>AliasFile=fichero [A]</FONT></TD>

<TD>Usa "fichero" como el fichero de alias del sistema. Por defecto es
el fichero "/etc/aliases".</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>AutoRebuildAliases [D]</FONT></TD>

<TD>Si est&aacute; actitava, reconstruye autom&aacute;ticamente la base
de datos de los alias cuando sea necesario (si fuera posible).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>ConnectionRateThrottle=N [ ]</FONT></TD>

<TD>No permite recibir m&aacute;s de N conexiones por sengundo al demonio
sendmail. Por defecto es 0 (sin l&iacute;mite).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>DeliveryMode=x [d]</FONT></TD>

<TD>Modos de reparto. Ver apartado 3.4.2.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>ForwardPath=path [J]</FONT></TD>

<TD>Path donde sendmail buscar&aacute; los ficheros ".forward" de cada
uauario. Por defecto es "$z/.forward".</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>HostsFile=path [ ]</FONT></TD>

<TD>Path de la base de datos de hosts. Por defecto "/etc/hosts".</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>IgnoreDots [i]</FONT></TD>

<TD>Ignorar los puntos en los mensajes entrantes. Por defecto esta desactivado.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>MaxDaemonChildren=N [ ]</FONT></TD>

<TD>M&aacute;ximo n&uacute;meros de demonios sendmail procesando correo
entrante al mismo tiempo. Si se supera se rechazar&aacute;n las conexiones
de correo entrante.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>MaxHopCount=N [h]</FONT></TD>

<TD>M&aacute;ximo n&uacute;mero de veces que un mensaje es procesado.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>MaxQueueRunSize=N</FONT></TD>

<TD>M&aacute;ximo n&uacute;mero de trabajos procesados en la ejecuci&oacute;n
de la cola. Si no se establece, no hay l&iacute;mite.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>MeToo [m]</FONT></TD>

<TD>Mandar el mail al usuario incluso si est&aacute; en una expansi&oacute;n
de alias (en una lista de correo).</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>QueueDirectory=dir [Q]</FONT></TD>

<TD>Uso de "dir" como el directorio de la cola de correo.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>Timeout.type=timeout</FONT></TD>

<TD>Establece los valores de timeout para cada tipo. Ver apartado 3.4.4.</TD>
</TR>
</TABLE>
&nbsp;
<BR><FONT SIZE=+1>3.4.2 Modos de reparto</FONT>

<P>&nbsp;&nbsp;&nbsp; Existen cuatro modos de reparto en sendmail (entre
par&eacute;ntesis el valor de la opci&oacute;n):
<UL>
<LI>
<U><FONT SIZE=+1>Modo inmediato</FONT></U> (i). Sendmail realiza las conexiones
de modo interactivo, es decir, no devuelve el control del sistema hasta
que ha recibido un resultado de la operaci&oacute;n ejecutada. Es un m&eacute;todo
que ralentiza mucho el sistema, poco recomendado.</LI>
</UL>

<UL>
<LI>
<U><FONT SIZE=+1>Modo background</FONT></U> (b). Cada vez que sendmail
reciba una petici&oacute;n de conexi&oacute;n, generar&aacute; un proceso
hijo que se encargar&aacute; del mensaje. Es el modo m&aacute;s com&uacute;n.</LI>
</UL>

<UL>
<LI>
<U><FONT SIZE=+1>Modo cola</FONT></U> (q). Mete el mail directamente en
la cola de correo, para ser procesado m&aacute;s tarde. Antes de meterlo
en la cola, consulta el servidor de nombres para verificar las direcciones
de remitente y destinatario.</LI>
</UL>

<UL>
<LI>
<U><FONT SIZE=+1>Modo postergado</FONT></U> (d). Parecido al anterior,
con la &uacute;nica diferencia que sendmail no consulta el servidor de
nombres. &Uacute;til en sistemas con servidores de correo cuya conexi&oacute;n
a INTERNET no es permanente, o aquellos en que la consulta al DNS tiene
un coste elevado. La cola ser&aacute; procesada en el momento en que sendmail
se conecte a INTERNET.</LI>
</UL>
<FONT SIZE=+1>3.4.3 Timeouts</FONT>

<P>&nbsp;&nbsp;&nbsp; Son los tiempos m&aacute;ximos permitidos para establecer
una conexi&oacute;n con otra m&aacute;quina. Si alguno de ellos es rebasado,
se rechazar&aacute; la conexi&oacute;n y se almacenar&aacute; el mail en
la cola de correo para ser procesado m&aacute;s tarde. Se divide en varios
subapartados:
<UL>
<LI>
<FONT SIZE=+1>connect</FONT>. Tiempo de espera m&aacute;ximo para el establecimiento
de la conexi&oacute;n SMTP.</LI>

<LI>
<FONT SIZE=+1>initial</FONT>. Tiempo de respuesta m&aacute;ximo para el
mensaje de bienvenida inicial.</LI>

<LI>
<FONT SIZE=+1>helo</FONT>. Tiempo de respuesta m&aacute;ximo para el comando
HELO o EHLO.</LI>

<LI>
<FONT SIZE=+1>mail</FONT>. Tiempo de respuesta m&aacute;ximo para un comando
MAIL.</LI>

<LI>
<FONT SIZE=+1>rcpt</FONT>. Tiempo de respuesta m&aacute;ximo a un comando
RCPT.</LI>

<LI>
<FONT SIZE=+1>datainit</FONT>. Tiempo de respuesta m&aacute;ximo a un comando
DATA.</LI>

<LI>
<FONT SIZE=+1>datablock</FONT>. Tiempo de espera m&aacute;ximo para la
lectura del cuerpo del mensaje.</LI>

<LI>
<FONT SIZE=+1>datafinal</FONT>. Tiempo de espera m&aacute;ximo a el punto
que termina un mensaje.</LI>

<LI>
<FONT SIZE=+1>rset</FONT>. Tiempo de respuesta m&aacute;ximo a un comando
RSET.</LI>

<LI>
<FONT SIZE=+1>quit</FONT>. Tiempo de respuesta m&aacute;ximo a un comando
QUIT.</LI>

<LI>
<FONT SIZE=+1>misc</FONT>. Tiempo de respuesta m&aacute;ximo a un comando
miscel&aacute;neo.</LI>

<LI>
<FONT SIZE=+1>command</FONT>. Actuando como servidor SMTP, tiempo de espera
de otro comando.</LI>

<LI>
<FONT SIZE=+1>ident</FONT>. Tiempo de espera para la respuesta a una consulta
IDENT.</LI>
</UL>
Para el establecimiento del tiempo a cada un de estos apartados, usamos
el mismo m&eacute;todo que usamos en la cola de correo. Por ejemplo, para
asignar un tiempo de establecimiento de conexi&oacute;n m&aacute;ximo de
3 minutos y medio utilizamos:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
O Timeout.connect=3m30s</FONT>
<BR>&nbsp;

<P><A NAME="Precedencia"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.5 Precedencia de mails</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; Mediante esta propiedad asignamos prioridad a los mensajes
segun entren en la cola. Cuanto m&aacute;s alto sea el n&uacute;mero de
precedencia de un mensaje, antes ser&aacute; procesado. Para definir la
precedencia de los mails utilizamos la siguiente sintaxis:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Pnombre=num</FONT>

<P>&nbsp;&nbsp;&nbsp; Cuando el campo "Precedence:" incluido en la cabecera
de un mensaje posea el valor "nombre", este mensaje poseer&aacute; una
precedencia de valor "num". La precedencia asignada por defecto es 0.
<BR>&nbsp;&nbsp;&nbsp; Un mail puede poseer una precedencia negativa, lo
que nos indicar&aacute; que el mensaje no deber&aacute; ser devuelto cuando
se produzca un error en el env&iacute;o. Esto es util para las listas de
correo, o para los mensajes de propaganda.

<P>&nbsp;&nbsp;&nbsp; Ejemplo:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Pfirst-class=0</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Pspecial-delivery=100</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Plist=-30</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Pbulk=-60</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Pjunk=-100</FONT>
<BR>&nbsp;

<P><A NAME="Trusted"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.6 Trusted Users</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; La definici&oacute;n de usuarios de confianza
o "Trusted Users" en nuestro fichero de configuraci&oacute;n implica que
dichos usuarios tendr&aacute;n la capacidad de mandar mails con nombres
falsos, sin que sendmail avise al receptor del mail.

<P>&nbsp;&nbsp;&nbsp; Para definirla:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Tnom1 [nom2 nom3 ...]</FONT>

<P>&nbsp;&nbsp;&nbsp; Donde nom1 es el nombre del usuario de confianza.

<P>Ejemplo:
<BR>&nbsp;&nbsp;&nbsp; Los usuarios de confianza m&aacute;s comunes de
un sistema:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Troot</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Tdaemon</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Tuucp</FONT>

<P>&nbsp;&nbsp;&nbsp; No es recomendable tener muchas (mejor ninguna) personas
en esta lista, ya que da lugar a abusos en el env&iacute;o de mails falsos.
La forma que tiene un usuario de cambiar la identidad de un mail es usando
el par&aacute;metro -f en la l&iacute;nea de comandos, por ejemplo:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cat fichero | sendmail -f fulano@xyz usuario

<P>&nbsp;&nbsp;&nbsp; Este comando manda un mail a "usuario", con el nombre
de remitente falso "fulano@xyz". Si el usuario que manda el mail no lo
tenemos como Trusted User en el fichero de configuraci&oacute;n de sendmail,
al leer el mail el remitente, tendr&aacute; una cabecera como &eacute;sta:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return-Path:
&lt;fulano@xyz></FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date: lo-que-sea</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X-Authentication-Warning:
&lt;Usuario real que manda el mail> set sender to fulano@xyz using -f</FONT>

<P>Esta &uacute;ltima l&iacute;nea ser&aacute; la que nos indica qui&eacute;n
manda realmente el mail, y es la l&iacute;nea que no nos aparecer&aacute;
si ese mismo usuario est&aacute; como Trusted User en el sendmail.cf.
<BR>&nbsp;

<P><A NAME="cabeceras"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.7 Formato de las cabeceras</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Formato de las l&iacute;neas de la cabecera de un
mail insertadas por sendmail. Definen qu&eacute; l&iacute;neas de cabecera
deben ser incluidas bas&aacute;ndose en los par&aacute;metros especificados
por el mailer y las l&iacute;neas ya existentes en el mensaje. La sintaxis
es la siguiente:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
H[?mflags?]hname:htemplate
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; hname indica el valor de la l&iacute;nea de cabecera.
<BR>&nbsp;&nbsp;&nbsp; htemplate hace referencia a una macro interna de
sendmail.
<BR>&nbsp;&nbsp;&nbsp; El par&aacute;metro mflags puede estar o no incluido
en la l&iacute;nea. Si est&aacute; incluido, indica que este par&aacute;metros
debe estar incluido en la definici&oacute;n del mailer para que la l&iacute;nea
se incluya en el mail. Para mayor informaci&oacute;n ver los par&aacute;metros
usados en la definici&oacute;n de mailers.

<P>&nbsp;&nbsp;&nbsp; Ejemplos:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#000000"><FONT SIZE=+1>H?P?Return-Path: &lt;$g></FONT></FONT>
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; La l&iacute;nea se incluir&aacute; en el mail si
el mailer posee el par&aacute;metro P. La l&iacute;nea que se incluir&aacute;
ser&aacute; la siguiente:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Return-Path: &lt;Direccion@del.remitente></FONT>

<P>&nbsp;

<P><A NAME="reglas"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.8 Las reglas de reescritura</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;&nbsp;&nbsp; La principal utilidad de las reglas de reescritura es
la modificaci&oacute;n de direcciones de correo seg&uacute;n convenga a
nuestro sistema. Las direcciones deben poder ser modificadas, porque pueden
ser especificadas de muchas formas, seg&uacute;n el tipo particular de
env&iacute;o que se utilice.
<BR>&nbsp;&nbsp;&nbsp; Por ejemplo, si queremos mandar un mail a juan@xyz,
y si &uacute;nicamente disponemos de acceso v&iacute;a modem a la m&aacute;quina
xyz, el mensaje deber&aacute; ser mandado con software UUCP. Este software
necesita que las direcciones sean expresadas de la forma: xyz!juan, por
lo que las reglas de reescritura de sendmail ser&aacute;n las encargadas
de transformar la direcci&oacute;n.
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Otra utilidad de las reglas de reescritura es la
detecci&oacute;n de errores en las direcciones introducidas. Esta detecci&oacute;n
se encarga de buscar y rechazar los errores en los mails locales, consiguiendo
asi que no se propage el error por toda las red. Por ejemplo, mandar un
mail sin nombre de usuario: @xyz ser&aacute; detectado localmente, en vez
de mandarlo y dejar que lo detecte la m&aacute;quina xyz.
<BR>&nbsp;

<P><B><FONT SIZE=+1>3.8.1 Los conjuntos de reglas de reescritura (Rewriting
rule sets)</FONT></B>

<P>&nbsp;&nbsp;&nbsp; Para utilizar estas reglas, existen los llamados
conjuntos de reglas de reescritura, que son una agrupaci&oacute;n de reglas.
Cada uno de estos conjuntos es similar a una subrutina de un lenguaje de
programaci&oacute;n. Para definir un conjunto de reglas utilizaremos la
letra "S" al comienzo de una linea del fichero de configuraci&oacute;n.

<P>&nbsp;&nbsp;&nbsp; Por ejemplo, S0 marca el comienzo de la declaraci&oacute;n
de las reglas que conforman el conjunto de reglas de reescritura 0.

<P>&nbsp;&nbsp;&nbsp; La declaraci&oacute;n de estos conjuntos de reglas
pueden aparecer en cualquier orden dentro del fichero de configuracion,
es decir, no importa si primero declaramos la S1, la S2, la S0 o cualquier
otra.

<P>Todas las l&iacute;neas por debajo de S0, ser&aacute;n reglas pertenecientes
a S0. Cuando aparezca una nueva S, comenzar&aacute; un nuevo conjunto de
reglas de reescritura.
<BR>&nbsp;

<P>Cada conjunto de reglas de reescritura tiene una funci&oacute;n espec&iacute;fica
dentro del sendmail.
<BR>Los conjuntos de reescritura S0 a S9 est&aacute;n reservados para uso
interno de sendmail.
<BR>Los dem&aacute;s conjuntos de reglas de reescritura ser&aacute;n subrutinas
llamadas por estas 6 primeras, o por un mailer que necesite reescribir
una determinada direcci&oacute;n en un determinado formato.

<P>Todos los mails pasan primero por el ruleset S3, que se encarga del
pre-procesamiento. Pone las direcciones de manera estandard para el correcto
manejo de las direcciones por S0.
<BR>S0 se encarga de decidir el mailer correspondiente para un determinado
mail
<BR>Seg&uacute;n el mailer especificado por S0, a cada mail se le aplicaran
el conjunto de reglas de reescritura definidos para ese mailer.
<BR>S4 se encarga de deshacer los cambios realizados por S3. Las direcciones
se quedan de la manera correcta para que el mail pueda ser enviado.&nbsp;

<P>En la siguiente tabla vemos un resumen de las funciones de cada conjunto
de reglas de reescritura:
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD>S0</TD>

<TD>Es el conjunto de reglas de reescritura encargada del reparto de mensajes.&nbsp;
<BR>Manipula la direcci&oacute;n del destinatario en la cubierta del mail..&nbsp;
<BR>Necesita una direcci&oacute;n en formato interno:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
usuario&lt;@m&aacute;quina.dominio>&nbsp;
<BR>Elimina de las direcciones la m&aacute;quina local (si es una direcci&oacute;n
local).&nbsp;
<BR>Decide c&oacute;mo enviar el mail bas&aacute;ndose en el formato de
la direcci&oacute;n.</TD>
</TR>

<TR>
<TD>S1</TD>

<TD>Conjunto de reglas de reescritura del remitente usado por todos los
mailers (normalmente vac&iacute;o).</TD>
</TR>

<TR>
<TD>S2</TD>

<TD>Conjunto de reglas de reescritura del destinatario usado por todos
los mailers (normalmente vac&iacute;o).</TD>
</TR>

<TR>
<TD>S3</TD>

<TD>Se encarga del pre-procesamiento.&nbsp;
<BR>Pone el foco &lt;> en el correcto lugar de la direccion, que sera usado
posteriormente por S0. Es decir:&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
usuario&lt;@m&aacute;quina.dominio>&nbsp;
<BR>Estandariza las direcciones para que sean del estilo correcto (con
@).</TD>
</TR>

<TR>
<TD>S4</TD>

<TD>Se encarga del post-procesamiento. Su misi&oacute;n es:&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Quitar el foco &lt;>.&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Se deshacen las transformaciones de formato
realizadas por S3.&nbsp;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Convierte la direcci&oacute;n a la forma exterior
si ha de salir de la red local</TD>
</TR>

<TR>
<TD>S5</TD>

<TD>Reescribe direcciones despues del aliasing local, pero antes del reparto
local.&nbsp;
<BR>Todas las direcciones de usuario para un mailer local que no empiezan
con una @, pasan por S5.&nbsp;
<BR>Permite la selecci&oacute;n de un mailer, host, user diferente despues
del aliasing.</TD>
</TR>

<TR>
<TD>S96</TD>

<TD>Es la segunda mitad del conjunto de reglas S3 para algunos ficheros
de configuraci&oacute;n.</TD>
</TR>
</TABLE>
&nbsp;

<P><B><FONT SIZE=+1>3.8.2 La parte izquierda y derecha de una regla (Left-hand-side
&amp; Right-hand-side)</FONT></B>

<P>&nbsp;&nbsp;&nbsp; Dentro de estos conjuntos de reglas de reescritura,
podemos encontrarnos con muchas reglas individuales, o con ninguna. Estas
reglas interiores comienzan con la letra "R" y siguen el siguiente patr&oacute;n:
<BR>&nbsp;
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>&nbsp;&nbsp;&nbsp;
S0</B></FONT>
<BR><B><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Rlhs&nbsp;&nbsp;&nbsp; &lt;TAB </FONT></B>(1 o m&aacute;s)<B><FONT SIZE=+1>>&nbsp;&nbsp;&nbsp;
rhs&nbsp;&nbsp;&nbsp; &lt;TAB </FONT></B>(1 o m&aacute;s)<B><FONT SIZE=+1>>&nbsp;&nbsp;&nbsp;
comentario(opcional)</FONT></B>

<P>&nbsp;&nbsp;&nbsp;<FONT SIZE=+1><B> </B><U>lhs</U></FONT><U> es una
abreviatura de left-hand-side, o parte izquierda.</U> Este es el modelo
o patr&oacute;n en el que buscaremos la coincidencia de las direcciones
que se introduzcan.

<P>&nbsp;&nbsp;&nbsp; <U><FONT SIZE=+1>rhs</FONT> es una abreviatura de
right-hand-side, o parte derecha.</U> Si la entrada ha coincidido con la
parte izquierda, &eacute;sta ser&aacute; reescrita al formato que posea
esta parte derecha.

<P>Ejemplo:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>
S0</B></FONT>
<BR><B><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Rhello&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
bye</FONT></B>

<P>&nbsp;&nbsp;&nbsp; En este ejemplo, al aplicar el conjunto de reglas
de reescritura S0, siempre que se encuentre con la palabra "hello" se reescribir&aacute;
con "bye.

<P>&nbsp;&nbsp;&nbsp; Como podemos ver en el ejemplo, las letras normales
tienen una correspondencia directa tanto en la <FONT SIZE=+1>lhs</FONT>
como en la <FONT SIZE=+1>rhs</FONT>.

<P>&nbsp;&nbsp;&nbsp; Para conjuntos de letras o de tokens, podemos utilizar
los siguientes operadores especiales en la <FONT SIZE=+1>lhs</FONT> (llamados
Metas&iacute;mbolos):
<BR>&nbsp;
<BR>&nbsp;
<CENTER><TABLE BORDER WIDTH="50%" BGCOLOR="#C0C0C0" >
<TR>
<TD>$*</TD>

<TD>Correspondencia entre 0 o m&aacute;s tokens.</TD>
</TR>

<TR>
<TD>$+</TD>

<TD>Correspondencia entre 1 o m&aacute;s tokens.</TD>
</TR>

<TR>
<TD>$-</TD>

<TD>Correspondencia de exactamente 1 token.</TD>
</TR>

<TR>
<TD>$X</TD>

<TD>Correspondencia con la macro X</TD>
</TR>

<TR>
<TD>$=x</TD>

<TD>Correspondencia con cualquier palabra en la Clase x.</TD>
</TR>

<TR>
<TD>$~x</TD>

<TD>Correspondencia con ninguna palabra en la Clase x.</TD>
</TR>
</TABLE></CENTER>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Y los siguientes Metas&iacute;mbolos (para hacer
la sustituci&oacute;n) en la<FONT SIZE=+1> rhs</FONT>:
<BR>&nbsp;
<CENTER><TABLE BORDER WIDTH="50%" BGCOLOR="#C0C0C0" >
<TR>
<TD>$n</TD>

<TD>Correspondiente valor del Metas&iacute;mbolo encontrado en la posici&oacute;n
"n" del <FONT SIZE=+1>lhs</FONT>.</TD>
</TR>

<TR>
<TD>$[name$]</TD>

<TD>Nombre canonicalizado.</TD>
</TR>

<TR>
<TD>$>n</TD>

<TD>Lo que queda de l&iacute;nea se pasa al conjunto de reglas "n" para
que lo procese.</TD>
</TR>

<TR>
<TD>$X</TD>

<TD>Valor de la macro X</TD>
</TR>

<TR>
<TD>$:</TD>

<TD>Aplica la acci&oacute;n una &uacute;nica vez, sin iterar. Va directamente
a la siguiente regla despues de aplicar &eacute;sta.</TD>
</TR>

<TR>
<TD>$@</TD>

<TD>Devuelve el resultado de esta acci&oacute;n. S&oacute;lo puede ir al
principio de la l&iacute;nea.</TD>
</TR>
</TABLE></CENTER>
&nbsp;

<P>Estos metas&iacute;mbolos s&oacute;lo pueden ser utilizadas por la regla
de reescritura S0:
<BR>&nbsp;
<CENTER><TABLE BORDER WIDTH="50%" BGCOLOR="#C0C0C0" >
<TR>
<TD>$#mailer</TD>

<TD>Especificaci&oacute;n del agente de reparto de mails.</TD>
</TR>

<TR>
<TD>$@host</TD>

<TD>Espeficicaci&oacute;n de la m&aacute;quina.</TD>
</TR>

<TR>
<TD>$:user</TD>

<TD>Especifiaci&oacute;n de el usuario.</TD>
</TR>
</TABLE></CENTER>
&nbsp;
<BR>&nbsp;

<P>Ejemplo 1:
<BR>&nbsp;
<BR>La siguiente LHS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT SIZE=+1>
R$-@$*</FONT>
<BR>&nbsp;&nbsp;&nbsp; ante la entrada "al001010@alumail.uji.es", en la
RHS tendremos:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $1 = "al001010"
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $2 = "alumail.uji.es"

<P>Ejemplo 2:
<BR>La siguiente regla:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>R$-@$*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
juan@$2</FONT>
<BR>&nbsp;&nbsp;&nbsp; ante la entrada "al001010@alumail.uji.es", producira
la salida "juan@alumail.uji.es"

<P>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; La lhs y la rhs forman una estructura de tipo bucle
"do-while". Es decir, mientras la lhs evalue direcciones y la evaluaci&oacute;n
sea cierta, se procesar&aacute; la rhs. S&oacute;lo si lhs se evalua como
falsa, sendmail pasa a la siguiente regla de ese conjunto de reglas.

<P>&nbsp;&nbsp;&nbsp; Cuando un conjunto de reglas contiene varias reglas
individules, el flujo es de la primera a la &uacute;ltima regla, en el
orden que son declaradas en el fichero de configuraci&oacute;n. Por ejemplo:
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
S0</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Rx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Ry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; z</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Rz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a</FONT>
<BR>En este ejemplo, siempre que metamos como direci&oacute;n una "x",
"y", o una "z", el resultado ser&aacute; siempre una "a", debido al flujo.
<BR>&nbsp;

<P><B><FONT SIZE=+1>3.8.3 Los separadores de tokens</FONT></B>
<BR><B><FONT SIZE=+1>&nbsp;</FONT></B>
<BR><B><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; </FONT></B>Para conseguir separar
unos tokens de otros, necesitamos definir unos separadores que nos marquen
el l&iacute;mite entre un token y otro. Sendmail posee 10 separadores que
son internos, y ya est&aacute;n definidos:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>(&nbsp;&nbsp;&nbsp; )&nbsp;&nbsp;&nbsp; &lt;&nbsp;&nbsp;&nbsp;
>&nbsp;&nbsp;&nbsp; ,&nbsp;&nbsp;&nbsp; ;&nbsp;&nbsp;&nbsp; \&nbsp;&nbsp;&nbsp;
"&nbsp;&nbsp;&nbsp; \r&nbsp;&nbsp;&nbsp; \n</FONT>

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp; </FONT>Podemos definir nosotros mismos
los separadores que queremos que utilice sendmail mediante la macro "o".
Por ejemplo:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Do.:%@!^=/[]</FONT>
<BR>&nbsp;

<P>Por ejemplo, si "@" esta en la macro $o, ante una entrada "a@b", sendmail
la separar&aacute; en 3 tokens: "a", "@" y "b"
<BR>&nbsp;

<P><B><FONT SIZE=+1>3.8.4 Como probar nuestras propias reglas de reescritura</FONT></B>

<P>&nbsp;&nbsp;&nbsp; Existe un m&eacute;todo sencillo con el que podemos
hacer pruebas con reglas de escritura creadas por nosotros, sin necesidad
de modificar el fichero de configuraci&oacute;n. Para utilizarlo, primero
creamos un fichero de configuraci&oacute;n m&iacute;nimo, que no har&aacute;
nada:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Mlocal,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A=x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
P=X</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Mprog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A=x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
P=X</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Do.:%@!^=/[]</FONT>

<P>debajo de estas l&iacute;neas del fichero, ya podemos incluir nuestras
reglas, por ejemplo:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Mlocal,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A=x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
P=X</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Mprog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A=x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
P=X</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Do.:%@!^=/[]</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
S0</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
R$+@$+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $2!$1</FONT>

<P>Si hemos llamado a este fichero, por ejemplo, test.cf, podemos ejecutar
sendmail en modo test, introduciendo el n&uacute;mero de regla a aplicar
y una direcci&oacute;n para que sendmail nos devuelva el resultado de la
aplicaci&oacute;n de dicha regla. La salida ser&iacute;a la siguiente:

<P><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
#sendmail&nbsp;&nbsp;&nbsp; -oQ/tmp&nbsp;&nbsp;&nbsp; -Ctest.cf&nbsp;&nbsp;&nbsp;
-bt</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ADDRES TEST MODE (ruleset 3 NOT automatically invoked)</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Enter &lt;ruleset> &lt;address></FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> 0 juan@xyz</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
rewrite: ruleset&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; input: "juan" "@"
"xyz"</FONT>
<BR><FONT SIZE=+1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
rewrite: ruleset&nbsp;&nbsp;&nbsp; 0 returns: "xyz" "!" "juan"</FONT>
<BR>&nbsp;

<P>&nbsp;
<BR><B><FONT SIZE=+1>3.8.5 Ejemplos de reglas de reescritura extraidas
del fichero de configuraci&oacute;n de LINUX</FONT></B>

<P><FONT COLOR="#000000">Vamos a comentar algunos conjuntos de reglas de
reescritura usados por los mailers del fichero de configuraci&oacute;n
del Linux.</FONT>

<P>Esta es un conjunto de reglas de reescritura utilizado por el repartidor
local de Linux:

<P><FONT COLOR="#FF0000">#</FONT>
<BR><FONT COLOR="#FF0000">#&nbsp; Reescritura de las direcciones de la
envoltura del remitente</FONT>
<BR><FONT COLOR="#FF0000">#</FONT>
<BR><FONT FACE="Courier New,Courier">S10</FONT>
<BR><FONT FACE="Courier New,Courier">R&lt;@>&nbsp;&nbsp; $n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#FF0000"><FONT SIZE=-1>Si hay error, lo mandar&aacute; al
MAILER-DEMON (macro $n)</FONT></FONT></FONT>
<BR><FONT FACE="Courier New,Courier">R$+&nbsp;&nbsp;&nbsp; $: $>50 $1&nbsp;&nbsp;
<FONT COLOR="#FF0000"><FONT SIZE=-1>Llama a la S50 que a&ntilde;adira el
dominio local si lo necesita</FONT></FONT></FONT>
<BR><FONT FACE="Courier New,Courier">R$*&nbsp;&nbsp;&nbsp; $: $>94 $1&nbsp;&nbsp;
<FONT COLOR="#FF0000"><FONT SIZE=-1>Llama a la S94 para hacer masquerading</FONT></FONT></FONT>

<P><FONT COLOR="#FF0000">#</FONT>
<BR><FONT COLOR="#FF0000">#&nbsp; Reescritura de las direcciones de la
envoltura del destinatario</FONT>
<BR><FONT COLOR="#FF0000">#</FONT>
<BR><FONT FACE="Courier New,Courier">S20</FONT>
<BR><FONT FACE="Courier New,Courier">R$+ &lt; @ $* >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$: $1&nbsp;&nbsp; <FONT SIZE=-1><FONT COLOR="#FF0000">Extrae unicamente
el nombre de la maquina</FONT></FONT></FONT><FONT SIZE=-1></FONT>

<P><FONT COLOR="#FF0000">#</FONT>
<BR><FONT COLOR="#FF0000">#&nbsp; Reescritura de las direcciones de la
cabecera del remitente</FONT>
<BR><FONT COLOR="#FF0000">#</FONT>
<BR><FONT FACE="Courier New,Courier">S30</FONT>
<BR><FONT FACE="Courier New,Courier">R&lt;@>&nbsp; $n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#FF0000"><FONT SIZE=-1>Manda los errores al demonio (macro
$n)</FONT></FONT></FONT>
<BR><FONT FACE="Courier New,Courier">R$+&nbsp;&nbsp; $: $>50 $1&nbsp; <FONT SIZE=-1><FONT COLOR="#FF0000">Llama
a la S50 que a&ntilde;adira el dominio local si lo necesita</FONT></FONT></FONT><FONT SIZE=-1></FONT>
<BR><FONT FACE="Courier New,Courier">R$*&nbsp;&nbsp; $: $>93 $1&nbsp; <FONT COLOR="#FF0000"><FONT SIZE=-1>Llama
a la S93 para hacer masquerading</FONT></FONT></FONT>

<P><FONT COLOR="#FF0000">#</FONT>
<BR><FONT COLOR="#FF0000">#&nbsp; Reescritura de las direcciones de la
cabecera del destinatario</FONT>
<BR><FONT COLOR="#FF0000">#</FONT>
<BR><FONT FACE="Courier New,Courier">S40</FONT>
<BR><FONT FACE="Courier New,Courier">R$+&nbsp;&nbsp;&nbsp; $: $>50 $1&nbsp;
<FONT SIZE=-1><FONT COLOR="#FF0000">Llama a la S50 que a&ntilde;adira el
dominio local si lo necesita</FONT></FONT></FONT><FONT SIZE=-1></FONT>
<BR><FONT FACE="Courier New,Courier">#R$*&nbsp;&nbsp; $: $>93 $1&nbsp;
<FONT COLOR="#FF0000"><FONT SIZE=-1>Llama a la S93 para hacer all-masquerading</FONT></FONT></FONT>

<P><FONT COLOR="#FF0000">#</FONT>
<BR><FONT COLOR="#FF0000">#&nbsp; Subrutina que a&ntilde;ade el nombre
del dominio local a una direcci&oacute;n local (si lo necesita)</FONT>
<BR><FONT COLOR="#FF0000">#</FONT>
<BR><FONT FACE="Courier New,Courier">S50</FONT>
<BR><FONT FACE="Courier New,Courier">R$* &lt; @ $* > $*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$@ $1 &lt; @ $2 > $3&nbsp;&nbsp;&nbsp; <FONT COLOR="#FF0000"><FONT SIZE=-1>(ya
pose&iacute;a el formato correcto)</FONT></FONT></FONT>
<BR><FONT FACE="Courier New,Courier">R$+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$@ $1 &lt; @ *LOCAL* >&nbsp; <FONT COLOR="#FF0000"><FONT SIZE=-1>(a&ntilde;ade
el dominio local)</FONT></FONT></FONT>

<P>&nbsp;

<P><A NAME="mailers"></A>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=1 WIDTH="100%" BGCOLOR="#000066" >
<TR>
<TD><B><FONT COLOR="#FFFFFF"><FONT SIZE=+1>3.9 Definici&oacute;n de mailers</FONT></FONT></B></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Otro de los puntos a configurar en el fichero sendmail.cf
son los agentes de transporte (mailers) y la forma en que sendmail se comunicara
con cada uno de ellos. El formato para definirlos es el siguiente:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Mnombre, {campo=valor}</FONT>

<P>&nbsp;&nbsp;&nbsp; donde nombre es un nombre arbitrario usado internamente
por sendmail para referirse a ese "mailer"; y la pareja "campo=valor" definen
los atributos de ese "mailer".
<BR>&nbsp;

<P><B><FONT SIZE=+1>3.9.1 Campos m&aacute;s comunes en la definici&oacute;n
de mailers</FONT></B>

<P>Los campos m&aacute;s importantes para definir los atributos de un "malier"
son los siguientes:
<BR>&nbsp;
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD><FONT SIZE=+1>P</FONT></TD>

<TD>Path</TD>

<TD>Directorio donde se encuentra el agente de transporte.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>F</FONT></TD>

<TD>Flags</TD>

<TD>Par&aacute;metros especiales de el agente de transporte.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>S</FONT></TD>

<TD>Sender</TD>

<TD>N&uacute;mero de conjunto de reglas&nbsp; que se le aplica a las direcciones
del remitente</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>R</FONT></TD>

<TD>Recipient</TD>

<TD>N&uacute;mero de conjunto de reglas&nbsp; que se le aplica a las direcciones
del destinatario</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>A</FONT></TD>

<TD>Argv</TD>

<TD>Argumentos para el mailer.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>E</FONT></TD>

<TD>Eol</TD>

<TD>Fin de l&iacute;nea usado por el mailer.</TD>
</TR>

<TR>
<TD><FONT SIZE=+1>M</FONT></TD>

<TD>Maxsize</TD>

<TD>Longitud m&aacute;xima del mensaje.</TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;<B><FONT SIZE=+1>3.9.2 Par&aacute;metros m&aacute;s comunes en
la definici&oacute;n de mailers</FONT></B>

<P>&nbsp;&nbsp;&nbsp; El campo F nos permite definir los par&aacute;metros
que usar&aacute; sendmail con ese mailer espec&iacute;fico. Los par&aacute;metros
m&aacute;s utilizados son los siguientes:
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD>C</TD>

<TD>A&ntilde;ade @dominio a aquiellas direcciones que son introducidas
sin @.</TD>
</TR>

<TR>
<TD>D</TD>

<TD>El agente de transporte necesita una l&iacute;nea en la cabecera del
mail de fecha ("Date:").</TD>
</TR>

<TR>
<TD>E</TD>

<TD>A&ntilde;ade ">" a las l&iacute;neas del mensaje que comienzan por
"From:" (Para no confundirlas con la cabecera).</TD>
</TR>

<TR>
<TD>e</TD>

<TD>El mailer realiza una conexi&oacute;n cara, por lo que intenta no conectar
normalmente, sino que intentar&aacute; el env&iacute;o cuando se procese
la cola de correo.</TD>
</TR>

<TR>
<TD>F</TD>

<TD>El mailer necesita una l&iacute;nea de cabecera con "From:".</TD>
</TR>

<TR>
<TD>I</TD>

<TD>El mailer establecer&aacute; una conexi&oacute;n SMTP con otro sendmail
para transmitir los mails.</TD>
</TR>

<TR>
<TD>l</TD>

<TD>El mailer es local. Para reparto de correo local.</TD>
</TR>

<TR>
<TD>m</TD>

<TD>El mailer puede mandar mensajes a varios usuarios de una misma m&aacute;quina
en una sola transacci&oacute;n.</TD>
</TR>

<TR>
<TD>M</TD>

<TD>El mailer necesita una l&iacute;nea de cabecera "Message-Id:".</TD>
</TR>

<TR>
<TD>n</TD>

<TD>No insertar una l&iacute;nea "From:" (estilo UNIX) en el mensaje).</TD>
</TR>

<TR>
<TD>P</TD>

<TD>El mailer necesita una l&iacute;nea de cabecera "Return-Path.".</TD>
</TR>

<TR>
<TD>R</TD>

<TD>Abrir las conexiones SMTP desde un puerto seguro.</TD>
</TR>

<TR>
<TD>s</TD>

<TD>quita las comillas de la direcci&oacute;n antes de llamar al mailer.</TD>
</TR>

<TR>
<TD>S</TD>

<TD>No resetear el identificador de usuario antes de llamar al mailer.
Esto se usa en entornos seguros donde sendmail se ejecuta con permisos
de root.</TD>
</TR>

<TR>
<TD>x</TD>

<TD>El mailer necesita una l&iacute;nea de cabecera "Full-Name:".</TD>
</TR>

<TR>
<TD>0</TD>

<TD>No buscar registros MX para mails mandados a m&aacute;quinas via SMTP..</TD>
</TR>
</TABLE>
&nbsp;

<P>&nbsp;<B><FONT SIZE=+1>3.9.3 Ejemplos de definici&oacute;n de mailers</FONT></B>

<P>&nbsp;&nbsp;&nbsp; El mailer definido con el nombre "local" es obligatorio
en todo fichero de configuraci&oacute;n. Es el repartidor de correo local:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Mlocal,&nbsp;&nbsp;&nbsp; P=/bin/mail,&nbsp;&nbsp;&nbsp;
F=lsDFMmn,&nbsp;&nbsp;&nbsp; S=10,&nbsp;&nbsp;&nbsp; R=20,&nbsp;&nbsp;&nbsp;
A=mail -d $u</FONT>
<BR>&nbsp;
<BR>&nbsp;&nbsp;&nbsp; Otro mailer que es obligado definir es un programa
(shell), siempre llamado "prog":
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT SIZE=+1>Mprog,&nbsp;&nbsp;&nbsp; P=/bin/sh,&nbsp;&nbsp;&nbsp; F=lsDFMe,&nbsp;&nbsp;&nbsp;
S=10,&nbsp;&nbsp;&nbsp; R=20,&nbsp;&nbsp;&nbsp; A=sh -c $u</FONT>

<P>&nbsp;&nbsp;&nbsp; Algunos mailers son definidos dentro del propio sendmail:
<UL>
<LI>
Un mailer definido con el nombre "error", que se usar&aacute; para generar
un error de usuario.</LI>

<LI>
Un mailer con el nombre "file" para mandar mails a ficheros.</LI>

<LI>
Un mailer con el nombre ":include:", para mandar mails a listas :include:..</LI>
</UL>
&nbsp;&nbsp;&nbsp; Todos los restantes mailers son definidos por el usuario,
incluidos los agentes de transporte SMTP.
<BR>&nbsp;

<P><B><FONT SIZE=+1>3.9.4 La definici&oacute;n del mailers en el fichero
de configuraci&oacute;n de LINUX</FONT></B>

<P><FONT COLOR="#000000">Estos son los mailers especificados en el fichero
de configuraci&oacute;n de Linux. Podemos observar tanto el repartidor
local, el shell y los agentes de transporte SMTP. Est&aacute; comentado
el primero, los restantes son muy parecidos.</FONT>
<BR>&nbsp;

<P><FONT COLOR="#CC0000"># El procmail es el repartidor de mails locales.</FONT>
<BR><FONT COLOR="#CC0000"># Las reglas de reescritura aplicadas al remitente
son 10 y 30</FONT>
<BR><FONT COLOR="#CC0000"># Las reglas de reescritura aplicadas al destinatario
son 20 y 40</FONT>
<BR><FONT COLOR="#CC0000"># Los argumentos pasados al programa en la l&iacute;nea
de comandos son:</FONT>
<BR><FONT COLOR="#CC0000"># procmail -a &lt;maquina destinataria> -d &lt;usuario
destinatario></FONT>

<P><FONT COLOR="#000000">Mlocal,&nbsp; P=/usr/bin/procmail, F=lsDFMAw5:/|@qShP,
S=10/30, R=20/40,</FONT>
<BR>T=DNS/RFC822/X-Unix,
<BR><FONT COLOR="#000000">&nbsp; A=procmail -a $h -d $u</FONT>
<BR>&nbsp;

<P><FONT COLOR="#000000">Mprog,&nbsp; P=/bin/sh, F=lsDFMoqeu9, S=10/30,
R=20/40, D=$z:/,</FONT>
<BR><FONT COLOR="#000000">&nbsp; T=X-Unix,</FONT>
<BR><FONT COLOR="#000000">&nbsp; A=sh -c $u</FONT>
<BR>&nbsp;
<BR><FONT COLOR="#000000">Msmtp,&nbsp; P=[IPC], F=mDFMuX, S=11/31, R=21,
E=\r\n, L=990,</FONT>
<BR><FONT COLOR="#000000">&nbsp; T=DNS/RFC822/SMTP,</FONT>
<BR><FONT COLOR="#000000">&nbsp; A=IPC $h</FONT>

<P><FONT COLOR="#000000">Mesmtp,&nbsp; P=[IPC], F=mDFMuXa, S=11/31, R=21,
E=\r\n, L=990,</FONT>
<BR><FONT COLOR="#000000">&nbsp; T=DNS/RFC822/SMTP,</FONT>
<BR><FONT COLOR="#000000">&nbsp; A=IPC $h</FONT>

<P><FONT COLOR="#000000">Msmtp8,&nbsp; P=[IPC], F=mDFMuX8, S=11/31, R=21,
E=\r\n, L=990,</FONT>
<BR><FONT COLOR="#000000">&nbsp; T=DNS/RFC822/SMTP,</FONT>
<BR><FONT COLOR="#000000">&nbsp; A=IPC $h</FONT>

<P><FONT COLOR="#000000">Mrelay,&nbsp; P=[IPC], F=mDFMuXa8, S=11/31, R=61,
E=\r\n, L=2040,</FONT>
<BR><FONT COLOR="#000000">&nbsp; T=DNS/RFC822/SMTP,</FONT>
<BR><FONT COLOR="#000000">&nbsp; A=IPC $h</FONT>
<BR><FONT COLOR="#000000">&nbsp;</FONT>
<BR><FONT COLOR="#000000">&nbsp;</FONT>&nbsp;
<HR WIDTH="100%">
<BR><FONT SIZE=+3>1. Links interesantes</FONT>
<BR>&nbsp;
<TABLE BORDER WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR>
<TD>Pagina oficial de sendmail</TD>

<TD><A HREF="http://www.sendmail.org">http://www.sendmail.org</A>&nbsp;
<BR>&nbsp;</TD>
</TR>

<TR>
<TD>Grupo de discusi&oacute;n de sendmail</TD>

<TD>comp.mail.sendmail&nbsp;</TD>
</TR>

<TR>
<TD>Lista de correo moderada de sendmail</TD>

<TD>Enviar un mail a: majordomo@lists.sendmail.ORG con el mensaje:&nbsp;
<BR>"suscribe sendmail-anounce"</TD>
</TR>

<TR>
<TD>Libro oficial de sendmail escrito por:&nbsp;
<BR>Bryan Costales&nbsp;
<BR>Eric Allman&nbsp;
<BR>Neil Richert</TD>

<TD><A HREF="http://www.sendmail.org">http://</A><A HREF="www.ora.com/catalog/sendmail2">www.ora.com/catalog/sendmail2</A></TD>
</TR>

<TR>
<TD>Manual de sendmail:&nbsp;
<BR>"Sendmail Installation and Operation Guide"</TD>

<TD><A HREF="http://www.informatik.uni-kiel.de/%7Eca/email/english.html">http://www.informatik.uni-kiel.de/%7Eca/email/english.html</A></TD>
</TR>

<TR>
<TD>Articulo sobre sendmail:&nbsp;
<BR>"Unix World Online: Tutorial 008: Sendmail V8: A"</TD>

<TD><A HREF="http://www.informatik.uni-kiel.de/%7Eca/email/english.html">http://</A><A HREF="http://www.wcmh.com/uworld/archives/95/tutorial/008/008.txt.html">www.wcmh.com/uworld/archives/95/tutorial/008/008.txt.html</A></TD>
</TR>

<TR>
<TD>FAQ de sendmail</TD>

<TD><A HREF="http://www.informatik.uni-kiel.de/%7Eca/email/english.html">http://</A><A HREF="http://www.informatik.uni-kiel.de/%7Eca/faqs/sendmailv8.html">www.informatik.uni-kiel.de/%7Eca/faqs/sendmailv8.html</A></TD>
</TR>

<TR>
<TD>Introducci&oacute;n a sendmail y tutorial de sendmail en modo traza,
por Christian Hallquist&nbsp;</TD>

<TD><A HREF="http://www.informatik.uni-kiel.de/%7Eca/email/english.html">http://</A><A HREF="http://www.ethz.ch/ETH/ID/KS.html.docs/sendmail.html">www.ethz.ch/ETH/ID/KS.html.docs/sendmail.html</A></TD>
</TR>

<TR>
<TD>C&oacute;digo fuente de sendmail</TD>

<TD><A HREF="ftp://ftp.sendmail.org/pub/sendmail">ftp://ftp.sendmail.org/pub/sendmail</A></TD>
</TR>

<TR>
<TD>Todo tipo de enlaces relacionados sobre sendmail:&nbsp;
<BR>"Harker's sendmail References Page"</TD>

<TD><A HREF="http://www.informatik.uni-kiel.de/%7Eca/email/english.html">http://</A><A HREF="http://www.harker.com/sendmail/sendmail-ref.html">www.harker.com/sendmail/sendmail-ref.html</A></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;

<P>&nbsp;
</BODY>
</HTML>
