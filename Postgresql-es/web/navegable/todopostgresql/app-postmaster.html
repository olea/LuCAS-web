<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>   postmaster
  </TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="PostgreSQL"
HREF="postgres.html"><LINK
REL="UP"
TITLE="Aplicaciones del sistema"
HREF="utilities.html"><LINK
REL="PREVIOUS"
TITLE="   postgres
  "
HREF="app-postgres.html"><LINK
REL="NEXT"
TITLE="Guía del Administrador"
HREF="part-admin.html"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="app-postgres.html"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="part-admin.html"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="APP-POSTMASTER"
><TT
CLASS="APPLICATION"
>postmaster</TT
></A
></H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN14506"
></A
><H2
>Nombre</H2
>   <TT
CLASS="APPLICATION"
>postmaster</TT
>
  &nbsp;--&nbsp;   Ejecuta el servidor (backend)multiusuario de 
<SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>
  </DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN14511"
></A
><H2
>Synopsis</H2
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SYNOPSIS"
>postmaster [ -B <TT
CLASS="REPLACEABLE"
><I
>nBuffers</I
></TT
> ] [ -D 
<TT
CLASS="REPLACEABLE"
><I
>DataDir</I
></TT
> ] [ -i ] [ -l ]
postmaster [ -B <TT
CLASS="REPLACEABLE"
><I
>nBuffers</I
></TT
> ] [ -D 
<TT
CLASS="REPLACEABLE"
><I
>DataDir</I
></TT
> ] [ -N <TT
CLASS="REPLACEABLE"
><I
>nBackends</I
></TT
> ] [ -S ]
   [ -d [ <TT
CLASS="REPLACEABLE"
><I
>DebugLevel</I
></TT
> ] [ -i ] [ 
-l ] [ -o <TT
CLASS="REPLACEABLE"
><I
>BackendOptions</I
></TT
> ] [ -p 
<TT
CLASS="REPLACEABLE"
><I
>port</I
></TT
> ]
postmaster [ -n | -s ] ...
  </PRE
></TD
></TR
></TABLE
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-POSTMASTER-1"
></A
><H3
>    Inputs
   </H3
><P
>    <TT
CLASS="APPLICATION"
>postmaster</TT
> acepta los siguientes 
parámetros en su línea de comandos:
    
    <P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>-B <TT
CLASS="REPLACEABLE"
><I
>nBuffers</I
></TT
></DT
><DD
><P
>	Indica el número de buffers de memoria compartida que
	<TT
CLASS="APPLICATION"
>postmaster</TT
>asignar  y administrará 
	para los procesos del servidor que inice. El valor predeterminado para
	esta opción es 64 buffers, siendo cada buffer de 8 kilobytes
	(o lo que sea que esté indicado en BLCKSZ en config.h).
       </P
></DD
><DT
>-D <TT
CLASS="REPLACEABLE"
><I
>DataDir</I
></TT
></DT
><DD
><P
>	Especifica el directorio a usar como raíz del arbol de directorios
	de bases de datos. Si no se especifica -D, el nombre de directorio
	predeterminado es el valor de la variable de entorno 
	<TT
CLASS="ENVAR"
>PGDATA</TT
>.
	Si <TT
CLASS="ENVAR"
>PGDATA</TT
> no está especificada, entonces se utiliza
	el directorio <TT
CLASS="FILENAME"
>$POSTGRESHOME/data</TT
>.
	Si no se especifica ni la variable de entorno ni esta opció de 
	línea de comando, el directorio predeterminado es el utilizado
	al momento de la compilación.	
       </P
></DD
><DT
>-N <TT
CLASS="REPLACEABLE"
><I
>nBackends</I
></TT
></DT
><DD
><P
>	El máximo número de procesos en el servidor (backend) que
	postmaster tiene permitido iniciar. En la configuración 
	predeterminada este valor está usualmente definido en 32, y puede
	ser fijado hasta un valor máximo de 1024 si su sistema puede
	soportar esa cantidad de procesos. Tanto el valor predeterminado como el
	máximo puede modificarse cuando se compila  
	<SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> (vea el archivo src/include/config.h)
       </P
></DD
><DT
>-S</DT
><DD
><P
>	Indica que el proceso de <TT
CLASS="APPLICATION"
>postmaster</TT
> debe 
	iniciarse en modo silencioso. Esto es, anulará la 
	vinculación con la terminal del usuario (que tiene el control) e 
	iniciará su propio grupo de proceso. Esta opción
	no debería utilizarse en conjunto con las opciones de 
	depuración ya que cualquier mensaje enviado a la salida 
	estándar y a la salida de error estándar serán 
	descartados.
       </P
></DD
><DT
>-d [ <TT
CLASS="REPLACEABLE"
><I
>DebugLevel</I
></TT
> 
]</DT
><DD
><P
>	Este argumento <TT
CLASS="REPLACEABLE"
><I
>DebugLevel</I
></TT
>
	determina la cantidad de información de depuración que
	producirá el servidor.
	Si <TT
CLASS="REPLACEABLE"
><I
>DebugLevel</I
></TT
> es uno, 
	postmaster rastreará todo el tráfico de conexión
	y nada más.
	Para niveles iguales o mayores a 2 se activa la depuración y el
	proceso del servidor y postmaster muestran más información,
	incluyendo el entorno del servidor y tráfico de proceso.
	Note que si no se especifica ningún archivo para que los 
	servidores del backend envíen su información, esta 
	información será exhibida en la terminal de su proceso
	<TT
CLASS="APPLICATION"
>postmaster</TT
> padre.
       </P
></DD
><DT
>-i</DT
><DD
><P
>	Esta opción habilita las comunicaciones mediante TCP/IP o mediante 
	el socket de dominio Internet. Sin esta opción solamente es 	posible la comunicación a través del socket de dominio  	Unix local.	
       </P
></DD
><DT
>-l</DT
><DD
><P
>	Este parámetro habilita la comunicación mediante el socket 	SSL. También es necesario especificar la opción 
	<TT
CLASS="OPTION"
>-i</TT
>. 
	Además, debió habilitarse SSL en el momento de la 	compilación.
       </P
></DD
><DT
>-o <TT
CLASS="REPLACEABLE"
><I
>BackendOptions</I
></TT
></DT
><DD
><P
>	Las opciones de <TT
CLASS="LITERAL"
>postgres</TT
> que se especifican en
	<TT
CLASS="REPLACEABLE"
><I
>BackendOptions</I
></TT
> son pasadas
	a todos los procesos iniciados en el servidor por este postmaster.
	are passed to all backend server processes started by this
	<TT
CLASS="APPLICATION"
>postmaster</TT
>.
	Si la cadena de opciones contiene espacios, entonces debe 	encerrársela entre comillas.
       </P
></DD
><DT
>-p <TT
CLASS="REPLACEABLE"
><I
>port</I
></TT
></DT
><DD
><P
>	Especifica el puerto TCP/IP o la extensión de archivo del socket 
	del dominio Unix local en el cual <TT
CLASS="APPLICATION"
>postmaster</TT
>
	deberá esperar por conexiones solicitadas desde las aplicaciones 
	del lado del cliente. El valor predeterminado es el especificado en la 	variable de entorno <TT
CLASS="ENVAR"
>PGPORT</TT
> o, si <TT
CLASS="ENVAR"
>PGPORT</TT
>
	no fue especificada, se toma como predeterminado el valor establecido 	cuando Postgres fue compilado (normalmente 5342). Si se especifica un 	puerto distinto del predeterminado, a todas las aplicaciones cliente 	(incluyendo <TT
CLASS="APPLICATION"
>psql</TT
>) deberá 
	especificárseles el mismo 	puerto ya sea mediante las opciones de 	línea de comando o utilizando la variable de entorno 
	<TT
CLASS="ENVAR"
>PGPORT</TT
>.
       </P
></DD
></DL
></DIV
>
   </P
><P
>	Existen algunas opciones de línea de comandos disponibles para
	realizar depuraciones en caso de que un proceso en el servidor termine de 	forma anormal.
	Estas opciones controlan el comportamiento de 	<TT
CLASS="APPLICATION"
>postmaster</TT
> en estas situaciones, y
	<I
CLASS="EMPHASIS"
>ninguna de ellas está pensada para ser utilizada en  	situaciones normales</I
>.
   </P
><P
>	 La estrategia usual para esta situación es notigicar a todos los 	 demás procesos en el servidor que deben terminar y reinicializar  	 la memoria y semáforos compartidos. Esto es así debido a 	 que un proceso de servidor que funcione de manera errática 	 	 	 podría corromper alguno de estos recursos compartidos antes de 	 terminar.
   </P
><P
>	 Estas opciones especiales son:

    <P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>-n</DT
><DD
><P
>	<TT
CLASS="APPLICATION"
>postmaster</TT
>
	no reinicializaráa las estructuras compartidas. Un programador 	podría luego analizarlas con el programa 	<TT
CLASS="APPLICATION"
>shmemdoc</TT
> y examinar la memoria compartida y lo 	estados de los semáforos.
       </P
></DD
><DT
>-s</DT
><DD
><P
>	<TT
CLASS="APPLICATION"
>postmaster</TT
>
	detendrá todos los demás procesos del servidor 	enviándoles la señal <TT
CLASS="LITERAL"
>SIGSTOP</TT
>, pero no 	hará que terminene. Estos permite a los programadores del sistema
	realizar vuelcos de núcleo a mano para todos los procesos del 	servidor.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-APP-POSTMASTER-2"
></A
><H3
>    Salidas
   </H3
><P
>&#13;    <P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><TT
CLASS="COMPUTEROUTPUT"
>semget: No space left on device
       </TT
></DT
><DD
><P
>	Si aparece este mensaje, debería ejecutar el comando
	<TT
CLASS="APPLICATION"
>ipcclean</TT
>. Una vez hecho esto, pruebe iniciar 
	<TT
CLASS="APPLICATION"
>postmaster</TT
> nuevamente.
	Si aun no funciona, probablemente necesite configurar el núcleo 	(kernel) de su sistema para que pueda utilizar memoria compartida y 	semáforos, tal como se describe en las notas de 	instalación.
	Si ejecuta múltiples instancias de 	<TT
CLASS="APPLICATION"
>postmaster</TT
> 
	en un sólo host, o tiene un kernel con muy poca memoria compartida 	o un límite de semáforos muy pequeño, tal vez deba 	reconfigurarlo su kernel para incrementar sus parámetros de 	memoria comapartida y semáforos.


	<DIV
CLASS="TIP"
><P
></P
><TABLE
CLASS="TIP"
WIDTH="90%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="./stylesheet-images/tip.gif"
HSPACE="5"
ALT="Sugerencia"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>		Tal vez pueda posponer la reconfiguración del kernel 		disminuyendo lo especificado con -B para reducir la 		utilización de memoria compartida por parte de 
		<SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>, o disinuyendo lo especificado con 		-N para reducir la cantidad de semáforos que utiliza 		<SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
>.

	 </P
></TD
></TR
></TABLE
></DIV
>
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>StreamServerPort: cannot bind to port
       </TT
></DT
><DD
><P
>&#13;	Si se encuentra con este mensaje, debe asegurarse de que no existen otros 	procesos de <TT
CLASS="APPLICATION"
>postmaster</TT
> ejecutándose en 	el momento. La manera más fácil de determinar esto es 	mediante el comando
	<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% ps -ax | grep postmaster
	</PRE
></TD
></TR
></TABLE
>
	en sistemas basados en BSD, o 
	<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% ps -e | grep postmast
	</PRE
></TD
></TR
></TABLE
>
	en sistemas tipo System V o compatibles con POSIX como ser HP-UX. 
       </P
><P
>	Si está seguro de que no existen otros procesos de 
	<TT
CLASS="APPLICATION"
>postmaster</TT
> en ejecución, y aun 	así sigue recibiendo este error, intente especificar un puerto 	diferente utilizando la opción <TT
CLASS="LITERAL"
>-p</TT
>. 
	También puede obtener este mensaje de error si finaliza 
	<TT
CLASS="APPLICATION"
>postmaster</TT
> y lo vuelve a iniciar 	inmediatamente utilizando el mismo número de puerto; simplemente 	espere unos segundos hasta que el sistema operativo cierre el puerto 	antes de intentar nuevamente. 
	Finalmente, puede que obtenga este mensaje de error si especifica un 	número de puerto que su sistema operativo considere reservado. Por 	ejemplo, muchas versiones de Unix consideran que los puertos con 	número menor a 1024 deben ser confiables y solo permite al 	superusuario tner acceso a ellos. 
       </P
></DD
><DT
><TT
CLASS="COMPUTEROUTPUT"
>IpcMemoryAttach: shmat() failed: Permission denied
       </TT
></DT
><DD
><P
>	Una explicación plausible es que otro usuario intentó 	iniciar un proceso <TT
CLASS="APPLICATION"
>postmaster</TT
> en el mismo 	puerto el cual ha adquirido recursos compartidos y luego ha finalizado. 	Dado que las claves de memoria compartidas de Postgres se basan en el 	número de puerto asignado al proceso 	<TT
CLASS="APPLICATION"
>postmaster</TT
>, estos conflictos tiene más
	probabilidad de ocurrir si existe más de una instalación en 	un mismo servidor. 
	Si no hay otros procesos <TT
CLASS="APPLICATION"
>postmaster</TT
> en 	ejecución (vea más arriba), ejecute 
	<TT
CLASS="APPLICATION"
>ipcclean</TT
> e intente nuevamente. Si existen 	otros <TT
CLASS="APPLICATION"
>postmaster</TT
> ejecutándose, 	deberá contactar a los propietarios de estos procesos para 	coordinar la asignación de puertos y/o la remoción de los 	segmentos de memoria compartida no utilizados.
       </P
></DD
></DL
></DIV
>
   </P
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-APP-POSTMASTER-1"
></A
><H2
>   Description
  </H2
><P
>   <TT
CLASS="APPLICATION"
>postmaster</TT
>
	administra la comunicación entre los procesos del cliente y del 	servidor, así como la asignación de buffers compartidos y 
	semáforos SysV (en máquinas que no tengan intstrucciones
	del tipo test-and-set). 
   <TT
CLASS="APPLICATION"
>postmaster</TT
>
	no interactúa directamente con el usuario y debe ser iniciado como 	un proceso en segundo plano.
  </P
><P
>   <I
CLASS="EMPHASIS"
>Sólo un postmaster debe estar ejecutándose a la 	vez para una instalación 
    <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> dada.</I
>
	Aquí una instalación significa un directorio de base de 	datos y un número de puerto de 	<TT
CLASS="APPLICATION"
>postmaster</TT
>
   Se puede ejecutar más de un postmaster en una misma máquina 	si cada uno de ellos tiene un directorio y un número de puerto 	diferente.
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-APP-POSTMASTER-2"
></A
><H2
>   Notes
  </H2
><P
>	Siempre que se posible 
   <I
CLASS="EMPHASIS"
>evite</I
>
   utilizar <TT
CLASS="LITERAL"
>SIGKILL</TT
>
   para forzar la finalizació de  	<TT
CLASS="APPLICATION"
>postmaster</TT
>.
   En su lugar debería utilizarse
	<TT
CLASS="LITERAL"
>SIGHUP</TT
>,
   <TT
CLASS="LITERAL"
>SIGINT</TT
>,
   o
   <TT
CLASS="LITERAL"
>SIGTERM</TT
>
   (la señal predeterminada para
   <TT
CLASS="APPLICATION"
>kill</TT
>(1))". 
	La utilización

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% kill -KILL
   </PRE
></TD
></TR
></TABLE
>

o su forma alternativa

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% kill -9
   </PRE
></TD
></TR
></TABLE
>

	impedirá que <TT
CLASS="APPLICATION"
>postmaster</TT
> pueda liberar
	los recursos del sistema (memoria compartida y semáforos) que 	poseía antes de finalizar. 
	En cambio, si <TT
CLASS="APPLICATION"
>postmaster</TT
> logra liberar los 	recursos en su poder, le evitará a usted tener que lidiar con los 	problemas de memoria compartida que se describieron anteriormente.
  </P
><P
>	Existen varias utilidades para resolver problemas de memoria compartida,
	entre las cuales se encuentran
   <TT
CLASS="APPLICATION"
>ipcs(1)</TT
>,
   <TT
CLASS="APPLICATION"
>ipcrm(1</TT
>), y
   <TT
CLASS="APPLICATION"
>ipcclean(1)</TT
>.
  </P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-APP-POSTMASTER-3"
></A
><H2
>   Utilización
  </H2
><P
>	Para iniciar <TT
CLASS="APPLICATION"
>postmaster</TT
> utilizando los valors 	predeterminados, escriba:

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% nohup postmaster &#62;logfile 2&#62;&#38;1 &#38;
   </PRE
></TD
></TR
></TABLE
>

	Este comando iniciará <TT
CLASS="APPLICATION"
>postmaster</TT
> en el 	puerto predeterminado (5432). Esta es la manera más simple, y la 	más común, de iniciar 	<TT
CLASS="APPLICATION"
>postmaster</TT
>.
  </P
><P
>	Para iniciar <TT
CLASS="APPLICATION"
>postmaster</TT
> con un número 	de puerto específico y un nombre de ejecutable:

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% nohup postmaster -p 1234 &#38;
   </PRE
></TD
></TR
></TABLE
>

	Este comando ejecutará <TT
CLASS="APPLICATION"
>postmaster</TT
> 
	comunicándose a través del puerto 1234. Para poder 	conectarse a este <TT
CLASS="APPLICATION"
>postmaster</TT
> utilizando psql, 	necesitará ejecutarlo del siguiente modo

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% psql -p 1234
   </PRE
></TD
></TR
></TABLE
>

	o fijar la variable de entorno <TT
CLASS="ENVAR"
>PGPORT</TT
>:

   <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>% setenv PGPORT 1234
% psql
   </PRE
></TD
></TR
></TABLE
>
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="app-postgres.html"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="postgres.html"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="part-admin.html"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><TT
CLASS="APPLICATION"
>postgres</TT
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="utilities.html"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Guía del Administrador</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>