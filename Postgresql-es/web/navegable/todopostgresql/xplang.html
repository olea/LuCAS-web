<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>Lenguajes Procedurales</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="PostgreSQL"
HREF="postgres.html"><LINK
REL="UP"
TITLE="Guía del Programador"
HREF="part-programmer.html"><LINK
REL="PREVIOUS"
TITLE="Examples"
HREF="x19235.html"><LINK
REL="NEXT"
TITLE="PL/pgSQL"
HREF="x19283.html"></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x19235.html"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x19283.html"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="XPLANG"
>Lenguajes Procedurales</A
></H1
><P
>    A partir del lanzamiento de la versión 6.3, <SPAN
CLASS="PRODUCTNAME"
>Postgres</SPAN
> soporta la 
    definición de lenguajes procedurales. En el caso de una función o procedimiento definido en 
    un lenguaje procedural, la base de datos no tiene un conocimiento implícito sobre como 
    interpretar el código fuente de las funciones. El manejador en sí es una función de un 
    lenguaje de programación compilada en forma de objeto compartido, y cargado cuando es necesario.</P
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN19247"
>Instalación de lenguajes procedurales</A
></H1
><DIV
CLASS="PROCEDURE"
><P
><B
>    Instalación de lenguajes procedurales
    </B
></P
><P
>    Un lenguaje procedural se instala en la base de datos en tres pasos.
    </P
><OL
TYPE="1"
><LI
><P
>                El objeto compartido que contienen el manejador del lenguaje ha de ser compilado e 
                instalado. Por defecto, el manejador para PL/pgSQL está integrado e instalado en 
                el directorio de bibliotecas de la base de datos. Si el soporte de Tcl/Tk está 
                instalado y configurado, el manejador para PL/Tcl está integrado e instalado en el 
                mismo sitio.
	    </P
><P
>                La escritura de un nuevo lenguaje procedural (Procedural language, PL) está mas 
                allá del ámbito de este manual.
	    </P
></LI
><LI
><P
>                El manejador debe ser declarado mediante la orden
		<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>    CREATE FUNCTION <TT
CLASS="REPLACEABLE"
><I
>handler_function_name</I
></TT
> () RETURNS OPAQUE AS
        '<TT
CLASS="FILENAME"
>path-to-shared-object</TT
>' LANGUAGE 'C';
		</PRE
></TD
></TR
></TABLE
>
                El calificador especial de tipo devuelto <SPAN
CLASS="ACRONYM"
>OPAQUE</SPAN
> le dice a la 
                base de datos que esta función no devuelve uno de los tipos definidos en la base 
                de datos ni un tipo compuesto, y que no es directamente utilizable en una sentencia 
                <SPAN
CLASS="ACRONYM"
>SQL</SPAN
>.
	    </P
></LI
><LI
><P
>                El PL debe ser declarado con la orden
		<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>    CREATE [ TRUSTED ] PROCEDURAL LANGUAGE '<TT
CLASS="REPLACEABLE"
><I
>language-name</I
></TT
>'
        HANDLER <TT
CLASS="REPLACEABLE"
><I
>handler_function_name</I
></TT
>
	LANCOMPILER '<TT
CLASS="REPLACEABLE"
><I
>description</I
></TT
>';
		</PRE
></TD
></TR
></TABLE
>
                La palabra clave opcional <SPAN
CLASS="ACRONYM"
>TRUSTED</SPAN
> indica si un usuario 
                normal de la base de datos, sin privilegios de superusuario, puede usar este 
                lenguaje para crear funciones y procedimientos activadores. Dado que las funciones 
                de los PL se ejecutan dentro de la aplicación de base de datos, sólo deberían 
                usarse para lenguajes que no puedan conseguir acceso a las aplicaciones internas 
                de la base de datos, o al sistema de ficheros. Los lenguajes PL/pgSQL y PL/Tcl 
                son manifiestamente fiables en este sentido
	    </P
></LI
></OL
></DIV
><DIV
CLASS="PROCEDURE"
><P
><B
>Ejemplo</B
></P
><OL
TYPE="1"
><LI
><P
>        La siguiente orden le dice a la base de datos donde encontrar el objeto compartido para 
        el manejador de funciones que llama al lenguaje PL/pgSQL
    </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>    CREATE FUNCTION plpgsql_call_handler () RETURNS OPAQUE AS
        '/usr/local/pgsql/lib/plpgsql.so' LANGUAGE 'C';
    </PRE
></TD
></TR
></TABLE
></LI
><LI
><P
>        La orden
    </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>    CREATE TRUSTED PROCEDURAL LANGUAGE 'plpgsql'
        HANDLER plpgsql_call_handler
        LANCOMPILER 'PL/pgSQL';
    </PRE
></TD
></TR
></TABLE
><P
>        define que la función manejadora de llamadas previamente declarada debe ser invocada 
        por las funciones y procedimientos disparadores cuando el atributo del lenguaje es 
        'plpgsql'
    </P
><P
>        Las funciones manejadoras de PL tienen una interfase de llamadas especial distinta 
        del de las funciones de lenguaje C normales. Uno de los argumentos dados al manejador 
        es el identificador del objeto en las entradas de la tabla <TT
CLASS="FILENAME"
>pg_proc</TT
> 
        para la función que ha de ser ejecutada. El manejador examina varios catálogos de sistema 
        para analizar los argumentos de llamada de la función y los tipos de dato que devuelve. 
        El texto fuente del cuerpo de la función se encuentra en el atributo prosrc de 
        <TT
CLASS="FILENAME"
>pg_proc</TT
>.
        Debido a esto, en contraste con las funciones de lenguaje C, las funciones PL pueden 
        ser sobrecargadas, como las funciones del lenguaje SQL. Puede haber múltiples funciones 
        PL con el mismo nombre de función, siempre que los argumentos de llamada sean distintos.
    </P
><P
>        Los lenguajes procedurales definidos en la base de datos <TT
CLASS="FILENAME"
>template1</TT
> 
        se definen automáticamente en todas las bases de datos creadas subsecuentemente. Así que 
        el administrador de la base de datos puede decidir que lenguajes están definidos por 
        defecto.
    </P
></LI
></OL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x19235.html"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="postgres.html"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x19283.html"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Examples</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="part-programmer.html"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>PL/pgSQL</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>