<HTML
><HEAD
><TITLE
>Algunas configuraciones útiles para Sendmail</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Guía de Administración de Redes con Linux"
HREF="index.html"><LINK
REL="UP"
TITLE="Sendmail"
HREF="x-087-2-sendmail.html"><LINK
REL="PREVIOUS"
TITLE="Configuración de las Opciones de Sendmail"
HREF="x15456.html"><LINK
REL="NEXT"
TITLE="Probando la Configuración"
HREF="x15824.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="publicacoes.css"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Guía de Administración de Redes con Linux</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x15456.html"
ACCESSKEY="P"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Capítulo 18. Sendmail</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x15824.html"
ACCESSKEY="N"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN15527">18.8. Algunas configuraciones útiles para Sendmail</H1
><P
>&#13;Hay una miríada de posibles configuraciones de <B
CLASS="COMMAND"
>sendmail</B
>.
En este espacio se ilustrarán sólo unos cuantos tipos de configuración 
de importancia que serán muy útiles para muchas instalaciones de <B
CLASS="COMMAND"
>sendmail</B
>.</P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN15535">18.8.1. Confiar en los usuarios para que pongan el campo From:</H2
><P
>En ocasiones es útil sobreescribir el campo <TT
CLASS="LITERAL"
>From:</TT
>
de un mensaje de correo que va hacia afuera. Supongamos que se tiene
un programa basado en web que genera correo electrónico. Normalmente
el mensaje de correo aparecerá como proviniente del usuario que es el
dueño del proceso del servidor de web. Pero se quiere especificar
alguna otra dirección remitente de tal forma que el correo parezca ser
originado por otro usuario o dirección en esa máquina. <B
CLASS="COMMAND"
>Sendmail</B
> permite especificar en qué usuarios del sistema se 
puede confiar para que tengan la habilidad de hacer esto.</P
><P
>La opción <TT
CLASS="LITERAL"
>use_ct_file</TT
> habilita la posibilidad de
especificar y dar un fichero que liste los nombres de los usuarios
de confianza. Por omisión, un pequeño número de usuarios del sistema
son de confianza de <B
CLASS="COMMAND"
>sendmail</B
>, por ejemplo
<TT
CLASS="LITERAL"
>root</TT
>. El nombre del fichero por omisión para esta
opción es <TT
CLASS="FILENAME"
>/etc/mail/trusted-users</TT
> en los sistemas
en los que el directorio de configuración es <TT
CLASS="FILENAME"
>/etc/mail</TT
> 
y en <TT
CLASS="FILENAME"
>/etc/senmdail.ct</TT
> en donde es el otro tipo de
configuración. Se puede especificar el nombre y lugar del fichero
sobreescribiendo la definición <TT
CLASS="LITERAL"
>confCT_FILE</TT
>.</P
><P
>Escriba FEATURE(use_ct_file) en el fichero <TT
CLASS="FILENAME"
>sendmail.mc</TT
> 
para habilitar esta opción.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN15550">18.8.2. Managing Mail Aliases</H2
><P
>&#13;

Los alias de correo son una poderosa opción que permite que el correo
sea dirigido a otros apartados postales que son nombres alternativos
de usuarios o procesos en un servidor destinatario. Por ejemplo, es
una práctica común tener retroalimentación o comentarios con respecto
a un servidor de Web y que estén dirigidos a &ldquo;webmaster.&rdquo;
Con frecuencia no hay un usuario llamado &ldquo;webmaster.&rdquo; en
el servidor, en vez de ello, hay un alias a otro usuario del
sistema. Otro uso común para los alias de correo es utilizarlos por
los programas de gestión de listas de correo en los cuales un alias
dirige todos los mensajes que ingresan al programa de gestión de la
lista para que sea interpretado.</P
><P
>&#13;El fichero <TT
CLASS="FILENAME"
>/etc/aliases</TT
> es el lugar en donde los
alias se almacenan. El programa <B
CLASS="COMMAND"
>sendmail</B
> consulta
este fichero cuando está determinando cómo manejar un mensaje que
ingresa. Si encuentra una línea en este fichero que coincide con el
usuario a quien va dirigido el mensaje, lo redirige al lugar que
indica dicha línea.</P
><P
>De forma específica, hay tres cosas que los alias permiten:

<P
></P
></P><UL
><LI
><P
>Otorgan un nombre corto o bien conocido para el correo que será dirigido
hacia una o más personas.</P
></LI
><LI
><P
>Pueden invocar a un programa con el mensaje de correo como entrada
hacia dicho programa.</P
></LI
><LI
><P
>Pueden mandar el correo a un fichero.</P
></LI
></UL
><P></P
><P
>Todos los sistemas requieren de alias para el
<SPAN
CLASS="SYSTEMITEM"
>Postmaster</SPAN
> y el
<SPAN
CLASS="SYSTEMITEM"
>MAILER-DAEMON</SPAN
> para cumplir con
el RFC.</P
><P
>Se debe ser especialmente cuidadoso con la seguridad cuando se definan
alias que invoquen o escriban a programas, ya que
<B
CLASS="COMMAND"
>sendmail</B
> por lo general se ejecuta con los permisos de 
<SPAN
CLASS="SYSTEMITEM"
>root</SPAN
>.</P
><P
>Se pueden encontrar más detalles con respecto a los alias de correo en
la página de manual <TT
CLASS="FILENAME"
>aliases(5)</TT
>. Una ejemplo del
fichero <TT
CLASS="FILENAME"
>aliases</TT
> se muestra en <A
HREF="x15527.html#X-087-2-SAMP.ALIAS.FIG"
>Ejemplo 18-4</A
>.</P
><DIV
CLASS="EXAMPLE"
><A
NAME="X-087-2-SAMP.ALIAS.FIG"><P
><B
>Ejemplo 18-4. Ejemplo del fichero aliases</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    #
    # Los siguientes dos alias deben estar presentes para cumplir con el RFC.
    # Es importante resolverlos en 'una persona' que lea su correo con regularidad.
    #
    postmaster:    root                            # línea indispensable
    MAILER-DAEMON: postmaster                      # línea indispensable
    #
    #
    # demuestra los tipos más comunes de alias
    #
    usenet:        janet                           # alias para una persona
    admin:         joe,janet                       # alias para varias personas
    newspak-users: :include:/usr/lib/lists/newspak # lee a los destinatarios desde un fichero
    changefeed:    |/usr/local/lib/gup             # alias que invoca a un programa
    complaints:    /var/log/complaints             # alias que escribe el correo a un fichero
    #</PRE
></TD
></TR
></TABLE
></DIV
><P
>Cada vez que actualice el fichero <TT
CLASS="FILENAME"
>/etc/aliases</TT
>,
se debe asegurar de ejecutar el programa:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    # <TT
CLASS="USERINPUT"
><B
>/usr/bin/newaliases</B
></TT
></PRE
></TD
></TR
></TABLE
>

para reconstruir la base de datos que <B
CLASS="COMMAND"
>sendmail</B
>
utiliza internamente. La orden <B
CLASS="COMMAND"
>/usr/bin/newaliases</B
>
es un vínculo simbólico al ejecutable de <B
CLASS="COMMAND"
>sendmail</B
>
y, cuando se invoca de esta forma, se comporta exactamente como si
hubiese sido invocado así:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    # <TT
CLASS="USERINPUT"
><B
>/usr/lib/sendmail -bi</B
></TT
></PRE
></TD
></TR
></TABLE
>

La orden <B
CLASS="COMMAND"
>newaliases</B
> es una forma alternativa y más
adecuada para hacer esto.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN15598">18.8.3. Cómo usar un anfitrión inteligente</H2
><P
>&#13;
Algunas veces un anfitrión encuentra correo que no puede entregar
directamente a un sitio remoto. Con frecuencia es conveniente tener un
único sitio en una red que tenga el papel de gestionar la transmision
del correo a sitios remotos que son difíciles de alcanzar, en vez de
que cada sitio local intente hacer esto por sí mismo.</P
><P
>Hay algunas buenas razones para que se tenga un solo sitio encargado
de la gestión del correo. Se simplifica la gestión al tener sólo un
sitio con una configuración cuidadosa del correo que sepa cómo manejar
todos los tipos de transporte de correo, tales como UUCP, Usenet,
etc. Todos los otros sitios lo único que necesitan es un solo
protocolo de transporte para enviar su correo a este anfitrión
central. Los sitios que cumplen este papel de encaminadores centrales y 
reenviadores se llaman <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>anfitriones inteligentes</I
></SPAN
>. 
Si se tiene un anfitrión inteligente que acepte correo de usted, se puede 
enviar correo de cualquier tipo y él se encargará de gestionar el 
encaminamiento y la transmisión de ese correo a todos los sitios remotos 
deseados.</P
><P
>Otra buena aplicación para la configuración de anfitriones remotos es
gestionar la transmisión del correo a través de un cortafuegos
privado. Una organización puede elegir instalar una red IP privada y
utilizar sus propias direcciones IP no registradas. La red privada se
puede conectar a Internet mediante un cortafuegos. El enviar el
correo desde y hacia los diversos anfitriones dentro de la red privada
hacia el mundo exterior utilizando SMTP no será posible en una
configuración convencional debido a que los sitios locales no pueden
establecer una conexión directa de red a los sitios que están en
Internet. En cambio, la organización puede optar por que el
cortafuegos tenga la función de anfitrión inteligente. El anfitrión
inteligente que se ejecute en el cortafuegos será capaz de establecer
conexiones directas de red con los sitios que se encuentran tanto en
el interior de la red privada como en el exterior de ella. El
anfitrión inteligente puede aceptar correo de ambos anfitriones, de
los que están en la red privada y de los que están en Internet,
el correo se guarda en un almacenamiento local y luego se gestiona la
retransmisión de ese correo directamente al sitio adecuado.</P
><P
>Los anfitriones inteligentes se utilizan en general cuando todos los
otros métodos de entrega han fallado. En el caso de una organización
con una red privada, es perfectamente razonable que los anfitriones
primero intenten entregar el correo directamente, y si eso falla,
entonces los envían al anfitrión inteligente. Esto descarga mucho el
tráfico que va hacia el anfitrión inteligente debido a que los otros
anfitriones pueden enviar correo directamente a otros anfitriones
dentro de la red privada.</P
><P
>&#13;<B
CLASS="COMMAND"
>sendmail</B
> provee de un método simple para configurar
un anfitrión inteligente utilizando la opción
<TT
CLASS="LITERAL"
>SMART_HOST</TT
>; para implementarlo en la configuración
de la Cervecera Virtual, se hace exactamente esto. Las porciones
relevantes de nuestra configuración que definen al anfitrión
inteligente son:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    define(`SMART_HOST', `uucp-new:moria')
    LOCAL_NET_CONFIG
    # Esta regla asegura que todo el correo local se entrega utilizando
    # el transporte smtp, todo lo demás se va a través del anfitrión inteligente.
    R$* &lt; @ $* .$m. &gt; $*	$#smtp $@ $2.$m. $: $1 &lt; @ $2.$m. &gt; $3</PRE
></TD
></TR
></TABLE
></P
><P
>La macro <TT
CLASS="LITERAL"
>SMART_HOST</TT
> permite que se especifique el
anfitrión que reenviará todo el correo de salida que no se pueda 
entregar directamente y el protocolo de transporte de correo que se
debe utilizar para ello.</P
><P
>En nuestra configuración se está usando el transporte
<TT
CLASS="LITERAL"
>uucp-new</TT
> hacia el sitio UUCP <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>moria</B
></SPAN
>. Si se quisiera configurar 
<B
CLASS="COMMAND"
>sendmail</B
> para que utilice un anfitrión inteligente
con SMTP, se debería escribir algo como lo siguiente:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    
    define(`SMART_HOST', `mail.isp.net')</PRE
></TD
></TR
></TABLE
>

No se necesita especificar que el transporte es SMTP, ya que está
dicho por omisión.</P
><P
>¿Puede adivinar lo que la macro <TT
CLASS="LITERAL"
>LOCAL_NET_CONFIG</TT
> y la
regla de reescritura podría estar haciendo?</P
><P
>La macro <TT
CLASS="LITERAL"
>LOCAL_NET_CONFIG</TT
> permite agregar reglas 
de reescritura directamente a la configuración de <B
CLASS="COMMAND"
>sendmail</B
> 
que definirá qué correo se deberá quedar dentro del sistema local. En 
nuestro ejemplo, se ha utilizado una regla en la que cualquier correo 
electrónico cuyo dominio coincida con el dominio de nuestro anfitrión 
(<TT
CLASS="LITERAL"
>.$m.</TT
>) se reescribe para ser enviado directamente 
usando el transporte <TT
CLASS="LITERAL"
>SMTP</TT
>.  Esto asegura que cualquier 
mensaje enviado hacia un anfitrión dentro de nuestro dominio local será 
redirigido inmediatamente al transporte  SMTP y enviado directamente a ese 
anfitrión en vez de pasar a través de nuestro anfitrión inteligente, que es 
el tratamiento por omisión.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN15630">18.8.4. Gestionando correo no deseado o no solicitado (Spam)</H2
><P
>&#13;


Si se ha suscrito a una lista de correo, publicado su dirección de
correo electrónico en un sitio web, o enviado un artículo a UseNet, lo
más probable es que comience a recibir correo electrónico no
solicitado con anuncios. Son los lugares comunes en donde la gente que
ronda por la red busca las direcciones de correo para agregarlas a
listas de correo que luego venden a compañías que buscan anunciar sus
productos. A este tipo de correo masivo se le conoce como spam.</P
><P
>El diccionario gratuito de la computación en línea ofrece una
definición con respecto al correo de spam que dice:
<A
NAME="X-087-2-FNSD01"
HREF="#FTN.X-087-2-FNSD01"
>[1]</A
></P
><A
NAME="AEN15647"><BLOCKQUOTE
CLASS="BLOCKQUOTE"
><P
>2. (En un sentido más estricto que 1, arriba) El envío indiscriminado de grandes
cantidades de correo electrónico no solicitado para promocionar un
producto o un servicio. El spam, en este sentido, es una especie
equivalente electrónico de el correo basura enviado al "inquilino."</P
><P
>En los años 90, con el crecimiento del interés comercial en la red,
hay algunas personas sin escrúpulos<A
NAME="AEN15650"
HREF="#FTN.AEN15650"
>[2]</A
> que ofrecen el uso del spam como
un "servicio" a las compañías que quieren anunciarse en la red. Ello
lo consiguen al enviar mensajes a grandes colecciones de direcciones
de correo, foros de noticias de Usenet o listas de correo. Dichas
prácticas han causado furia y reacción agresiva de muchos usuarios de
la red en contra de dichos individuos.</P
></BLOCKQUOTE
><P
>Por fortuna, <B
CLASS="COMMAND"
>sendmail</B
> tiene algunos mecanismos que
pueden ayudar a tratar al correo no solicitado.</P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN15654">18.8.4.1. Las Listas Negras en Tiempo Real (RBL)</H3
><P
>&#13;

Las listas de exclusión <A
NAME="AEN15661"
HREF="#FTN.AEN15661"
>[3]</A
> 
en tiempo real (RBL, Real-time Blackhole List) es una lista pública 
que ayuda a reducir 
el volumen de anuncios no solicitados con los que se tiene que
tratar. Algunas fuentes de correo electrónico están en listadas en una
base de datos consultable a través de Internet. Ellos han sido
incluidos allí por la gente que recibe anuncios no solicitados de
alguna dirección de correo. Los grandes dominios, en ocasiones están
en dicha lista debido a algún resbalón que les impidió detener el
spam. Mientras que alguna gente se queja de alguna selección en
particular hecha por los mantenedores de la lista, aún sigue siendo
muy popular y los errores se arreglan con rapidez. Todos los detalles
de la operación de cómo opera el servicio están en el sitio web del
Sistema de Protección contra el Abuso del Correo en 
<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>http://maps.vix.com/rbl/</I
></SPAN
>.</P
><P
>Si se habilita esta opción de <B
CLASS="COMMAND"
>sendmail</B
>, se buscará
la dirección de origen de cada mensaje que llegue en la base de datos
de la Lista Negra en tiempo real para determinar si se acepta
o no el mensaje. Si se tiene un gran sitio con muchos usuarios, esta
opción podría ahorrarles una gran cantidad de espacio en disco. Esta
opción acepta como parámetro especificar el nombre del servidor que se
va a utilizar. El servidor principal por omisión es
<SPAN
CLASS="SYSTEMITEM"
>rbl.maps.vix.com</SPAN
>.</P
><P
>Para configurar la opción de "listas negras en tiempo real", se
debe agregar la siguiente declaración de macro en el fichero
<TT
CLASS="FILENAME"
>sendmail.mc</TT
>:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(rbl)</PRE
></TD
></TR
></TABLE
></P
><P
>Si se quiere especificar otro servidor de RBL, la declaración que se
debe escribir debe ser como la siguiente:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(rbl,`rbl.host.net')</PRE
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="X-087-2-SENDMAIL.ACCESSDB">18.8.4.2. La base de datos de acceso</H3
><P
>&#13;

Un sistema alternativo que tiene gran flexibilidad para el control a
cambio del costo que implica una configuración manual es la opción
<SPAN
CLASS="SYSTEMITEM"
>access_db</SPAN
>. La base de datos de
acceso permite configurar qué anfitriones o usuarios serán aceptables
para enviar correo y quiénes pueden utilizarlo como puente.</P
><P
>Gestionar a quiénes se les permitirá reenviar el correo es muy
importante ya que el reenvío es una técnica de uso común para mandar
correo basura a los anfitriones que tienen sistemas como el RBL del
que se comentó anteriormente para evitar la basura. En vez de enviar
el correo directamente, los 'spammers' utilizarán el reenvío a través
de un anfitrión que, ingenuamente, lo permita. La conexión entrante de
SMTP no provendrá del anfitrión conocido por enviar basura, sino de
quien lo reenvió. Para garantizar que nuestro anfitrión no sea
utilizado de esta forma, sólo se debe reenviar el correo de los sitios
autorizados. Las versiones de <B
CLASS="COMMAND"
>sendmail</B
> que son
8.9.0 o posteriores, tienen el reenvío deshabilitado por omisión, así
que para ellos será necesario utilizar la base de datos de acceso para
habilitar a los sitios locales para que puedan reenviar sus mensajes.</P
><P
>La idea general es muy sencilla. Cuando se recibe una conexión de
entrada por SMTP, <B
CLASS="COMMAND"
>sendmail</B
> toma la información del
encabezado de entrada y luego consulta la base de datos de acceso para
ver si aceptará el contenido del mensaje.</P
><P
>La base de datos de acceso es una colección de reglas que describen
qué acciones se deben tomar para los mensajes recibidos de los
anfitriones nombrados. El fichero de control de acceso por omisión se
llama <TT
CLASS="FILENAME"
>/etc/mail/access</TT
>. La tabla tiene un formato
muy simple. Cada línea de la tabla contiene una regla de acceso. El
lado izquierdo de cada regla es un patrón utilizado para comparar con
el remitente de un mensaje de correo de entrada. Puede ser una
dirección de correo completa, un nombre de anfitrión o una dirección
IP. El lado derecho es la acción que se deberá tomar. Hay cinco tipos
de acciones que se pueden seleccionar y son:</P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>OK</DT
><DD
><P
>Aceptar el mensaje.</P
></DD
><DT
>RELAY</DT
><DD
><P
>Aceptar los mensajes para este anfitrión o usuario aún si no provienen
de nuestro anfitrión; esto es, aceptar que los mensajes sean
reenviados hacia otros anfitriones desde este anfitrión.</P
></DD
><DT
>REJECT</DT
><DD
><P
>Rechazar el correo con un mensaje genérico.</P
></DD
><DT
>DISCARD</DT
><DD
><P
>Descartar el mensaje utilizando la propiedad
<TT
CLASS="LITERAL"
>$#discard</TT
> del sistema de correo.</P
></DD
><DT
>### cualquier texto</DT
><DD
><P
>Contestar con un mensaje de error utilizando
<TT
CLASS="REPLACEABLE"
><I
>###</I
></TT
> como código de error (el cual deberá
cumplir con el RFC-821) y &ldquo;cualquier texto&rdquo; será el
mensaje.</P
></DD
></DL
></DIV
><P
>Como ejemplo, el fichero <TT
CLASS="FILENAME"
>/etc/mail/access</TT
> podría
ser como este:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    friends@cybermail.com   REJECT
    aol.com                 REJECT
    207.46.131.30           REJECT
    postmaster@aol.com      OK
    linux.org.au            RELAY</PRE
></TD
></TR
></TABLE
></P
><P
>Este ejemplo rechazará cualquier correo que se reciba desde
<SPAN
CLASS="SYSTEMITEM"
>friends@cybermail.com</SPAN
>, cualquier
anfitrión en el dominio <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>aol.com</B
></SPAN
> y el
anfitrión <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>207.46.131.30</B
></SPAN
>. La siguiente
regla aceptará correo electrónico desde <SPAN
CLASS="SYSTEMITEM"
>postmaster@aol.com</SPAN
> a pesar del hecho de
que el dominio en sí mismo tiene una regla de rechazo. Y la última
regla permite el reenvío de correo de cualquier anfitrión en el
dominio <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>linux.org.au</B
></SPAN
>.</P
><P
>Para habilitar la opción de la base de datos de acceso, se debe
utilizar la siguiente declaración en su fichero
<TT
CLASS="FILENAME"
>sendmail.mc</TT
>:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(access_db)</PRE
></TD
></TR
></TABLE
></P
><P
>La definición por omisión construye la base de datos con
<TT
CLASS="LITERAL"
>hash -o /etc/mail/access</TT
>, lo que genera una base de
datos con formato hash a partir de un fichero de texto simple. Esto es
perfectamente adecuado en la mayor parte de las instalaciones. Hay
otras opciones que se deben considerar si se intenta tener una gran
base de datos de acceso. Consulte el libro de
<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>sendmail</I
></SPAN
> u otra documentación de
<B
CLASS="COMMAND"
>sendmail</B
> para más detalles.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN15726">18.8.4.3. Exclusión usuarios de la recepción de correo</H3
><P
>&#13;
Si tiene usuarios o procesos automatizados que envían correo pero nunca necesitan recibirlo,
es a veces útil no aceptar el correo destinado a ellos. Esto salva espacio de disco malgastado en 
almacenar correo que nunca será leído. la característica <SPAN
CLASS="SYSTEMITEM"
>blacklist_recipients</SPAN
>
cuando se usa en combinación con la característica <SPAN
CLASS="SYSTEMITEM"
>access_db</SPAN
> le permite
desactivar la recepción de correo para usuarios locales.</P
><P
>Para activar la característica, agregue las siguientes líneas al fichero 
<TT
CLASS="FILENAME"
>sendmail.mc</TT
>, si no están ya allí:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(access_db)
    FEATURE(blacklist_recipients)</PRE
></TD
></TR
></TABLE
></P
><P
>Para desactivar la recepción de correo de un usuario local, simplemente añada sus datos a la base de 
datos de acceso. Normalmente podría usar el estilo de entrada <TT
CLASS="REPLACEABLE"
><I
>###</I
></TT
> que devolvería un 
mensaje de error con significado al remitente para que así sepa por qué el correo 
no se ha entregado. Esta característica se aplica igualmente bien a usuarios en dominios de correo 
virtuales, y debe incluir el dominio virtual de correo en la especificación de la base de datos de 
acceso. Algunas entradas de <TT
CLASS="FILENAME"
>/etc/mail/access</TT
> podrían semejarse a esto:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    daemon          550 El demonio no acepta ni lee correo.
    flacco          550 El correo de este usuario ha sido desactivado administrativamente.
    grump@dairy.org 550 Correo desactivado para este destinatario.</PRE
></TD
></TR
></TABLE
></P
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN15747">18.8.5. Configurando el Hospedaje Virtual de Correo</H2
><P
>&#13;
El hospedaje virtual de correo proporciona a un anfitrión la capacidad de aceptar y 
entregar correo en nombre de varios dominios diferentes aunque estén en varios hospedajes de correo 
separados. Normalmente son los Proveedores de Aplicación de Internet los que explotan el hospedaje virtual 
en combinación con hospedaje virtual de webs, pero es sencillo de configurar y nunca se
sabrá cuando tendrá la necesidad de hospedar virtualmente una lista de correo para 
su proyecto favorito de GNU/Linux, así que lo describiremos aquí.</P
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN15756">18.8.5.1. Aceptar correo para otros dominios</H3
><P
>&#13;Cuando <B
CLASS="COMMAND"
>sendmail</B
> recibe un mensaje de correo electrónico, compara el
anfitrión de destino en las cabeceras del mensaje con el nombre del anfitrión local. Si 
coinciden, <B
CLASS="COMMAND"
>sendmail</B
> acepta el mensaje para entrega local;
si difieren, <B
CLASS="COMMAND"
>sendmail</B
> puede decidir aceptar el mensaje e intentar 
reenviarlo al destino final (Vea <A
HREF="x15527.html#X-087-2-SENDMAIL.ACCESSDB"
>Sección 18.8.4.2</A
> más tarde en este capítulo
para detalles sobre cómo configurar <B
CLASS="COMMAND"
>sendmail</B
> para aceptar correo para reenvío&thinsp;).</P
><P
>Si deseásemos configurar hospedeaje virtual de correo, la primera cosa que necesitamos hacer
es convencer a  <B
CLASS="COMMAND"
>sendmail</B
> de que deba aceptar también correo para los 
dominios que estamos hospedando. Afortunadamente, esto es muy sencillo de hacer.</P
><P
>La característica de <B
CLASS="COMMAND"
>sendmail</B
>
<SPAN
CLASS="SYSTEMITEM"
>use_cw_file</SPAN
> nos permite especificar el nombre de un
fichero donde almacenamos nombres de dominio para los que <B
CLASS="COMMAND"
>sendmail</B
> acepta 
correo. Para configurar la característica, añada la declaración de la característica a su 
fichero <TT
CLASS="FILENAME"
>sendmail.mc</TT
>:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(use_cw_file)</PRE
></TD
></TR
></TABLE
></P
><P
>El nombre predeterminado del fichero será <TT
CLASS="FILENAME"
>/etc/mail/local-host-names</TT
> 
para distribuciones que usen el directorio de configuración <TT
CLASS="FILENAME"
>/etc/mail/</TT
> o 
<TT
CLASS="FILENAME"
>/etc/sendmail.cw</TT
> para aquellas que no. Alternativamente,
puede especificar el nombre y la localización del fichero anulando la macro 
<TT
CLASS="LITERAL"
>confCW_FILE</TT
> utilizando una variacion en:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    define(`confCW_FILE',`/etc/virtualnames')</PRE
></TD
></TR
></TABLE
></P
><P
>Para seguir con el nombre del fichero predeterminado, si deseásemos ofrecer 
hospedaje virtual a los dominios <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>bovine.net</B
></SPAN
>, <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>dairy.org</B
></SPAN
>, y
<SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>artist.org</B
></SPAN
>, crearíamos un fichero 
<TT
CLASS="FILENAME"
>/etc/mail/local-host-names</TT
> semejante a:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    bovine.net
    dairy.org
    artist.org</PRE
></TD
></TR
></TABLE
></P
><P
>Cuando esto está hecho, y asumiendo que los registros DNS apropiados existen y apuntan 
éstos nombres de dominio a nuestro anfitrión,  <B
CLASS="COMMAND"
>sendmail</B
> aceptará los mensajes de correo
para estos dominios como si estuviesen dirigidos a nuestro propio nombre de dominio real.</P
></DIV
><DIV
CLASS="SECT3"
><H3
CLASS="SECT3"
><A
NAME="AEN15789">18.8.5.2. Reenvío de correo hospedado virtualmente a otros destinos</H3
><P
>&#13;

La característica de <B
CLASS="COMMAND"
>sendmail</B
>
<SPAN
CLASS="SYSTEMITEM"
>virtusertable</SPAN
> configura 
el soporte para la tabla de usuarios virtuales, donde configuramos el hospedaje de
correo virtual. Las tablas de usuarios virtuales mapean el correo entrante destinado a 
algunos <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>usuarios@anfitrión</I
></SPAN
> a algunos <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>otro_usuario@otro_anfitrión</I
></SPAN
>.
Puede pensar en esto como una característica de alias avanzada; una que opera usando no sólo el 
usuario de destino, sino también el dominio de destino.</P
><P
>Para configurar la característica <SPAN
CLASS="SYSTEMITEM"
>virtusertable</SPAN
>, 
añada la característica a su configuración <TT
CLASS="FILENAME"
>sendmail.mc</TT
>  como se muestra:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    FEATURE(virtusertable)</PRE
></TD
></TR
></TABLE
></P
><P
>Por omisión, el fichero conteniendo las reglas para efectuar las traducciones será 
<TT
CLASS="FILENAME"
>/etc/mail/virtusertable</TT
>. Puede anular éste mediante
el suministro de un argumento a la definición de la macro; consulte una 
referencia detallada de <B
CLASS="COMMAND"
>sendmail</B
> para aprender acerca de qué opciones
están disponibles.</P
><P
>El formato de la tabla de usuarios virtuales es muy sencillo. En el lado izquierdo de cada
línea hay un patrón representando el la dirección de destino original; al lado derecho,
un patrón representando la dirección de correo a la que la se mapeará la dirección virtual hospedada.</P
><P
>El siguiente ejemplo muestra tres posibles tipos de entradas:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    samiam@bovine.net     colin
    sunny@bovine.net      darkhorse@mystery.net
    @dairy.org            mail@jhm.org
    @artist.org           $1@red.firefly.com</PRE
></TD
></TR
></TABLE
>

En este ejemplo, estamos hospedando virtualmente tres dominios:
<SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>bovine.net</B
></SPAN
>, <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>dairy.org</B
></SPAN
>, y
<SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>artist.org</B
></SPAN
>.</P
><P
>La primera entrada reenvía el correo dirigido a un usuario en el dominio virtual
<SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>bovine.net</B
></SPAN
> a un usuario local en la máquina. La segunda
entrada reenvía el correo a un usuario en el mismo dominio virtual a un usuario 
en otro dominio. El tercer ejemplo reenvía todo el correo dirigido a cualquier usuario 
dentro del dominio virtual  <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>dairly.org</B
></SPAN
> a una
sola dirección de correo remota. Finalmente, la última entrada reenvía cualquier correo
a un usuario en el dominio virtual  <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>artist.org</B
></SPAN
> al mismo
usuario en otro dominio; por ejemplo,
<SPAN
CLASS="SYSTEMITEM"
>julie@artists.org</SPAN
> sería reenviado a 
<SPAN
CLASS="SYSTEMITEM"
>julie@red.firefly.com</SPAN
>.</P
></DIV
></DIV
></DIV
><H3
CLASS="FOOTNOTES"
>Notas</H3
><TABLE
BORDER="0"
CLASS="FOOTNOTES"
WIDTH="100%"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.X-087-2-FNSD01"
HREF="x15527.html#X-087-2-FNSD01"
>[1]</A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>El diccionario gratuito de la computación en línea puede ser
encontrado empaquetado en muchas distribuciones de GNU/Linux, o en línea
en su página web en <SPAN
CLASS="SYSTEMITEM"
>http://wombat.doc.ic.ac.uk/foldoc/</SPAN
>.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN15650"
HREF="x15527.html#AEN15650"
>[2]</A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>N. del T:literalmente 
"scumbags" o sacos de mierda</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN15661"
HREF="x15527.html#AEN15661"
>[3]</A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>N. del T: 
Del inglés "black hole", agujero negro</P
></TD
></TR
></TABLE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x15456.html"
ACCESSKEY="P"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x15824.html"
ACCESSKEY="N"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Configuración de las Opciones de Sendmail</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="x-087-2-sendmail.html"
ACCESSKEY="U"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Probando la Configuración</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>