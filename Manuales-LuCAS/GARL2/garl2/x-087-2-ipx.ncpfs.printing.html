<HTML
><HEAD
><TITLE
>Imprimiendo en una Cola de Impresión NetWare</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Guía de Administración de Redes con Linux"
HREF="index.html"><LINK
REL="UP"
TITLE="IPX y el Sistema de Ficheros NCP"
HREF="x-087-2-ipx.html"><LINK
REL="PREVIOUS"
TITLE="Explorando Algunas de las Otras Herramientas IPX"
HREF="x-087-2-ipx.othertools.html"><LINK
REL="NEXT"
TITLE="Emulación del Servidor NetWare"
HREF="x-087-2-ipx.ncpfs.server.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="publicacoes.css"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Guía de Administración de Redes con Linux</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x-087-2-ipx.othertools.html"
ACCESSKEY="P"
>Anterior</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Capítulo 15. IPX y el Sistema de Ficheros NCP</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x-087-2-ipx.ncpfs.server.html"
ACCESSKEY="N"
>Siguiente</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="X-087-2-IPX.NCPFS.PRINTING">15.8. Imprimiendo en una Cola de Impresión NetWare</H1
><P
>El paquete <TT
CLASS="FILENAME"
>ncpfs</TT
> contiene una pequeña utilidad
llamada <B
CLASS="COMMAND"
>nprint</B
> que envia trabajos de impresión a
través de una conexión NCP a una cola de impresión NetWare. Esta orden
crea la conexión si no existe ya, y utiliza el fichero
<TT
CLASS="FILENAME"
>~/.nwclient</TT
> que describimos anteriormente para
esconder el nombre de usuario y la clave de los ojos fisgones. Los
argumentos de línea de orden utilizados para manejar el proceso
de ingreso son los mismos que los utilizados en la orden
<B
CLASS="COMMAND"
>ncpmount</B
>, así que no los veremos de nuevo aquí.
Cubriremos las opciones de línea de orden más importantes en
nuestros ejemplos; remítase a la página de manual
<TT
CLASS="FILENAME"
>nprint(1)</TT
> para más detalles.</P
><P
>La única opción requerida en la orden <B
CLASS="COMMAND"
>nprint</B
> es
el nombre del fichero a imprimir. Si se especifica un &ndash; en el
nombre de fichero o si no se especifica nada, <B
CLASS="COMMAND"
>nprint</B
>
aceptará el trabajo de impresión desde <TT
CLASS="LITERAL"
>stdin</TT
>. Las
opciones más importantes de <B
CLASS="COMMAND"
>nprint</B
> especifican el
servidor de ficheros y la cola de impresión a los que desea enviar
el trabajo. La <A
HREF="x-087-2-ipx.ncpfs.printing.html#X-087-2-IPX.NPRINT.OPTIONS"
>Tabla 15-4</A
> lista las
opciones más importantes.</P
><DIV
CLASS="TABLE"
><A
NAME="X-087-2-IPX.NPRINT.OPTIONS"><P
><B
>Tabla 15-4. Opciones de Línea de Orden de nprint</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><THEAD
><TR
><TH
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>Opción</TH
><TH
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
>Descripción</TH
></TR
></THEAD
><TBODY
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-S <TT
CLASS="REPLACEABLE"
><I
>nombre_servidor</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>El nombre del servidor de ficheros NetWare que mantiene la cola de impresión
en la que se desea imprimir. Normalmente, es conveniente que el servidor
tenga una entrada en el fichero <TT
CLASS="FILENAME"
>~/.nwclient</TT
>. Esta
opción es obligatoria.</P
></TD
></TR
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-q <TT
CLASS="REPLACEABLE"
><I
>nombre_cola</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>La cola de impresión a la que enviar el trabajo de impresión. Esta opción
es obligatoria.</P
></TD
></TR
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-d <TT
CLASS="REPLACEABLE"
><I
>descripción_trabajo</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>Texto que aparecerá en la consola de impresión al mostrar la lista
de los trabajos en cola.</P
></TD
></TR
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-l <TT
CLASS="REPLACEABLE"
><I
>líneas</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>El número de líneas por página imprimida. Por defecto es 66.</P
></TD
></TR
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-r <TT
CLASS="REPLACEABLE"
><I
>columnas</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>El número de columnas por página imprimida. Por defecto es 80.</P
></TD
></TR
><TR
><TD
WIDTH="96"
ALIGN="LEFT"
VALIGN="TOP"
>-c <TT
CLASS="REPLACEABLE"
><I
>copias</I
></TT
></TD
><TD
WIDTH="312"
ALIGN="LEFT"
VALIGN="TOP"
><P
>El número de copias del trabajo que se imprimirán. Por defecto es 1.</P
></TD
></TR
></TBODY
></TABLE
></DIV
><P
>Un ejemplo de <B
CLASS="COMMAND"
>nprint</B
> sería:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    $ nprint -S REDS01 -q PSLASER -c 2 /home/matt/ethylene.ps</PRE
></TD
></TR
></TABLE
>

Este orden imprimiría dos copias del fichero
<TT
CLASS="FILENAME"
>/home/matt/ethylene.ps</TT
> a la impresora
llamada <TT
CLASS="LITERAL"
>PLASER</TT
> en el servidor de ficheros
<TT
CLASS="LITERAL"
>REDS01</TT
>, utilizando el nombre de usuario y
la clave obtenidas del fichero <TT
CLASS="FILENAME"
>~/.nwclient</TT
>.</P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN12596">15.8.1. Utilizando nprint con el Demonio de Impresión en Línea</H2
><P
>&#13;
Recordará que ya hemos mencionado que la opción
<TT
CLASS="OPTION"
>&ndash;c</TT
> de la orden <B
CLASS="COMMAND"
>ncpmount</B
>
es útil para imprimir. Al final explicaremos porqué y cómo.</P
><P
>GNU/Linux utiliza el software de impresión en línea estilo BSD. El demonio
de impresión en línea (<B
CLASS="COMMAND"
>lpd</B
>&thinsp;) es un demonio
que mira en un directorio de cola (spool) local si hay trabajos
en cola que tienen que imprimirse. <B
CLASS="COMMAND"
>lpd</B
> lee el nombre
de la impresora y otros parámetros a partir del formato especial del
fichero de la cola, y escribe los datos en la impresora, pasando
opcionalmente los datos a través de un filtro para transformarlos o
manipularlos de alguna manera.</P
><P
>El demonio <B
CLASS="COMMAND"
>lpd</B
> utiliza una simple base de datos
llamada <TT
CLASS="FILENAME"
>/etc/printcap</TT
> para almacenar la
configuración de la impresora, incluyendo qué filtros hay que
ejecutar. Normalmente, <B
CLASS="COMMAND"
>lpd</B
> se ejecuta con los
permisos de un usuario de sistema especial llamado
<SPAN
CLASS="SYSTEMITEM"
>lp</SPAN
>.</P
><P
>Se puede configurar <B
CLASS="COMMAND"
>nprint</B
> como un filtro para
<B
CLASS="COMMAND"
>lpd</B
>, lo que permite a los usuarios de su máquina
GNU/Linux imprimir directamente en impresoras remotas alojadas en un
servidor de ficheros NetWare. Para esto, el usuario
<SPAN
CLASS="SYSTEMITEM"
>lp</SPAN
> debe poder escribir
peticiones NCP en la conexión NCP al servidor.</P
><P
>Una manera fácil de conseguir esto sin que el usuario
<SPAN
CLASS="SYSTEMITEM"
>lp</SPAN
> tenga que establecer su
propia conexión e ingreso en el sistema es especificar
<SPAN
CLASS="SYSTEMITEM"
>lp</SPAN
> como el dueño de una
conexión establecida por otro usuario. Se lista un ejemplo completo de
cómo configurar el sistema de impresión de GNU/Linux para que atienda trabajos
de impresión de clientes a través de NetWare en tres pasos:</P
><P
></P
><OL
TYPE="1"
><LI
><P
>Escribir un <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
> de encapsulamiento (wrapper).</P
><P
>El fichero <TT
CLASS="FILENAME"
>/etc/printcap</TT
> no permite que se le pasen
opciones a los filtros. Por tanto, necesita escribir un pequeño
<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
> que invoque la instrucción que desea junto con
sus opciones. El <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
> de encapsulamiento puede ser
tan simple como:
<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    #!/bin/sh
    # p2pslaser - sencillo script para redirigir stdin a la
    # cola PSLASER en el servidor REDS01
    #
    /usr/bin/nprint -S REDS01 -U stuart -q PSLASER
    #</PRE
></TD
></TR
></TABLE
></P
><P
>Guardar el <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
> en el fichero
<TT
CLASS="FILENAME"
>/usr/local/bin/p2pslaser</TT
>.</P
></LI
><LI
><P
>Escribir la entrada en <TT
CLASS="FILENAME"
>/etc/printcap</TT
>.</P
><P
>Necesitaremos configurar el <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
> <TT
CLASS="FILENAME"
>p2pslaser</TT
>
que hemos creado como filtro de salida en <TT
CLASS="FILENAME"
>/etc/printcap</TT
>.
Sería algo así:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    pslaser|Postguión Laser Printer hosted by NetWare server:\                     
    :lp=/dev/null:\                                                         
    :sd=/var/spool/lpd/pslaser:\                                            
    :if=/usr/local/bin/p2pslaser:\
    :af=/var/log/lp-acct:\
    :lf=/var/log/lp-errs:\
    :pl#66:\                                                                
    :pw#80:\                                                                
    :pc#150:\                                                               
    :mx#0:\                                                                 
    :sh:                                                                    </PRE
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Añadir la opción <TT
CLASS="OPTION"
>&ndash;c</TT
> a <B
CLASS="COMMAND"
>ncpmount</B
>.</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    ncpmount -S REDS01 .... -c lp ....</PRE
></TD
></TR
></TABLE
><P
>Nuestro usuario local <SPAN
CLASS="SYSTEMITEM"
>stuart</SPAN
> debe especificar
al usuario <SPAN
CLASS="SYSTEMITEM"
>lp</SPAN
> como dueño de la conexión
cuando monte el servidor NetWare remoto.</P
></LI
></OL
><P
>Ahora cualquier usuario de Linux puede elegir <TT
CLASS="LITERAL"
>pslaser</TT
> como el
nombre de impresora cuando invoque a <SPAN
CLASS="bold"
><B
CLASS="EMPHASIS"
>lp</B
></SPAN
>. El
trabajo de impresión será enviado al servidor NetWare especificado y entrará en
la cola de impresión.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN12652">15.8.2. Manejando Colas de Impresión</H2
><P
>&#13;
la orden <B
CLASS="COMMAND"
>pqlist</B
> lista todas las colas de impresión
disponibles en el servidor especificado. Si no especifica un servidor de
ficheros en la línea de orden con la opción <TT
CLASS="OPTION"
>-S</TT
>, o un
nombre de acceso y clave, éstos se tomarán de la entrada por defecto de
su fichero <TT
CLASS="FILENAME"
>~/.nwclient</TT
>:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    # <TT
CLASS="USERINPUT"
><B
>pqlist -S vbrew_f1 -U guest -n</B
></TT
>
    Server: ALES_F1
    Print queue name                                    Queue ID  
    ------------------------------------------------------------
    TEST                                                AA02009E
    Q2                                                  EF0200D9
    NPI223761_P1                                        DA03007C
    Q1                                                  F1060004
    I-DATA                                              0D0A003B
    NPI223761_P3                                        D80A0031</PRE
></TD
></TR
></TABLE
><P
>Nuestro ejemplo muestra una lista de las colas de impresión
disponibles para el usuario <TT
CLASS="LITERAL"
>guest</TT
> en el
servidor de ficheros <TT
CLASS="LITERAL"
>ALES_F1</TT
>.
<A
NAME="X-087-2-FNIX09"
HREF="#FTN.X-087-2-FNIX09"
>[1]</A
></P
><P
>&#13;Para ver los trabajos de una cola de impresión,
utilice la instrucción <B
CLASS="COMMAND"
>pqstat</B
>. Toma como argumento
el nombre de la cola de impresión, y lista todos los trabajos de esa
cola. Opcionalmente, puede proporcionarle otro argumento indicando
cuántos trabajos de la lista quiere mostrar. La siguiente salida de
ejemplo ha sido comprimida un poco para que quepa en el ancho de la
página de este libro:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    $ pqstat -S ALES_F1 NPI223761_P1
    
    Server: ALES_F1     Queue: NPI223761_P1          Queue ID: 6A0E000C
       Seq  Name      Description                    Status   Form  Job ID  
    ------------------------------------------------------------------------
         1  TOTRAN    LyX document - propuesta.lyx    Active      0  02660001</PRE
></TD
></TR
></TABLE
></P
><P
>Podemos ver que sólo hay un trabajo de impresión en la cola, que
pertenece al usuario <TT
CLASS="LITERAL"
>TOTRAN</TT
>. El resto de las
opciones incluyen una descripción del trabajo, su estado y su
identificador de trabajo.</P
><P
>la orden <B
CLASS="COMMAND"
>pqrm</B
> se utiliza para eliminar trabajos
de impresión de una cola de impresión especificada. Para eliminar el
trabajo de la cola de la que acabamos de obtener el estado, sería:</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>    $ pqrm -S ALES_F1 NPI223761_P1 02660001</PRE
></TD
></TR
></TABLE
><P
>La orden es bastante simple, pero es pesado de utilizar cuando se tiene
prisa. Sería un valioso proyecto escribir un <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>guión</I
></SPAN
>
básico para simplificar esta operación.</P
></DIV
></DIV
><H3
CLASS="FOOTNOTES"
>Notas</H3
><TABLE
BORDER="0"
CLASS="FOOTNOTES"
WIDTH="100%"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.X-087-2-FNIX09"
HREF="x-087-2-ipx.ncpfs.printing.html#X-087-2-FNIX09"
>[1]</A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
> Parece que los administradores
de sistemas han estado probando algunos de los artículos de la
Cervecera Virtual antes de elegir alguno de esos nombres de
cola de impresión. ¡Esperemos que los nombres que usted elija
tengan más sentido!</P
></TD
></TR
></TABLE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x-087-2-ipx.othertools.html"
ACCESSKEY="P"
>Anterior</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Inicio</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x-087-2-ipx.ncpfs.server.html"
ACCESSKEY="N"
>Siguiente</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Explorando Algunas de las Otras Herramientas IPX</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="x-087-2-ipx.html"
ACCESSKEY="U"
>Subir</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Emulación del Servidor NetWare</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>